<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Method of Variance Estimates Recovery ("MOVER") confidence intervals for comparisons of independent binomial or Poisson rates. — moverci • ratesci</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Method of Variance Estimates Recovery (" mover confidence intervals for comparisons of independent binomial or poisson rates. moverci><meta name="description" content='Confidence intervals applying the MOVER method ("Method of Variance Estimates
Recovery", developed from the Newcombe method for binomial RD) across
different contrasts (RD, RR, OR) and distributions (binomial, Poisson) using
equal-tailed Jeffreys intervals instead of the Wilson score method for the
event rates.  Also allows more general Beta and Gamma priors for an
approximate Bayesian confidence interval incorporating prior beliefs about
the group event rates.
This function is vectorised in x1, x2, n1, and n2.'><meta property="og:description" content='Confidence intervals applying the MOVER method ("Method of Variance Estimates
Recovery", developed from the Newcombe method for binomial RD) across
different contrasts (RD, RR, OR) and distributions (binomial, Poisson) using
equal-tailed Jeffreys intervals instead of the Wilson score method for the
event rates.  Also allows more general Beta and Gamma priors for an
approximate Bayesian confidence interval incorporating prior beliefs about
the group event rates.
This function is vectorised in x1, x2, n1, and n2.'><meta property="og:image" content="https://petelaud.github.io/ratesci/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ratesci</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/single_rate.html">1: Single rate</a></li>
    <li><a class="dropdown-item" href="../articles/basic_contrasts.html">2: Basic contrasts (single stratum)</a></li>
    <li><a class="dropdown-item" href="../articles/stratified.html">3: Stratified contrasts</a></li>
    <li><a class="dropdown-item" href="../articles/paired_contrasts.html">4: Paired contrasts</a></li>
    <li><a class="dropdown-item" href="../articles/tests.html">5: Hypothesis tests</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/petelaud/ratesci/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Method of Variance Estimates Recovery ("MOVER") confidence intervals for comparisons of independent binomial or Poisson rates.</h1>
      <small class="dont-index">Source: <a href="https://github.com/petelaud/ratesci/blob/master/R/moverci.R" class="external-link"><code>R/moverci.R</code></a></small>
      <div class="d-none name"><code>moverci.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Confidence intervals applying the MOVER method ("Method of Variance Estimates
Recovery", developed from the Newcombe method for binomial RD) across
different contrasts (RD, RR, OR) and distributions (binomial, Poisson) using
equal-tailed Jeffreys intervals instead of the Wilson score method for the
event rates.  Also allows more general Beta and Gamma priors for an
approximate Bayesian confidence interval incorporating prior beliefs about
the group event rates.
This function is vectorised in x1, x2, n1, and n2.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">moverci</span><span class="op">(</span></span>
<span>  <span class="va">x1</span>,</span>
<span>  <span class="va">n1</span>,</span>
<span>  x2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distrib <span class="op">=</span> <span class="st">"bin"</span>,</span>
<span>  contrast <span class="op">=</span> <span class="st">"RD"</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  a1 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  b1 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  a2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  b2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"jeff"</span>,</span>
<span>  adj <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x-x-">x1, x2<a class="anchor" aria-label="anchor" href="#arg-x-x-"></a></dt>
<dd><p>Numeric vectors of numbers of events in group 1 &amp; group 2
respectively.</p></dd>


<dt id="arg-n-n-">n1, n2<a class="anchor" aria-label="anchor" href="#arg-n-n-"></a></dt>
<dd><p>Numeric vectors of sample sizes (for binomial rates) or exposure
times (for Poisson rates) in each group.</p></dd>


<dt id="arg-distrib">distrib<a class="anchor" aria-label="anchor" href="#arg-distrib"></a></dt>
<dd><p>Character string indicating distribution assumed for the input
data:<br>
"bin" = binomial (default);<br>
"poi" = Poisson.</p></dd>


<dt id="arg-contrast">contrast<a class="anchor" aria-label="anchor" href="#arg-contrast"></a></dt>
<dd><p>Character string indicating the contrast of interest: <br>
"RD" = rate difference (default); <br>
"RR" = rate ratio; <br>
"OR" = odds ratio; <br>
"p" gives an interval for the single proportion <code>x1/n1</code>.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Number specifying confidence level (between 0 and 1, default
0.95).</p></dd>


<dt id="arg-a-b-a-b-">a1, b1, a2, b2<a class="anchor" aria-label="anchor" href="#arg-a-b-a-b-"></a></dt>
<dd><p>Numbers defining the Beta(ai,bi) prior distributions for
each group (default ai = bi = 0.5 for Jeffreys method). Gamma priors for
Poisson rates require only a1, a2.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character string indicating the method used for the intervals for
the individual group rates. <br>
"jeff" = Jeffreys equal-tailed intervals (default); <br>
"exact" = Clopper-Pearson/Garwood exact intervals (note this does NOT
result in a strictly conservative interval for the contrast, except for
contrast = "p". The scoreci function with <code>cc = TRUE</code> is recommended as a
superior approximation of 'exact' methods); <br>
"midp" = mid-p intervals; <br>
"SCAS" = SCAS non-iterative intervals; <br>
"wilson" = Wilson score intervals (as per Newcombe 1998).
(Rao score is used for <code>distrib = "poi"</code>) <br>
NB: "wilson" option is included only for legacy validation against previous
published method by Newcombe. It is not recommended, as <code>type = "jeff"</code>
or other equal-tailed options achieve much better coverage properties.</p></dd>


<dt id="arg-adj">adj<a class="anchor" aria-label="anchor" href="#arg-adj"></a></dt>
<dd><p>Logical (default FALSE) indicating whether to apply the boundary
adjustment for Jeffreys intervals recommended on p108 of Brown et al.
(<code>type = "jeff"</code> only: set to FALSE if using informative priors.)</p></dd>


<dt id="arg-cc">cc<a class="anchor" aria-label="anchor" href="#arg-cc"></a></dt>
<dd><p>Number or logical specifying (amount of) continuity adjustment
(default FALSE). Numeric value is taken as the gamma parameter in Laud
2017, Appendix S2 (default 0.5 if <code>cc = TRUE</code>). Forced equal to 0.5 if
<code>type = "exact"</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following components:</p><dl><dt>estimates</dt>
<dd><p>a matrix containing estimates of the rates in each group
and of the requested contrast, with its confidence interval.</p></dd>

<dt>call</dt>
<dd><p>details of the function call.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Laud PJ. Equal-tailed confidence intervals for comparison of
rates. Pharmaceutical Statistics 2017; 16:334-348.</p>
<p>Newcombe RG. Interval estimation for the difference between independent
proportions: comparison of eleven methods. Statistics in Medicine 1998;
17(8):873-890.</p>
<p>Donner A, Zou G. Closed-form confidence intervals for functions of the
normal mean and standard deviation. Statistical Methods in Medical Research
2012; 21(4):347-359.</p>
<p>Fagerland MW, Newcombe RG. Confidence intervals for odds ratio and relative
risk based on the inverse hyperbolic sine transformation. Statistics in
Medicine 2013; 32(16):2823-2836.</p>
<p>Li HQ, Tang ML, Wong WK. Confidence intervals for ratio of two Poisson
rates using the method of variance estimates recovery. Computational
Statistics 2014; 29(3-4):869-889.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pete Laud, <a href="mailto:p.j.laud@sheffield.ac.uk">p.j.laud@sheffield.ac.uk</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Binomial RD, MOVER-J method:</span></span></span>
<span class="r-in"><span><span class="fu">moverci</span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n2 <span class="op">=</span> <span class="fl">29</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             lower        est     upper level x1 n1 x2 n2      p1hat       p2hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.009734968 0.08403347 0.1772258  0.95  5 56  0 29 0.09177968 0.007746206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  distrib contrast    level     type      adj       cc       a1       b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "bin"     "RD"   "0.95"   "jeff"  "FALSE"  "FALSE"    "0.5"    "0.5" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       a2       b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "0.5"    "0.5" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Binomial RD, Newcombe method:</span></span></span>
<span class="r-in"><span><span class="fu">moverci</span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n2 <span class="op">=</span> <span class="fl">29</span>, type <span class="op">=</span> <span class="st">"wilson"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            lower        est   upper level x1 n1 x2 n2      p1hat p2hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.03813715 0.08928571 0.19256  0.95  5 56  0 29 0.08928571     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  distrib contrast    level     type      adj       cc       a1       b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "bin"     "RD"   "0.95" "wilson"  "FALSE"  "FALSE"    "0.5"    "0.5" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       a2       b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "0.5"    "0.5" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pete Laud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

    </footer></div>





  </body></html>

