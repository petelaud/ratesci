<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Selected confidence intervals for the single binomial or Poisson rate. — rateci • ratesci</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Selected confidence intervals for the single binomial or Poisson rate. — rateci"><meta name="description" content="Confidence intervals for the single binomial or Poisson rate. This
convenience wrapper function produces a selection of alternative methods. The
first three are recommended for achieving 1-sided and 2-sided coverage
probability close to the nominal levels (see Laud 2017 and Laud 2018):
SCAS (skewness-corrected asymptotic score)
Jeffreys
mid-p (two versions, using exact calculation or approximation via
Beta/Gamma distribution, see p.115 of Brown et al.))
The following more approximate methods are included for users wishing to use
a more established or commonly used method:
Wilson score
Agresti-Coull
Wald (strongly advise this is not used for any purpose but included for reference)


All methods can be made more conservative with a 'continuity adjustment',
which may either be specified as TRUE, or an intermediate 'compromise'
value between 0 and 0.5 may be selected. When cc is TRUE or 0.5, the
mid-p method becomes the Clopper-Pearson interval (or Garwood for Poisson
rates).
Note that Brown et al's Beta formulation perfectly matches the exact interval
when cc is TRUE (i.e. for Clopper-Pearson) but not when cc is FALSE
(for mid-p)
All methods except Agresti-Coull have equivalent formulae for the Poisson
distribution: Garwood for Clopper-Pearson, Rao score for Wilson score.
Jeffreys has a Poisson equivalent using the Gamma distribution. e.g. See Brown
et al. 2003, Swift 2009 and Laud 2017. The formulation for the approximate
mid-p interval using Gamma distribution for a Poisson rate has been deduced
by the package author from the corresponding formulae from Brown et al., and
has not (to the best of my knowledge) been published.
This function is vectorised in x, n."><meta property="og:description" content="Confidence intervals for the single binomial or Poisson rate. This
convenience wrapper function produces a selection of alternative methods. The
first three are recommended for achieving 1-sided and 2-sided coverage
probability close to the nominal levels (see Laud 2017 and Laud 2018):
SCAS (skewness-corrected asymptotic score)
Jeffreys
mid-p (two versions, using exact calculation or approximation via
Beta/Gamma distribution, see p.115 of Brown et al.))
The following more approximate methods are included for users wishing to use
a more established or commonly used method:
Wilson score
Agresti-Coull
Wald (strongly advise this is not used for any purpose but included for reference)


All methods can be made more conservative with a 'continuity adjustment',
which may either be specified as TRUE, or an intermediate 'compromise'
value between 0 and 0.5 may be selected. When cc is TRUE or 0.5, the
mid-p method becomes the Clopper-Pearson interval (or Garwood for Poisson
rates).
Note that Brown et al's Beta formulation perfectly matches the exact interval
when cc is TRUE (i.e. for Clopper-Pearson) but not when cc is FALSE
(for mid-p)
All methods except Agresti-Coull have equivalent formulae for the Poisson
distribution: Garwood for Clopper-Pearson, Rao score for Wilson score.
Jeffreys has a Poisson equivalent using the Gamma distribution. e.g. See Brown
et al. 2003, Swift 2009 and Laud 2017. The formulation for the approximate
mid-p interval using Gamma distribution for a Poisson rate has been deduced
by the package author from the corresponding formulae from Brown et al., and
has not (to the best of my knowledge) been published.
This function is vectorised in x, n."><meta property="og:image" content="https://petelaud.github.io/ratesci/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ratesci</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/single_rate.html">1: Single rate</a></li>
    <li><a class="dropdown-item" href="../articles/basic_contrasts.html">2: Basic contrasts (single stratum)</a></li>
    <li><a class="dropdown-item" href="../articles/stratified.html">3: Stratified contrasts</a></li>
    <li><a class="dropdown-item" href="../articles/paired_contrasts.html">4: Paired contrasts</a></li>
    <li><a class="dropdown-item" href="../articles/tests.html">5: Hypothesis tests</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/petelaud/ratesci/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Selected confidence intervals for the single binomial or Poisson rate.</h1>
      <small class="dont-index">Source: <a href="https://github.com/petelaud/ratesci/blob/master/R/rateci.R" class="external-link"><code>R/rateci.R</code></a></small>
      <div class="d-none name"><code>rateci.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Confidence intervals for the single binomial or Poisson rate. This
convenience wrapper function produces a selection of alternative methods. The
first three are recommended for achieving 1-sided and 2-sided coverage
probability close to the nominal levels (see Laud 2017 and Laud 2018):</p><ul><li><p>SCAS (skewness-corrected asymptotic score)</p></li>
<li><p>Jeffreys</p></li>
<li><p>mid-p (two versions, using exact calculation or approximation via
Beta/Gamma distribution, see p.115 of Brown et al.))
The following more approximate methods are included for users wishing to use
a more established or commonly used method:</p></li>
<li><p>Wilson score</p></li>
<li><p>Agresti-Coull</p></li>
<li><p>Wald (strongly advise this is not used for any purpose but included for reference)</p></li>
</ul><p>All methods can be made more conservative with a 'continuity adjustment',
which may either be specified as TRUE, or an intermediate 'compromise'
value between 0 and 0.5 may be selected. When <code>cc</code> is <code>TRUE</code> or <code>0.5</code>, the
mid-p method becomes the Clopper-Pearson interval (or Garwood for Poisson
rates).
Note that Brown et al's Beta formulation perfectly matches the exact interval
when <code>cc</code> is TRUE (i.e. for Clopper-Pearson) but not when <code>cc</code> is <code>FALSE</code>
(for mid-p)
All methods except Agresti-Coull have equivalent formulae for the Poisson
distribution: Garwood for Clopper-Pearson, Rao score for Wilson score.
Jeffreys has a Poisson equivalent using the Gamma distribution. e.g. See Brown
et al. 2003, Swift 2009 and Laud 2017. The formulation for the approximate
mid-p interval using Gamma distribution for a Poisson rate has been deduced
by the package author from the corresponding formulae from Brown et al., and
has not (to the best of my knowledge) been published.</p>
<p>This function is vectorised in x, n.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rateci</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  distrib <span class="op">=</span> <span class="st">"bin"</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  std_est <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  precis <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Numeric vector of number of events.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Numeric vector of sample size (for binomial rate) or exposure
times (for Poisson rate).</p></dd>


<dt id="arg-distrib">distrib<a class="anchor" aria-label="anchor" href="#arg-distrib"></a></dt>
<dd><p>Character string indicating distribution assumed for the input
data: "bin" = binomial (default), "poi" = Poisson.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Number specifying confidence level (between 0 and 1, default
0.95).</p></dd>


<dt id="arg-std-est">std_est<a class="anchor" aria-label="anchor" href="#arg-std-est"></a></dt>
<dd><p>logical, specifying if the crude point estimate for the
proportion value x/n should be returned (TRUE, default) or the
method-specific alternative point estimate consistent with a 0% confidence
interval (FALSE).</p></dd>


<dt id="arg-cc">cc<a class="anchor" aria-label="anchor" href="#arg-cc"></a></dt>
<dd><p>Number or logical (default FALSE) specifying continuity
adjustment.</p></dd>


<dt id="arg-precis">precis<a class="anchor" aria-label="anchor" href="#arg-precis"></a></dt>
<dd><p>Number (default 8) specifying precision (i.e. number of decimal
places) to be used in root-finding subroutine for the exact confidence
interval. (Note all other methods use closed-form calculations so are not
affected.)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing, for each method, a matrix containing lower and
upper confidence limits and point estimate of p for each value of x and n.
Methods shown depend on the cc parameter, which specifies whether the
continuity adjustment is applied to the SCAS and Jeffreys methods. The
corresponding 'exact' method is Clopper-Pearson/Garwood if cc = TRUE and
mid-p if cc = FALSE.
The last list item contains details of the function call.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Laud PJ. Equal-tailed confidence intervals for comparison of
rates. Pharmaceutical Statistics 2017; 16:334-348. (Appendix A.4)</p>
<p>Brown LD, Cai TT and DasGupta A. Interval estimation for a binomial
proportion. Statistical Science 2001; 16(2):101-133.</p>
<p>Garwood F. Fiducial limits for the Poisson distribution. Biometrika
1936; 28(3-4):437, doi:10.1093/biomet/28.3-4.437.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pete Laud, <a href="mailto:p.j.laud@sheffield.ac.uk">p.j.laud@sheffield.ac.uk</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pete Laud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

    </footer></div>





  </body></html>

