<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ratesci • ratesci</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="ratesci"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ratesci</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/petelaud/ratesci/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>ratesci</h1>
      <small class="dont-index">Source: <a href="https://github.com/petelaud/ratesci/blob/master/ReadMe.md" class="external-link"><code>ReadMe.md</code></a></small>
    </div>

<div id="ratesci" class="section level1">

<!-- badges: start -->
<p><a href="https://github.com/petelaud/ratesci/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/petelaud/ratesci/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://www.gnu.org/licenses/gpl-3.0" class="external-link"><img src="https://img.shields.io/badge/License-GPLv3-blue.svg" alt="License: GPL v3"></a> <a href="https://cran.r-project.org/package=ratesci" class="external-link"><img src="https://www.r-pkg.org/badges/version/ratesci" alt="CRAN_Version"></a> <a href="https://cranlogs.r-pkg.org/badges/grand-total/ratesci" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/ratesci" alt="Total Downloads"></a> <!-- badges: end --></p>
<p>ratesci is an <a href="https://www.r-project.org" class="external-link">R</a> package to compute confidence intervals for rate (or risk) difference (‘RD’), rate ratio (‘RR’, also known as relative risk), or odds ratio (‘OR’). All three contrasts apply for binomial proportions, and the first two may also be used for the comparison of Poisson ‘exposure-adjusted’ incidence rates. <code><a href="reference/scoreci.html">scoreci()</a></code> incorporates ‘skewness-corrected’ asymptotic score (‘SCAS’) methods, which ensure equal-tailed coverage (or central location), in other words for a nominal 95% confidence interval, the one-sided non-coverage probability is (on average) close to 2.5% on each side. Stratified calculations are also catered for (e.g. meta-analysis, including random effects), as well as confidence intervals for the single binomial or Poisson rate, and for clustered binomial proportion (with <code><a href="reference/clusterpci.html">clusterpci()</a></code>) and binomial matched pairs (with <code><a href="reference/pairbinci.html">pairbinci()</a></code>). Corresponding hypothesis tests against any specified null parameter value are provided in each case. Omission of the skewness correction is also allowed, resulting in the often-recommended ‘Miettinen-Nurminen’ asymptotic score methods, which can have inferior one-sided coverage, especially for RR. The hypothesis test for binomial RD or RR when the skewness correction is omitted corresponds to the Farrington-Manning test.</p>
<p>The stratified (fixed effects) version without skewness correction produces a hypothesis test which is equivalent to the Cochran-Mantel-Haenszel (CMH) test, when MH weighting is used for RD or RR, or IVS weighting for OR, and the corresponding confidence intervals are guaranteed to be coherent with the test. In the single-stratum case, the hypothesis tests are equivalent to a Chi-squared test, and for paired proportions, a McNemar test (in both cases with extension to null hypotheses for equivalence/non-inferiority tests).</p>
<p>For large (single-stratum) sample sizes, the ‘MOVER’ methods (<code><a href="reference/moverci.html">moverci()</a></code>) improve on traditional approximate methods with respect to one-sided and two-sided coverage, particularly in the case of RR. Being based on Bayesian methods, these also allow the option to incorporate prior beliefs about the rates in each group - by default, the ‘non-informative’ Jeffreys priors are used. These methods are adapted from the Newcombe ‘square-and-add’ method, which is also included for reference.</p>
<p>For those wishing to achieve strictly conservative coverage, so-called ‘continuity corrections’ are provided as approximations to ‘exact’ methods, with the option to adjust the strength of the correction. The performance of these adjustments has not been extensively evaluated, but they appear to be more successful for SCAS than for MOVER, in terms of achieving conservative coverage.</p>
<p>An online calculator based on this package is available <a href="https://ssu.shef.ac.uk/ratesci/calc.php" class="external-link">here</a></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a></h2>
<p>The current official (i.e. <a href="https://CRAN.R-project.org/package=ratesci" class="external-link">CRAN</a>) release can be installed within R with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ratesci"</span><span class="op">)</span></span></code></pre></div>
<p>The latest development version of the package can be installed with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"petelaud/ratesci"</span><span class="op">)</span></span></code></pre></div>
<p>This builds the package from source based on the current version on <a href="https://github.com/petelaud/ratesci" class="external-link">GitHub</a></p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a></h2>
<p>Below is a basic example which shows you how to request a confidence interval for the difference between proportions 5/56 - 0/29. The <code>$call</code> output element shows that the default settings give an interval for the risk difference (<code>contrast</code> = “RD”), for binomial proportions (<code>distrib</code> = “bin”), at a 95% confidence level. Variance bias correction (<code>bcf</code>) and skewness correction (<code>skew</code>) are applied, continuity correction (<code>cc</code>) is not. This is the skewness-corrected asymptotic score (“SCAS”) confidence interval. (For Miettinen-Nurminen, use <code>skew</code> = FALSE, for Gart-Nam, use <code>bcf</code> = FALSE.)</p>
<p>An example of a paired analysis follows, using the data from Table II of Fagerland et al. Here the bias and skewness corrections are again applied by default. Omitting both would produce the Tango asymptotic score interval for RD, or the Tang method for RR.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/petelaud/ratesci" class="external-link">ratesci</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/scoreci.html">scoreci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n2 <span class="op">=</span> <span class="fl">29</span>, precis <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;        Lower    MLE  Upper level x1 n1 x2 n2  p1hat p2hat  p1mle p2mle</span></span>
<span><span class="co">#&gt; [1,] -0.0186 0.0917 0.1867  0.95  5 56  0 29 0.0893     0 0.0917     0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pval</span></span>
<span><span class="co">#&gt;         chisq pval2sided theta0 scorenull pval_left pval_right</span></span>
<span><span class="co">#&gt; [1,] 3.024862 0.08199729      0  1.739213 0.9590014 0.04099865</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $call</span></span>
<span><span class="co">#&gt;  distrib contrast    level      bcf     skew       cc </span></span>
<span><span class="co">#&gt;    "bin"     "RD"   "0.95"   "TRUE"   "TRUE"  "FALSE"</span></span>
<span></span>
<span><span class="fu"><a href="reference/pairbinci.html">pairbinci</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">12</span><span class="op">)</span>, precis <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt;    x2i</span></span>
<span><span class="co">#&gt; x1i  0  1</span></span>
<span><span class="co">#&gt;   0 12  7</span></span>
<span><span class="co">#&gt;   1  1  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;        Lower     MLE   Upper level  p1hat p2hat  p1mle  p2mle phi_hat phi_c</span></span>
<span><span class="co">#&gt; [1,] -0.5281 -0.2859 -0.0184  0.95 0.0952 0.381 0.0952 0.3811  0.0795     0</span></span>
<span><span class="co">#&gt;      psi_hat</span></span>
<span><span class="co">#&gt; [1,]  1.7143</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pval</span></span>
<span><span class="co">#&gt;         chisq pval2sided theta0 scorenull  pval_left pval_right</span></span>
<span><span class="co">#&gt; [1,] 4.285714 0.03843393      0 -2.070197 0.01921697   0.980783</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $call</span></span>
<span><span class="co">#&gt; contrast   method    level      bcf     skew       cc </span></span>
<span><span class="co">#&gt;     "RD"  "Score"   "0.95"   "TRUE"   "TRUE"  "FALSE"</span></span></code></pre></div>
<div class="section level4">
<h4 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h4>
<p>ratesci contains the following functions:</p>
<p>For comparisons of rates (contrasts RD, RR and OR):</p>
<ul><li>
<code><a href="reference/scoreci.html">scoreci()</a></code>: for score-based confidence intervals including SCAS, Miettinen-Nurminen and Gart-Nam, with or without stratification.</li>
<li>
<code><a href="reference/scasci.html">scasci()</a></code>: wrapper function to compute SCAS intervals.</li>
<li>
<code><a href="reference/tdasci.html">tdasci()</a></code>: wrapper function to compute TDAS stratified intervals incorporating random effects.</li>
<li>
<code><a href="reference/moverci.html">moverci()</a></code>: for the MOVER methods, including Newcombe and MOVER-J.</li>
<li>
<code><a href="reference/moverbci.html">moverbci()</a></code>: wrapper function to compute MOVER-B intervals.</li>
<li>
<code><a href="reference/pairbinci.html">pairbinci()</a></code>: for paired binomial data, including SCAS, asymptotic score and MOVER methods for RD and RR, and transformed binomial intervals for conditional OR.</li>
</ul><p>For single binomial or Poisson rates:</p>
<ul><li>
<code><a href="reference/scaspci.html">scaspci()</a></code>: non-iterative SCAS method for a single rate. For stratified calculations use <code><a href="reference/scoreci.html">scoreci()</a></code> with contrast = “p”.</li>
<li>
<code><a href="reference/jeffreysci.html">jeffreysci()</a></code>: wrapper function to compute Jeffreys interval for a single rate (with option to incorporate prior information).</li>
<li>
<code><a href="reference/rateci.html">rateci()</a></code>: wrapper function for selected methods for a single rate, including SCAS, Jeffreys, midp and Clopper-Pearson/Garwood.</li>
<li>
<code><a href="reference/clusterpci.html">clusterpci()</a></code>: Saha’s Wilson-based interval for a single proportion based on clustered data, with a skewness-corrected version.</li>
</ul></div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pete Laud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

