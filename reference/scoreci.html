<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Score confidence intervals and tests for a single binomial or Poisson rate, or for comparisons of independent rates, with or without stratification. — scoreci • ratesci</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Score confidence intervals and tests for a single binomial or Poisson rate, or for comparisons of independent rates, with or without stratification. — scoreci"><meta name="description" content='Score-based confidence intervals for the rate (or risk) difference ("RD") or
ratio ("RR") for independent binomial or Poisson rates, or for odds ratio
("OR", binomial only). Including options for variance bias correction (from
Miettinen &amp;amp; Nurminen), skewness correction ("GNbc" method from Laud &amp;amp; Dane,
developed from Gart &amp;amp; Nam, and generalised as "SCAS" in Laud 2017) and
continuity adjustment (for strictly conservative coverage).
Also includes score intervals for a single binomial proportion or Poisson
rate ("p"). These are based on the Wilson score interval, and when corrected
for skewness, coverage is almost identical to the mid-p method, or to
Clopper-Pearson when also continuity-adjusted.
Hypothesis tests for association or non-inferiority are provided using the
same score, to ensure consistency between test and CI.
This function is vectorised in x1, x2, n1, and n2.  Vector inputs may also be
combined into a single stratified analysis (e.g. meta-analysis), either using
fixed effects, or the more general random effects "TDAS" method, which
incorporates stratum variability using a t-distribution score (inspired by
Hartung-Knapp-Sidik-Jonkman).
For fixed-effects analysis of stratified datasets, with weighting = "MH" for
RD or RR, or weighting = "INV" for OR, omitting the skewness correction
produces the CMH test, together with a coherent confidence interval for the
required contrast. Alternatively, weighting = "INV" for any contrast gives
intervals consistent with the efficient score test.'><meta property="og:description" content='Score-based confidence intervals for the rate (or risk) difference ("RD") or
ratio ("RR") for independent binomial or Poisson rates, or for odds ratio
("OR", binomial only). Including options for variance bias correction (from
Miettinen &amp;amp; Nurminen), skewness correction ("GNbc" method from Laud &amp;amp; Dane,
developed from Gart &amp;amp; Nam, and generalised as "SCAS" in Laud 2017) and
continuity adjustment (for strictly conservative coverage).
Also includes score intervals for a single binomial proportion or Poisson
rate ("p"). These are based on the Wilson score interval, and when corrected
for skewness, coverage is almost identical to the mid-p method, or to
Clopper-Pearson when also continuity-adjusted.
Hypothesis tests for association or non-inferiority are provided using the
same score, to ensure consistency between test and CI.
This function is vectorised in x1, x2, n1, and n2.  Vector inputs may also be
combined into a single stratified analysis (e.g. meta-analysis), either using
fixed effects, or the more general random effects "TDAS" method, which
incorporates stratum variability using a t-distribution score (inspired by
Hartung-Knapp-Sidik-Jonkman).
For fixed-effects analysis of stratified datasets, with weighting = "MH" for
RD or RR, or weighting = "INV" for OR, omitting the skewness correction
produces the CMH test, together with a coherent confidence interval for the
required contrast. Alternatively, weighting = "INV" for any contrast gives
intervals consistent with the efficient score test.'><meta property="og:image" content="https://petelaud.github.io/ratesci/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ratesci</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/single_rate.html">1: Single rate</a></li>
    <li><a class="dropdown-item" href="../articles/basic_contrasts.html">2: Basic contrasts (single stratum)</a></li>
    <li><a class="dropdown-item" href="../articles/stratified.html">3: Stratified contrasts</a></li>
    <li><a class="dropdown-item" href="../articles/paired_contrasts.html">4: Paired contrasts</a></li>
    <li><a class="dropdown-item" href="../articles/tests.html">5: Hypothesis tests</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/petelaud/ratesci/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Score confidence intervals and tests for a single binomial or Poisson rate, or for comparisons of independent rates, with or without stratification.</h1>
      <small class="dont-index">Source: <a href="https://github.com/petelaud/ratesci/blob/master/R/scoreci.R" class="external-link"><code>R/scoreci.R</code></a></small>
      <div class="d-none name"><code>scoreci.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Score-based confidence intervals for the rate (or risk) difference ("RD") or
ratio ("RR") for independent binomial or Poisson rates, or for odds ratio
("OR", binomial only). Including options for variance bias correction (from
Miettinen &amp; Nurminen), skewness correction ("GNbc" method from Laud &amp; Dane,
developed from Gart &amp; Nam, and generalised as "SCAS" in Laud 2017) and
continuity adjustment (for strictly conservative coverage).</p>
<p>Also includes score intervals for a single binomial proportion or Poisson
rate ("p"). These are based on the Wilson score interval, and when corrected
for skewness, coverage is almost identical to the mid-p method, or to
Clopper-Pearson when also continuity-adjusted.</p>
<p>Hypothesis tests for association or non-inferiority are provided using the
same score, to ensure consistency between test and CI.
This function is vectorised in x1, x2, n1, and n2.  Vector inputs may also be
combined into a single stratified analysis (e.g. meta-analysis), either using
fixed effects, or the more general random effects "TDAS" method, which
incorporates stratum variability using a t-distribution score (inspired by
Hartung-Knapp-Sidik-Jonkman).
For fixed-effects analysis of stratified datasets, with weighting = "MH" for
RD or RR, or weighting = "INV" for OR, omitting the skewness correction
produces the CMH test, together with a coherent confidence interval for the
required contrast. Alternatively, weighting = "INV" for any contrast gives
intervals consistent with the efficient score test.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">scoreci</span><span class="op">(</span></span>
<span>  <span class="va">x1</span>,</span>
<span>  <span class="va">n1</span>,</span>
<span>  x2 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  n2 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  distrib <span class="op">=</span> <span class="st">"bin"</span>,</span>
<span>  contrast <span class="op">=</span> <span class="st">"RD"</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  skew <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  simpleskew <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  or_bias <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ORbias <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rr_tang <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  RRtang <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bcf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">contrast</span> <span class="op">!=</span> <span class="st">"p"</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  cc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  theta0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  precis <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plotmax <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  hetplot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stratified <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  weighting <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mn_tol <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  MNtol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  wt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sda <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fda <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dropzeros <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prediction <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x-x-">x1, x2<a class="anchor" aria-label="anchor" href="#arg-x-x-"></a></dt>
<dd><p>Numeric vectors of numbers of events in group 1 &amp; group 2
respectively.</p></dd>


<dt id="arg-n-n-">n1, n2<a class="anchor" aria-label="anchor" href="#arg-n-n-"></a></dt>
<dd><p>Numeric vectors of sample sizes (for binomial rates) or exposure
times (for Poisson rates) in each group.</p></dd>


<dt id="arg-distrib">distrib<a class="anchor" aria-label="anchor" href="#arg-distrib"></a></dt>
<dd><p>Character string indicating distribution assumed for the input
data: <br>
"bin" = binomial (default), <br>
"poi" = Poisson.</p></dd>


<dt id="arg-contrast">contrast<a class="anchor" aria-label="anchor" href="#arg-contrast"></a></dt>
<dd><p>Character string indicating the contrast of interest: <br>
"RD" = rate difference (default); <br>
"RR" = rate ratio; <br>
"OR" = odds ratio; <br>
"p" gives an interval for the single proportion or rate <code>x1/n1</code>.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Number specifying confidence level (between 0 and 1, default
0.95).</p></dd>


<dt id="arg-skew">skew<a class="anchor" aria-label="anchor" href="#arg-skew"></a></dt>
<dd><p>Logical (default TRUE) indicating whether to apply skewness
correction (for the SCAS or Gart-Nam method) or not (for
the Miettinen-Nurminen method).</p></dd>


<dt id="arg-simpleskew">simpleskew<a class="anchor" aria-label="anchor" href="#arg-simpleskew"></a></dt>
<dd><p>Logical (default FALSE) indicating whether to use the
"simplified" skewness correction instead of the quadratic solution.
See Laud 2021 for details. <br>
NOTE: this version of the score is only suitable for obtaining confidence
limits, not p-values.</p></dd>


<dt id="arg-or-bias">or_bias<a class="anchor" aria-label="anchor" href="#arg-or-bias"></a></dt>
<dd><p>Logical (default is TRUE for <code>contrast = "OR"</code>, otherwise
NULL) indicating whether to apply additional bias correction for OR derived
from Gart 1985. (Laud 2018). Only applies if contrast is "OR".</p></dd>


<dt id="arg-orbias">ORbias<a class="anchor" aria-label="anchor" href="#arg-orbias"></a></dt>
<dd><p>(deprecated: argument renamed to or_bias.)</p></dd>


<dt id="arg-rr-tang">rr_tang<a class="anchor" aria-label="anchor" href="#arg-rr-tang"></a></dt>
<dd><p>Logical indicating whether to use Tang's score for RR:
Stheta = (p1hat - p2hat * theta) / p2d (see Tang 2020).
Default TRUE for <code>stratified = TRUE</code>, with weighting = "IVS" or "INV".
Forced to FALSE for <code>stratified = TRUE</code> with other weightings.
Has no effect when <code>stratified = FALSE</code>, as p2d terms cancel out.
Experimental for <code>distrib = "poi"</code>.</p></dd>


<dt id="arg-rrtang">RRtang<a class="anchor" aria-label="anchor" href="#arg-rrtang"></a></dt>
<dd><p>(deprecated: argument renamed to rr_tang.)</p></dd>


<dt id="arg-bcf">bcf<a class="anchor" aria-label="anchor" href="#arg-bcf"></a></dt>
<dd><p>Logical (default TRUE) indicating whether to apply 'N-1' variance
correction in the score denominator. Applicable to <code>distrib = "bin"</code> only. <br>
NOTE: <code>bcf = FALSE</code> option is really only included for legacy validation
against previous published methods (i.e. Gart &amp; Nam, Mee, or standard
Chi-squared test) and for <code>contrast = "p"</code>.</p></dd>


<dt id="arg-cc">cc<a class="anchor" aria-label="anchor" href="#arg-cc"></a></dt>
<dd><p>Number or logical (default FALSE) specifying (amount of) continuity
adjustment. Numeric value between 0 and 0.5 is taken as the gamma parameter
in Laud 2017, Appendix S2 (<code>cc = TRUE</code> translates to 0.5 for 'conventional'
Yates adjustment). <br>
IMPORTANT NOTES:</p><ol><li><p>This adjustment (conventionally but controversially termed
'continuity correction') is aimed at approximating strictly
conservative coverage, NOT for dealing with zero cell counts. Such
'sparse data adjustments' are not needed in the score method,
except to deal with double-zero cells for stratified  RD (&amp; double-100%
cells for binomial RD &amp; RR) with IVS/INV weights.</p></li>
<li><p>The continuity adjustments provided here have not been fully tested for
stratified methods, but are found to match the continuity-adjusted version
of the Mantel-Haenszel test, when <code>cc = 0.5</code> for any of the binomial
contrasts. Flexibility is included for a less conservative adjustment, such
as <code>cc = 0.25</code> suggested in Laud 2017 (see Appendix S3.4), or <code>cc = 3/16 =   0.1875</code> in Mehrotra &amp; Railkar (2000).</p></li>
</ol></dd>


<dt id="arg-theta-">theta0<a class="anchor" aria-label="anchor" href="#arg-theta-"></a></dt>
<dd><p>Number to be used in a one-sided significance test (e.g.
non-inferiority margin). 1-sided p-value will be &lt;0.025 iff 2-sided 95\<!-- % CI -->
excludes theta0. (If <code>bcf = FALSE</code> and <code>skew = FALSE</code> this gives a
Farrington-Manning test.) <br>
By default, a two-sided test for association against theta0 = 0 (for RD) or
1 (for RR/OR) is also output:</p><ul><li><p>If <code>bcf = FALSE</code> and <code>skew = FALSE</code> this is the same as K. Pearson's Chi-squared
test in the single stratum case.</p></li>
<li><p><code>bcf = TRUE</code> gives E. Pearson's 'N-1' Chi-squared test for a single stratum,
(Recommended by Campbell 2007: https://doi.org/10.1002/sim.2832)
and (with default weighting and <code>random = FALSE</code>) the CMH test for stratified
tables.</p></li>
<li><p>Default <code>bcf = TRUE</code> and `skew = TRUE produces a skewness-corrected version
of the 'N-1' Chi-squared test or CMH. This correction will only change the
p-value if group sizes are unequal.</p></li>
</ul></dd>


<dt id="arg-precis">precis<a class="anchor" aria-label="anchor" href="#arg-precis"></a></dt>
<dd><p>Number (default 6) specifying precision (i.e. number of decimal
places) to be used in optimisation subroutine for the confidence interval.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Logical (default FALSE) indicating whether to output plot of the
score function</p></dd>


<dt id="arg-plotmax">plotmax<a class="anchor" aria-label="anchor" href="#arg-plotmax"></a></dt>
<dd><p>Numeric value indicating maximum value to be displayed on
x-axis of plots (useful for ratio contrasts which can be infinite).</p></dd>


<dt id="arg-hetplot">hetplot<a class="anchor" aria-label="anchor" href="#arg-hetplot"></a></dt>
<dd><p>Logical (default FALSE) indicating whether to output plots for
evaluating heterogeneity of stratified datasets.</p></dd>


<dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>pair of values indicating range of values to be plotted.</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>pair of values indicating range of values to be plotted.</p></dd>


<dt id="arg-stratified">stratified<a class="anchor" aria-label="anchor" href="#arg-stratified"></a></dt>
<dd><p>Logical (default FALSE) indicating whether to combine
vector inputs into a single stratified analysis. <br>
IMPORTANT NOTE: The mechanism for stratified calculations is enabled for
contrast = "p", but the performance of the resulting intervals has not
been fully evaluated.</p></dd>


<dt id="arg-weighting">weighting<a class="anchor" aria-label="anchor" href="#arg-weighting"></a></dt>
<dd><p>String indicating which weighting method to use if
stratified = "TRUE": <br>
"IVS" = Inverse Variance of Score (see Laud 2017 for details); <br>
"INV" = Inverse Variance (bcf omitted, default for contrast = "OR" giving
CMH test); <br>
"MH" = Mantel-Haenszel (n1j * n2j) / (n1j + n2j)
(default for contrast = "RD" or "RR" giving CMH test);
(= sample size for contrast = "p"); <br>
"MN" = Miettinen-Nurminen weights.
(similar to MH for contrast = "RD" or "RR",
similar to INV for contrast = "OR"); <br>
"Tang" = (n1j * n2j) / (n1j + n2j) / (1 - pj) from Tang 2020,
for an optimal test of RD if RRs are constant across strata.
(Included only for validation purposes. In general, such a test
would more logically use contrast = "RR" with weighting = "INV")
For CI consistent with a CMH test, select <code>skew = FALSE</code>, <code>random = FALSE</code>,
and use default MH weighting for RD/RR and INV for OR. <br><code>Weighting = "MN"</code> also matches the CMH test. <br>
For the Radhakrishna optimal (most powerful) test, select INV weighting.<br>
Note: Alternative user-specified weighting may also be applied, via the
'wt' argument.</p></dd>


<dt id="arg-mn-tol">mn_tol<a class="anchor" aria-label="anchor" href="#arg-mn-tol"></a></dt>
<dd><p>Numeric value indicating convergence tolerance to be used in
iteration with weighting = "MN".</p></dd>


<dt id="arg-mntol">MNtol<a class="anchor" aria-label="anchor" href="#arg-mntol"></a></dt>
<dd><p>(deprecated: argument renamed to mn_tol)</p></dd>


<dt id="arg-wt">wt<a class="anchor" aria-label="anchor" href="#arg-wt"></a></dt>
<dd><p>Numeric vector containing (optional) user-specified weights.<br>
Overrides <code>weighting</code> if non-empty.</p></dd>


<dt id="arg-sda">sda<a class="anchor" aria-label="anchor" href="#arg-sda"></a></dt>
<dd><p>Sparse data adjustment to avoid zero variance when <code>x1 + x2 = 0</code>:
Only applied when <code>stratified = TRUE</code>.
Default 0.5 for RD with IVS/INV weights.
Not required for RR/OR, default is to remove double-zero strata
instead.</p></dd>


<dt id="arg-fda">fda<a class="anchor" aria-label="anchor" href="#arg-fda"></a></dt>
<dd><p>Full data adjustment to avoid zero variance when x1 + x2 = n1 + n2:
Only applied when <code>stratified = TRUE</code>.
Default 0.5 for RD &amp; RR with IVS/INV weights.
Not required for OR, default is to remove affected strata.</p></dd>


<dt id="arg-dropzeros">dropzeros<a class="anchor" aria-label="anchor" href="#arg-dropzeros"></a></dt>
<dd><p>Logical (default FALSE) indicating whether to drop
uninformative strata for RR/OR (i.e. strata with <code>x1 + x2 = 0</code>),
even when the choice of weights would allow
them to be retained for a fixed effects analysis.
Has no effect on estimates, just the heterogeneity test.</p></dd>


<dt id="arg-random">random<a class="anchor" aria-label="anchor" href="#arg-random"></a></dt>
<dd><p>Logical (default FALSE) indicating whether to perform random
effects meta-analysis for stratified data, using the t-distribution (TDAS)
method for stratified data (defined in Laud 2017). <br>
NOTE: If <code>random = TRUE</code>, then <code>skew = TRUE</code> only affects the per-stratum
estimates.</p></dd>


<dt id="arg-prediction">prediction<a class="anchor" aria-label="anchor" href="#arg-prediction"></a></dt>
<dd><p>Logical (default FALSE) indicating whether to produce
a prediction interval (work in progress).</p></dd>


<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>Logical (default TRUE) giving the option to suppress warnings.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following components:</p><dl><dt>estimates</dt>
<dd><p>a matrix containing estimates of the requested contrast
and its confidence interval, and the estimated rates in each group:
(p1hat, p2hat) are (r1, r0) from Miettinen-Nurminen, or (r1*, r0*) when
stratified; (p1mle, p2mle) are (R1, R0), or (R1*, R0*) when stratified,
evaluated at the MLE for the contrast parameter, incorporating any
specified skewness/bias corrections.</p></dd>

<dt>pval</dt>
<dd><p>a matrix containing details of the corresponding 2-sided significance test
against the null hypothesis that <code>p_1 = p_2</code>, and one-sided significance
tests against the null hypothesis that theta &gt;= or &lt;= theta0.</p></dd>

<dt>call</dt>
<dd><p>details of the function call.</p></dd>

</dl><p>If <code>stratified = TRUE</code>, the
following outputs are added:</p><dl><dt>Qtest</dt>
<dd><p>a vector of values
describing and testing heterogeneity, including a score-based version of a
Q statistic and p-value, I^2 and tau^2 to quantify heterogeneity, and a
test for qualitative interaction analogous to the Gail and Simon test.</p></dd>

<dt>weighting</dt>
<dd><p>a string indicating
the selected weighting method.</p></dd>
 <dt>stratdata</dt>
<dd><p>a matrix containing stratum
estimates and weights.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Laud PJ. Equal-tailed confidence intervals for comparison of
rates. Pharmaceutical Statistics 2017; 16:334-348.</p>
<p>Laud PJ. Corrigendum: Equal-tailed confidence intervals for comparison of
rates. Pharmaceutical Statistics 2018; 17:290-293.</p>
<p>Laud PJ, Dane A. Confidence intervals for the difference between
independent binomial proportions: comparison using a graphical approach and
moving averages. Pharmaceutical Statistics 2014; 13(5):294-308.</p>
<p>Miettinen OS, Nurminen M. Comparative analysis of two rates. Statistics in
Medicine 1985; 4:213-226.</p>
<p>Farrington CP, Manning G. Test statistics and sample size formulae for
comparative binomial trials with null hypothesis of non-zero risk
difference or non-unity relative risk. Statistics in Medicine 1990;
9(12):1447-1454.</p>
<p>Gart JJ. Analysis of the common odds ratio: corrections for bias and
skewness. Bulletin of the International Statistical Institute 1985,
45th session, book 1, 175-176.</p>
<p>Gart JJ, Nam Jm. Approximate interval estimation of the ratio of binomial
parameters: a review and corrections for skewness. Biometrics 1988;
44(2):323-338.</p>
<p>Gart JJ, Nam Jm. Approximate interval estimation of the difference in
binomial parameters: correction for skewness and extension to multiple
tables. Biometrics 1990; 46(3):637-643.</p>
<p>Tang Y. Score confidence intervals and sample sizes for stratified
comparisons of binomial proportions. Statistics in Medicine 2020;
39:3427-3457.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pete Laud, <a href="mailto:p.j.laud@sheffield.ac.uk">p.j.laud@sheffield.ac.uk</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Binomial RD, SCAS method:</span></span></span>
<span class="r-in"><span><span class="fu">scoreci</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">19</span>, <span class="fl">5</span><span class="op">)</span>, n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">29</span>, <span class="fl">56</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">22</span>, <span class="fl">0</span><span class="op">)</span>, n2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">30</span>, <span class="fl">29</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            lower         est     upper level x1 n1 x2 n2      p1hat     p2hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.38567597  0.68162256 0.8778839  0.95 12 16  1 16 0.75000000 0.0625000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.31189939 -0.07795525 0.1600794  0.95 19 29 22 30 0.65517241 0.7333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.01861751  0.09168753 0.1867180  0.95  5 56  0 29 0.08928571 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           p1mle      p2mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.74553163 0.06390906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.65528437 0.73323962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.09168753 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           chisq   pval2sided theta0  scorenull pval_left   pval_right</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 15.1862348 9.741092e-05      0  3.8969520 0.9999513 4.870546e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.4181622 5.178555e-01      0 -0.6466546 0.2589278 7.410722e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  3.0248621 8.199729e-02      0  1.7392131 0.9590014 4.099865e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  distrib contrast    level      bcf     skew       cc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "bin"     "RD"   "0.95"   "TRUE"   "TRUE"  "FALSE" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Binomial RD, MN method:</span></span></span>
<span class="r-in"><span><span class="fu">scoreci</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">19</span>, <span class="fl">5</span><span class="op">)</span>, n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">29</span>, <span class="fl">56</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">22</span>, <span class="fl">0</span><span class="op">)</span>, n2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">30</span>, <span class="fl">29</span><span class="op">)</span>, skew <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            lower         est    upper level x1 n1 x2 n2      p1hat     p2hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.37497827  0.68749997 0.862899  0.95 12 16  1 16 0.75000000 0.0625000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.30859360 -0.07816094 0.158172  0.95 19 29 22 30 0.65517241 0.7333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.03259659  0.08928570 0.193331  0.95  5 56  0 29 0.08928571 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          p1mle      p2mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.7500000 0.06250001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.6551724 0.73333334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.0892857 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           chisq   pval2sided theta0  scorenull pval_left   pval_right</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 15.1862348 9.741092e-05      0  3.8969520 0.9999513 4.870546e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.4177055 5.180842e-01      0 -0.6463014 0.2590421 7.409579e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  2.7187500 9.917565e-02      0  1.6488632 0.9504122 4.958783e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  distrib contrast    level      bcf     skew       cc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "bin"     "RD"   "0.95"   "TRUE"  "FALSE"  "FALSE" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Poisson RR, SCAS method:</span></span></span>
<span class="r-in"><span><span class="fu">scoreci</span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n2 <span class="op">=</span> <span class="fl">29</span>, distrib <span class="op">=</span> <span class="st">"poi"</span>, contrast <span class="op">=</span> <span class="st">"RR"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          lower      est upper level x1 n1 x2 n2      p1hat p2hat      p1mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.7264486 16.05357   Inf  0.95  5 56  0 29 0.08928571     0 0.08649554</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            p2mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.005387931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         chisq pval2sided theta0 scorenull pval_left pval_right</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.904393 0.08833848      1  1.704228 0.9558308 0.04416924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  distrib contrast    level      bcf     skew  rr_tang       cc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "poi"     "RR"   "0.95"   "TRUE"   "TRUE"   "TRUE"  "FALSE" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Poisson RR, MN method:</span></span></span>
<span class="r-in"><span><span class="fu">scoreci</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n2 <span class="op">=</span> <span class="fl">29</span>, distrib <span class="op">=</span> <span class="st">"poi"</span>,</span></span>
<span class="r-in"><span>  contrast <span class="op">=</span> <span class="st">"RR"</span>, skew <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          lower est upper level x1 n1 x2 n2      p1hat p2hat p1mle p2mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.6740371 Inf   Inf  0.95  5 56  0 29 0.08928571     0   NaN 1e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         chisq pval2sided theta0 scorenull pval_left pval_right</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.589286  0.1075888      1  1.609126 0.9462056 0.05379442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  distrib contrast    level      bcf     skew  rr_tang       cc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "poi"     "RR"   "0.95"   "TRUE"  "FALSE"   "TRUE"  "FALSE" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Binomial rate, SCAS method:</span></span></span>
<span class="r-in"><span><span class="fu">scoreci</span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span>, n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">56</span>, <span class="fl">29</span><span class="op">)</span>, contrast <span class="op">=</span> <span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lower         est      upper level x1 n1      p1hat       p1mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.03396264 0.091715962 0.18585265  0.95  5 56 0.08928571 0.091715962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.00000000 0.005681813 0.09170711  0.95  0 29 0.00000000 0.005681813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         chisq   pval2sided theta0 scorenull    pval_left pval_right</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 37.78571 7.895787e-10    0.5 -6.147009 3.947893e-10          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 29.00000 7.237830e-08    0.5 -5.385165 3.618915e-08          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  distrib contrast    level      bcf     skew       cc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "bin"      "p"   "0.95"  "FALSE"   "TRUE"  "FALSE" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Binomial rate, Wilson score method:</span></span></span>
<span class="r-in"><span><span class="fu">scoreci</span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span>, n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">56</span>, <span class="fl">29</span><span class="op">)</span>, contrast <span class="op">=</span> <span class="st">"p"</span>, skew <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lower       est     upper level x1 n1      p1hat     p1mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.03874213 0.0892857 0.1925600  0.95  5 56 0.08928571 0.0892857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.00000000 0.0000000 0.1169698  0.95  0 29 0.00000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         chisq   pval2sided theta0 scorenull    pval_left pval_right</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 37.78571 7.895787e-10    0.5 -6.147009 3.947893e-10          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 29.00000 7.237830e-08    0.5 -5.385165 3.618915e-08          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  distrib contrast    level      bcf     skew       cc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "bin"      "p"   "0.95"  "FALSE"  "FALSE"  "FALSE" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Poisson rate, SCAS method:</span></span></span>
<span class="r-in"><span><span class="fu">scoreci</span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span>, n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">56</span>, <span class="fl">29</span><span class="op">)</span>, distrib <span class="op">=</span> <span class="st">"poi"</span>, contrast <span class="op">=</span> <span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           lower         est      upper level x1 n1      p1hat       p1mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.03314556 0.092261900 0.19710988  0.95  5 56 0.08928571 0.092261900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.00000000 0.005747108 0.09705604  0.95  0 29 0.00000000 0.005747108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         chisq   pval2sided theta0 scorenull    pval_left pval_right</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 26.52974 2.595125e-07    0.5 -5.150703 1.297562e-07  0.9999999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 22.58937 2.005914e-06    0.5 -4.752828 1.002957e-06  0.9999990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  distrib contrast    level      bcf     skew       cc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "poi"      "p"   "0.95"  "FALSE"   "TRUE"  "FALSE" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stratified example, using data from Hartung &amp; Knapp:</span></span></span>
<span class="r-in"><span><span class="fu">scoreci</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">12</span>, <span class="fl">29</span>, <span class="fl">42</span>, <span class="fl">14</span>, <span class="fl">44</span>, <span class="fl">14</span>, <span class="fl">29</span>, <span class="fl">10</span>, <span class="fl">17</span>, <span class="fl">38</span>, <span class="fl">19</span>, <span class="fl">21</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">18</span>, <span class="fl">31</span>, <span class="fl">6</span>, <span class="fl">17</span>, <span class="fl">7</span>, <span class="fl">23</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">12</span>, <span class="fl">22</span>, <span class="fl">19</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">16</span>, <span class="fl">34</span>, <span class="fl">56</span>, <span class="fl">22</span>, <span class="fl">54</span>, <span class="fl">17</span>, <span class="fl">58</span>, <span class="fl">14</span>, <span class="fl">26</span>, <span class="fl">44</span>, <span class="fl">29</span>, <span class="fl">38</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">16</span>, <span class="fl">34</span>, <span class="fl">56</span>, <span class="fl">22</span>, <span class="fl">55</span>, <span class="fl">15</span>, <span class="fl">58</span>, <span class="fl">15</span>, <span class="fl">27</span>, <span class="fl">45</span>, <span class="fl">30</span>, <span class="fl">38</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  stratified <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          lower       est     upper level     p1hat     p2hat     p1mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.2455228 0.3087549 0.3703304  0.95 0.7168521 0.4079934 0.7143654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          p2mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.4056105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         chisq  pval2sided theta0 scorenull pval_left pval_right</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 84.63601 3.58673e-20      0  9.199783         1          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Qtest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Q         Q_df     pval_het           I2         tau2           Qc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.434094e+01 1.200000e+01 1.335827e-05 7.293697e+01 3.249909e-02 4.381431e-01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pval_qualhet </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9.874622e-01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weighting</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "MH"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $stratdata</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1j n1j x2j n2j    p1hatj    p2hatj  wt_fixed wtpct_fixed wtpct_rand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  15  16   9  16 0.9375000 0.5625000  8.000000    3.761235   3.761235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  12  16   1  16 0.7500000 0.0625000  8.000000    3.761235   3.761235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  29  34  18  34 0.8529412 0.5294118 17.000000    7.992625   7.992625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  42  56  31  56 0.7500000 0.5535714 28.000000   13.164324  13.164324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  14  22   6  22 0.6363636 0.2727273 11.000000    5.171699   5.171699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  44  54  17  55 0.8148148 0.3090909 27.247706   12.810630  12.810630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  14  17   7  15 0.8235294 0.4666667  7.968750    3.746543   3.746543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  29  58  23  58 0.5000000 0.3965517 29.000000   13.634478  13.634478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  10  14   3  15 0.7142857 0.2000000  7.241379    3.404567   3.404567</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  17  26   6  27 0.6538462 0.2222222 13.245283    6.227328   6.227328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  38  44  12  45 0.8636364 0.2666667 22.247191   10.459615  10.459615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  19  29  22  30 0.6551724 0.7333333 14.745763    6.932786   6.932786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  21  38  19  38 0.5526316 0.5000000 19.000000    8.932934   8.932934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           theta_j     lower_j   upper_j         V_j    Stheta_j         Q_j</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.37432668  0.07947651 0.6366192 0.019934516  0.06624508  0.22014132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.68162256  0.38567597 0.8778839 0.026998683  0.37874508  5.31314199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.32258016  0.10699961 0.5210504 0.011266832  0.01477449  0.01937418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.19597310  0.01948127 0.3650952 0.007443573 -0.11232635  1.69504736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.36101505  0.06819779 0.6120265 0.020831237  0.05488144  0.14458924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  0.50425580  0.33270276 0.6528154 0.008184236  0.19696898  4.74042804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  0.35432470  0.02152622 0.6408332 0.026682150  0.04810782  0.08673824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  0.10316080 -0.07844922 0.2802846 0.007795273 -0.20530665  5.40722789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  0.50878373  0.15475377 0.7736135 0.032012523  0.20553079  1.31957442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  0.42909852  0.16911775 0.6487974 0.017068011  0.12286901  0.88450806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  0.59488156  0.41394266 0.7429163 0.009980466  0.28821478  8.32303392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] -0.07795525 -0.31189939 0.1600794 0.013943229 -0.38691584 10.73667113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  0.05240601 -0.17214090 0.2734169 0.012035530 -0.25612334  5.45045942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  distrib contrast    level      bcf     skew       cc   random </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "bin"     "RD"   "0.95"   "TRUE"   "TRUE"  "FALSE"  "FALSE" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># "Random effects" TDAS example, using data from Hartung &amp; Knapp:</span></span></span>
<span class="r-in"><span><span class="fu">scoreci</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">12</span>, <span class="fl">29</span>, <span class="fl">42</span>, <span class="fl">14</span>, <span class="fl">44</span>, <span class="fl">14</span>, <span class="fl">29</span>, <span class="fl">10</span>, <span class="fl">17</span>, <span class="fl">38</span>, <span class="fl">19</span>, <span class="fl">21</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">18</span>, <span class="fl">31</span>, <span class="fl">6</span>, <span class="fl">17</span>, <span class="fl">7</span>, <span class="fl">23</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">12</span>, <span class="fl">22</span>, <span class="fl">19</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">16</span>, <span class="fl">34</span>, <span class="fl">56</span>, <span class="fl">22</span>, <span class="fl">54</span>, <span class="fl">17</span>, <span class="fl">58</span>, <span class="fl">14</span>, <span class="fl">26</span>, <span class="fl">44</span>, <span class="fl">29</span>, <span class="fl">38</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">16</span>, <span class="fl">34</span>, <span class="fl">56</span>, <span class="fl">22</span>, <span class="fl">55</span>, <span class="fl">15</span>, <span class="fl">58</span>, <span class="fl">15</span>, <span class="fl">27</span>, <span class="fl">45</span>, <span class="fl">30</span>, <span class="fl">38</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  stratified <span class="op">=</span> <span class="cn">TRUE</span>, random <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          lower       est     upper level     p1hat     p2hat    p1mle     p2mle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.1746892 0.3088587 0.4430283  0.95 0.7168521 0.4079934 0.714412 0.4055533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         chisq   pval2sided theta0 scorenull pval_left   pval_right</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 25.15659 0.0003013239      0  5.015634 0.9998493 0.0001506619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Qtest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Q         Q_df     pval_het           I2         tau2           Qc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.434094e+01 1.200000e+01 1.335827e-05 7.293697e+01 3.249909e-02 4.381431e-01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pval_qualhet </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9.874622e-01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weighting</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "MH"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $stratdata</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1j n1j x2j n2j    p1hatj    p2hatj  wt_fixed wtpct_fixed wtpct_rand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  15  16   9  16 0.9375000 0.5625000  8.000000    3.761235   3.761235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  12  16   1  16 0.7500000 0.0625000  8.000000    3.761235   3.761235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  29  34  18  34 0.8529412 0.5294118 17.000000    7.992625   7.992625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  42  56  31  56 0.7500000 0.5535714 28.000000   13.164324  13.164324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  14  22   6  22 0.6363636 0.2727273 11.000000    5.171699   5.171699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  44  54  17  55 0.8148148 0.3090909 27.247706   12.810630  12.810630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  14  17   7  15 0.8235294 0.4666667  7.968750    3.746543   3.746543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  29  58  23  58 0.5000000 0.3965517 29.000000   13.634478  13.634478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  10  14   3  15 0.7142857 0.2000000  7.241379    3.404567   3.404567</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  17  26   6  27 0.6538462 0.2222222 13.245283    6.227328   6.227328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  38  44  12  45 0.8636364 0.2666667 22.247191   10.459615  10.459615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  19  29  22  30 0.6551724 0.7333333 14.745763    6.932786   6.932786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  21  38  19  38 0.5526316 0.5000000 19.000000    8.932934   8.932934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           theta_j     lower_j   upper_j         V_j    Stheta_j         Q_j</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.37432668  0.07947651 0.6366192 0.019934516  0.06624508  0.22014132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.68162256  0.38567597 0.8778839 0.026998683  0.37874508  5.31314199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.32258016  0.10699961 0.5210504 0.011266832  0.01477449  0.01937418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.19597310  0.01948127 0.3650952 0.007443573 -0.11232635  1.69504736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.36101505  0.06819779 0.6120265 0.020831237  0.05488144  0.14458924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  0.50425580  0.33270276 0.6528154 0.008184236  0.19696898  4.74042804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  0.35432470  0.02152622 0.6408332 0.026682150  0.04810782  0.08673824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  0.10316080 -0.07844922 0.2802846 0.007795273 -0.20530665  5.40722789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  0.50878373  0.15475377 0.7736135 0.032012523  0.20553079  1.31957442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  0.42909852  0.16911775 0.6487974 0.017068011  0.12286901  0.88450806</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  0.59488156  0.41394266 0.7429163 0.009980466  0.28821478  8.32303392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] -0.07795525 -0.31189939 0.1600794 0.013943229 -0.38691584 10.73667113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  0.05240601 -0.17214090 0.2734169 0.012035530 -0.25612334  5.45045942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  distrib contrast    level      bcf     skew       cc   random </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    "bin"     "RD"   "0.95"   "TRUE"   "TRUE"  "FALSE"   "TRUE" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stratified example, with extremely rare instance of non-calculable skewness</span></span></span>
<span class="r-in"><span><span class="co"># correction seen on plot of score function:</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># interactive()</span></span></span>
<span class="r-in"><span><span class="fu">scoreci</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span>, n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>, x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">139</span><span class="op">)</span>, n2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">160</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  contrast <span class="op">=</span> <span class="st">"RD"</span>, skew <span class="op">=</span> <span class="cn">TRUE</span>, simpleskew <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  distrib <span class="op">=</span> <span class="st">"bin"</span>, stratified <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, weighting <span class="op">=</span> <span class="st">"IVS"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pete Laud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

    </footer></div>





  </body></html>

