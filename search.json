[{"path":[]},{"path":"https://petelaud.github.io/ratesci/articles/basic_contrasts.html","id":"scas-and-other-asymptotic-score-methods","dir":"Articles","previous_headings":"Introduction to scoreci() and related functions for computing confidence intervals and tests for comparisons of independent binomial or Poisson rates","what":"SCAS and other asymptotic score methods","title":"2: Basic contrasts (single stratum)","text":"calculate confidence interval (CI) risk difference (θ̂RD=p̂1−p̂2\\hat \\theta_{RD} = \\hat p_1 - \\hat p_2, p̂=xi/ni\\hat p_i = x_i/n_i), relative risk (θ̂RR=p̂1/p̂2\\hat \\theta_{RR} = \\hat p_1 / \\hat p_2) odds ratio (θ̂=p̂1(1−p̂2)/p̂2(1−p̂1)\\hat \\theta_{} = \\hat p_1 (1 - \\hat p_2) / \\hat p_2(1 - \\hat p_1), Skewness-Corrected Asymptotic Score (SCAS) method recommended, one succeeds, average, containing true parameter θ\\theta appropriate nominal probability (e.g. 95%), evenly distributed tail probabilities (Laud 2017). modified version Miettinen-Nurminen (MN) Asymptotic Score method (Miettinen Nurminen 1985). MN SCAS represent family methods encompassing analysis RD RR binomial proportions Poisson rates (e.g. exposure-adjusted incidence rate), binomial . plots illustrate one-sided two-sided interval coverage probabilities1 achieved SCAS compared popular methods2 (n1,n2)=(45,15)(n_1, n_2) = (45, 15), second row plot using moving average smoothing. selection coverage probability plots sample size combinations can found “plots” folder ratesci GitHub repository.  Differences two-sided coverage can subtle:  skewness correction, introduced (Gart Nam 1988) considered essential analysis ratio contrasts, can also substantial effect RD seen . [Note: (Morten W. Fagerland, Lydersen, Laake 2011) dismissed MN method, saying can somewhat liberal. fact, based reconstruction results, appears evaluation closely-related inferior Mee method, omits N/(N-1) variance bias correction. access 2017 book see error persists . Essentially, seems reject MN method basis small regions parameter space coverage slightly nominal. dips coverage occur, fluctuate nominal level pattern ridges furrows aligned along diagonal fixed value θRD\\theta_{RD}. moving average smoothing surface plots designed even fluctuations coverage. ‘N-1’ adjustment MN method elevates coverage probabilities slightly, skewness correction gives improvement overall, well substantially improving one-sided coverage group sizes unequal.] scoreci() used follows, example obtain SCAS 95% CI difference 5/56 - 0/29: underlying z-statistic used obtain two-sided hypothesis test null hypothesis difference (pval2sided). Note certain conditions (.e. n1=n2n_1 = n_2) equivalent Egon Pearson ‘N-1’ chi-squared test (Campbell 2007). facility also provided custom one-sided test specified null hypothesis value θ0\\theta_0, e.g. non-inferiority testing (pval_left pval_right) scoreci() function provides options omit skewness correction (MN method) variance bias correction (Mee method, consistent Karl Pearson unadjusted Chi-squared test). simpler life, choose SCAS always use scasci() wrapper function: confidence interval relative risk, use: odds ratio: analysis Poisson incidence rates, example exposure-adjusted adverse event rates, methodology adapted Poisson distribution, distrib argument. , example denominators 56 29 represent number patient-years risk group, instead number patients:","code":"out <- scoreci(x1 = 5, n1 = 56, x2 = 0, n = 29) out$estimates #>        lower    est upper level x1 n1 x2 n2  p1hat p2hat  p1mle p2mle #> [1,] -0.0186 0.0917 0.187  0.95  5 56  0 29 0.0893     0 0.0917     0 out$pval #>      chisq pval2sided theta0 scorenull pval_left pval_right #> [1,]  3.02      0.082      0      1.74     0.959      0.041 scasci(x1 = 5, n1 = 56, x2 = 0, n = 29)$estimates #>        lower    est upper level x1 n1 x2 n2  p1hat p2hat  p1mle p2mle #> [1,] -0.0186 0.0917 0.187  0.95  5 56  0 29 0.0893     0 0.0917     0 scasci(x1 = 5, n1 = 56, x2 = 0, n = 29, contrast = \"RR\")$estimates #>      lower  est upper level x1 n1 x2 n2  p1hat p2hat  p1mle  p2mle #> [1,]  0.77 16.4   Inf  0.95  5 56  0 29 0.0893     0 0.0868 0.0053 scasci(x1 = 5, n1 = 56, x2 = 0, n = 29, contrast = \"OR\")$estimates #>      lower  est upper level x1 n1 x2 n2  p1hat p2hat  p1mle   p2mle #> [1,] 0.759 17.7   Inf  0.95  5 56  0 29 0.0893     0 0.0865 0.00533 scasci(x1 = 5, n1 = 56, x2 = 0, n = 29, contrast = \"RR\", distrib = \"poi\")$estimates #>      lower  est upper level x1 n1 x2 n2  p1hat p2hat  p1mle   p2mle #> [1,] 0.726 16.1   Inf  0.95  5 56  0 29 0.0893     0 0.0865 0.00539"},{"path":"https://petelaud.github.io/ratesci/articles/basic_contrasts.html","id":"mover-methods","dir":"Articles","previous_headings":"Introduction to scoreci() and related functions for computing confidence intervals and tests for comparisons of independent binomial or Poisson rates","what":"MOVER methods","title":"2: Basic contrasts (single stratum)","text":"alternative family methods produce confidence intervals set binomial Poisson contrasts Method Variance Estimates Recovery (MOVER), also known Square--Add (technical details see chapter 7 Newcombe 2012). Originally labelled “Score” method (Newcombe 1998) due involvement Wilson Score interval, involves combination intervals calculated separately p1p_1 p2p_2. Newcombe based method Wilson intervals, coverage can improved using equal-tailed Jeffreys intervals instead (“MOVER-J”) (Laud 2017)3. Coverage properties remain generally inferior SCAS - larger sample sizes, MOVER-J two-sided coverage close (slightly ) nominal level, central location achieved (except RR contrast). corresponding hypothesis test MOVER methods. MOVER-J interval binomial RD observed data obtained using: comparison, Newcombe’s version using Wilson intervals : MOVER approach may modified adapting Jeffreys interval (uses non-informative Beta(0.5,0.5)Beta(0.5, 0.5) prior group rates) incorporate prior information p1p_1 p2p_2 approximate Bayesian interval. example, given data pilot study 1/10 events first group 0/10 second group, non-informative Beta(0.5,0.5)Beta(0.5, 0.5) prior distributions p1p_1 p2p_2 might updated follows: WARNING: Note confidence intervals ratio measures equivariant, sense : interchanging groups produces reciprocal intervals RR , .e. lower upper confidence limits x1/n1x_1/n_1 vs x2/n2x_2/n_2 reciprocal upper lower limits x2/n2x_2/n_2 vs x1/n1x_1/n_1 addition , interchanging events non-events produces reciprocal intervals, .e. lower upper confidence limits odds ratio (n1−x1)/n1(n_1 - x_1)/n_1 vs (n2−x2)/n2(n_2 - x_2)/n_2 reciprocal upper lower limits x1/n1x_1/n_1 vs x2/n2x_2/n_2. Unfortunately, MOVER method contrast = “”, described (Morten W. Fagerland Newcombe 2012), satisfy second requirements.","code":"moverci(x1 = 5, n1 = 56, x2 = 0, n = 29) #>         lower   est upper #> [1,] -0.00973 0.084 0.177 moverci(x1 = 5, n1 = 56, x2 = 0, n = 29, type = \"wilson\") #>        lower    est upper #> [1,] -0.0381 0.0893 0.193 moverbci(x1 = 5, n1 = 56, x2 = 0, n = 29, a1 = 1.5, b1 = 9.5, a2 = 0.5, b2 = 10.5) #>        lower    est upper #> [1,] 0.00917 0.0872 0.172"},{"path":"https://petelaud.github.io/ratesci/articles/paired_contrasts.html","id":"introduction-to-pairbinci-and-related-functions-for-computing-confidence-intervals-and-tests-for-comparisons-of-paired-binomial-proportions","dir":"Articles","previous_headings":"","what":"Introduction to pairbinci() and related functions for computing confidence intervals and tests for comparisons of paired binomial proportions","title":"3: Paired contrasts","text":"Data structure:","code":""},{"path":"https://petelaud.github.io/ratesci/articles/paired_contrasts.html","id":"scas-and-other-asymptotic-score-methods-for-rd-and-rr","dir":"Articles","previous_headings":"Introduction to pairbinci() and related functions for computing confidence intervals and tests for comparisons of paired binomial proportions","what":"SCAS and other asymptotic score methods for RD and RR","title":"3: Paired contrasts","text":"calculate confidence interval (CI) paired risk difference (θ̂RD=p̂1−p̂2\\hat \\theta_{RD} = \\hat p_1 - \\hat p_2, p̂1=(+b)/N\\hat p_1 = (+b)/N, p̂2=(+c)/N\\hat p_2 = (+c)/N), relative risk (θ̂RR=p̂1/p̂2\\hat \\theta_{RR} = \\hat p_1 / \\hat p_2), Skewness-Corrected Asymptotic Score (SCAS) method recommended, one succeeds, average, containing true parameter θ\\theta appropriate nominal probability (e.g. 95%), evenly distributed tail probabilities [Laud2025, review]. modified version asymptotic score methods (Tango 1998) RD, (Nam Blackwelder 2002) (Tang, Tang, Chan 2003) RR, incorporating skewness correction correction variance estimate. plots illustrate one-sided two-sided interval coverage probabilities achieved SCAS compared popular methods1, N=40N=40 correlation coefficient 0.25. selection coverage probability plots sample sizes correlations can found “plots” folder cpplot GitHub repository.  pairbinci() takes input form vector length 4, comprising four values c(, b, c, d) table, number paired observations four possible pairs outcomes. example, using dataset study airway reactivity children stem cell transplantation, used (Fagerland, Lydersen, Laake 2014): underlying z-statistic used obtain two-sided hypothesis test null hypothesis difference (pval2sided). Note equivalent ‘N-1’ adjusted version McNemar test. facility also provided custom one-sided test specified null hypothesis value θ0\\theta_0, e.g. non-inferiority testing (pval_left pval_right). confidence interval paired RR, use: obtain legacy Tango Tang intervals RD RR respectively, may set skew bcf arguments FALSE. Also switching method = \"Score_closed\" takes advantage closed-form calculations methods (whereas SCAS method solved iteration).","code":"out <- pairbinci(x = c(1, 1, 7, 12)) out$estimates #>       lower    est   upper level  p1hat p2hat  p1mle p2mle phi_hat phi_c #> [1,] -0.528 -0.286 -0.0184  0.95 0.0952 0.381 0.0952 0.381  0.0795     0 #>      psi_hat #> [1,]    1.71 out$pval #>      chisq pval2sided theta0 scorenull pval_left pval_right #> [1,]  4.29     0.0384      0     -2.07    0.0192      0.981 out <- pairbinci(x = c(1, 1, 7, 12), contrast = \"RR\") out$estimates #>       lower   est upper level  p1hat p2hat  p1mle p2mle phi_hat phi_c psi_hat #> [1,] 0.0429 0.263 0.928  0.95 0.0952 0.381 0.0994 0.379  0.0795     0    1.71 out$pval #>      chisq pval2sided theta0 scorenull pval_left pval_right #> [1,]  4.29     0.0384      1     -2.07    0.0192      0.981"},{"path":"https://petelaud.github.io/ratesci/articles/paired_contrasts.html","id":"mover-methods","dir":"Articles","previous_headings":"Introduction to pairbinci() and related functions for computing confidence intervals and tests for comparisons of paired binomial proportions","what":"MOVER methods","title":"3: Paired contrasts","text":"application MOVER method paired RD RR, estimate correlation coefficient included formula. correction correlation estimate, introduced Newcombe, recommended, obtained method = \"MOVER_newc\". unpaired MOVER methods, default base method used individual (marginal) proportions equal-tailed Jeffreys interval, rather Wilson Score originally proposed Newcombe (obtained using moverbase = \"wilson\"). combination Newcombe correlation estimate Jeffreys intervals gives designation “MOVER-NJ”. method less computationally intensive SCAS, coverage properties inferior, corresponding hypothesis test. cross-checking published example (Fagerland, Lydersen, Laake 2014)","code":"pairbinci(x = c(1, 1, 7, 12), contrast = \"RD\", method = \"MOVER_newc\")$estimates #>       lower    est   upper level  p1hat p2hat phi_hat #> [1,] -0.511 -0.286 -0.0324  0.95 0.0952 0.381       0 pairbinci(x = c(1, 1, 7, 12), contrast = \"RD\", method = \"MOVER_newc\", moverbase = \"wilson\")$estimates #>       lower    est   upper level  p1hat p2hat phi_hat #> [1,] -0.507 -0.286 -0.0256  0.95 0.0952 0.381       0"},{"path":"https://petelaud.github.io/ratesci/articles/paired_contrasts.html","id":"conditional-odds-ratio","dir":"Articles","previous_headings":"Introduction to pairbinci() and related functions for computing confidence intervals and tests for comparisons of paired binomial proportions","what":"Conditional odds ratio","title":"3: Paired contrasts","text":"Confidence intervals paired odds ratio obtained conditional number discordant pairs, transforming confidence interval proportion b/(b+c)b / (b+c). Transformed SCAS (without variance bias correction, ensure consistency SCAS hypothesis tests RD RR) transformed mid-p intervals recommended [Laud2025, review]. select alternative method, example transformed mid-p:","code":"out <- pairbinci(x = c(1, 1, 7, 12), contrast = \"OR\") out$estimates #>       lower   est upper #> [1,] 0.0077 0.162 0.912 out$pval #>      chisq pval2sided theta0 scorenull pval_left pval_right #> [1,]  4.29     0.0384      1     -2.07    0.0192      0.981 pairbinci(x = c(1, 1, 7, 12), contrast = \"OR\", method = \"midp\")$estimates #>        lower  est upper #> [1,] 0.00629 0.16 0.924"},{"path":"https://petelaud.github.io/ratesci/articles/single_rate.html","id":"introduction-to-rateci-and-related-functions-for-estimation-of-a-single-binomial-or-poisson-rate","dir":"Articles","previous_headings":"","what":"Introduction to rateci() and related functions for estimation of a single binomial or Poisson rate","title":"1: Single rate","text":"calculate confidence interval single binomial proportion (p̂=x/n\\hat p = x/n), Skewness-Corrected Asymptotic Score (SCAS) method recommended, one succeeds, average, containing true proportion p appropriate nominal probability (e.g. 95%), evenly distributed tail probabilities (Laud 2017, Appendix S3.5). modified version Wilson Score method. plot illustrates interval non-coverage probability (.e. 1 minus actual probability interval contains true value p) achieved SCAS compared popular methods, using moving average smoothing (solid lines):  Similar patterns coverage seen corresponding methods Poisson rate (Laud 2017). worked example, SCAS 95% interval proportion 1/29 obtained scaspci(), using closed-form calculation (Laud 2017, Appendix .4): rateci() also provides two methods (Jeffreys mid-p) similar coverage properties (Laud 2018): Jeffreys interval can also incorporate prior information pp approximate Bayesian confidence interval. example, pilot study estimate 1/10 used update non-informative Beta(0.5,0.5)Beta(0.5, 0.5) prior pp Beta(1.5,9.5)Beta(1.5, 9.5) distribution: conservative coverage required, continuity adjustment may deployed cc, follows, giving continuity-adjusted SCAS Jeffreys, (cc TRUE 0.5), Clopper-Pearson method. Note intermediate adjustments smaller 0.5 give refined adjustment(Laud 2017, Appendix S2).","code":"scaspci(x = 1, n = 29) #>        lower    est upper #> [1,] 0.00199 0.0398 0.155 rateci(x = 1, n = 29) #> $scas #>        lower    est upper #> [1,] 0.00199 0.0398 0.155 #>  #> $jeff #>        lower    est upper #> [1,] 0.00375 0.0403  0.15 #>  #> $midp #>        lower    est upper #> [1,] 0.00172 0.0391 0.159 jeffreysci(x = 1, n = 29, ai = 1.5, bi = 9.5) #>       lower    est upper #> [1,] 0.0108 0.0553 0.154 rateci(x = 1, n = 29, cc = TRUE) #> $scas_cc #>         lower    est upper #> [1,] 6.19e-06 0.0398 0.182 #>  #> $jeff_cc #>         lower    est upper #> [1,] 0.000873 0.0403 0.178 #>  #> $cp #>         lower    est upper #> [1,] 0.000873 0.0391 0.178"},{"path":"https://petelaud.github.io/ratesci/articles/single_rate.html","id":"stratified-and-clustered-datasets","dir":"Articles","previous_headings":"Introduction to rateci() and related functions for estimation of a single binomial or Poisson rate","what":"Stratified and clustered datasets","title":"1: Single rate","text":"stratified datasets (e.g. data collected different subgroups collated across different studies), use scoreci() contrast = \"p\" stratified = TRUE (, skewness correction recommended, may omitted). default, fixed effect analysis produced, .e. one assumes common true parameter p across strata. default stratum weighting uses inverse variance score underlying SCAS/Wilson method, evaluated maximum likelihood estimate pooled proportion (thus avoiding infinite weights boundary cases). Alternative weights sample size (weighting = \"MH\") custom user-specified weights supplied via wt argument. example, population weighting applied via vector (e.g. wt = Ni) containing true population size (true population proportion Ni/N) represented stratum. (Note divided sample size/proportion per stratum, weighting applied group level, case level.) illustration using data control arm 9 trials studying postoperative deep vein thrombosis (DVT). may somewhat unrealistic example, main focus studies estimate effect treatment, rather estimate underlying risk event, used illustrate usage scoreci() stratified dataset: function also outputs p-values 2-sided hypothesis test default null hypothesis p = 0.5, one-sided tests user-specified value theta0: Qtest output object provides heterogeneity test related quantities. instance, appears significant variability studies underlying event rate control group, may reflect different characteristics populations study leading different underlying risk. (Note need prevent evaluation stratified treatment comparisons): Per-stratum estimates produced, including stratum weights contributions Q-statistic. studies contributing 3rd 8th study, estimated proportions 0.48 (95% CI: 0.34 0.62) 0.04 (95% CI: 0.01 0.10) respectively: random effects analysis, use random = TRUE. (may give meaningful estimate stratum variation number strata small.) clustered data, use clusterpci(), applies Wilson-based method proposed (Saha, Miller, Wang 2015), skewness-corrected version: (except clusterpci()) can also handle Poisson exposure-adjusted rates, using distrib = \"poi\", n represents exposure time.","code":"data(compress, package = \"ratesci\") strat_p <- scoreci(x1 = compress$event.control,                     n1 = compress$n.control,                     contrast = \"p\",                     stratified = TRUE) strat_p$estimates #>      lower   est upper level p1hat p1mle #> [1,] 0.181 0.212 0.245  0.95 0.212 0.212 strat_p$pval #>      chisq pval2sided theta0 scorenull pval_left pval_right #> [1,]   208   4.05e-47    0.5     -14.4  2.02e-47          1 strat_p$Qtest #>            Q         Q_df     pval_het           I2         tau2           Qc  #>     6.37e+01     8.00e+00     8.84e-11     8.74e+01     1.74e-02     0.00e+00  #> pval_qualhet  #>     9.96e-01 strat_p$stratdata #>       x1j n1j p1hatj wt_fixed wtpct_fixed wtpct_rand theta_j lower_j upper_j #>  [1,]  37 103 0.3592    616.0       16.43      16.43  0.3597  0.2713   0.455 #>  [2,]   5  10 0.5000     59.8        1.59       1.59  0.5000  0.2175   0.782 #>  [3,]  23  48 0.4792    287.1        7.66       7.66  0.4793  0.3419   0.619 #>  [4,]  16 110 0.1455    657.8       17.54      17.54  0.1465  0.0888   0.221 #>  [5,]   7  32 0.2188    191.4        5.10       5.10  0.2216  0.1021   0.384 #>  [6,]   8  25 0.3200    149.5        3.99       3.99  0.3224  0.1626   0.517 #>  [7,]  17 126 0.1349    753.5       20.10      20.10  0.1359  0.0835   0.203 #>  [8,]   4  92 0.0435    550.2       14.67      14.67  0.0451  0.0143   0.101 #>  [9,]  16  81 0.1975    484.4       12.92      12.92  0.1988  0.1219   0.294 #>           V_j Stheta_j      Q_j #>  [1,] 0.00162  0.14695 13.30145 #>  [2,] 0.01672  0.28773  4.95092 #>  [3,] 0.00348  0.26689 20.44757 #>  [4,] 0.00152 -0.06682  2.93717 #>  [5,] 0.00523  0.00648  0.00803 #>  [6,] 0.00669  0.10773  1.73503 #>  [7,] 0.00133 -0.07735  4.50878 #>  [8,] 0.00182 -0.16880 15.67615 #>  [9,] 0.00206 -0.01474  0.10529 strat_p_rand <- scoreci(x1 = compress$event.control,                          n1 = compress$n.control,                          contrast = \"p\",                          stratified = TRUE,                          random = TRUE) strat_p_rand$estimates #>      lower  est upper level p1hat p1mle #> [1,] 0.136 0.25 0.364  0.95  0.25  0.25 strat_p_rand$pval #>      chisq pval2sided theta0 scorenull pval_left pval_right #> [1,]  25.2    0.00102    0.5     -5.02  0.000511      0.999 # Data from Liang 1992   x <- c(rep(c(0, 1), c(36, 12)),           rep(c(0, 1, 2), c(15, 7, 1)),           rep(c(0, 1, 2, 3), c(5, 7, 3, 2)),           rep(c(0, 1, 2), c(3, 3, 1)),           c(0, 2, 3, 4, 6))   n <- c(rep(1, 48),           rep(2, 23),           rep(3, 17),           rep(4, 7),           rep(6, 5))   # Wilson-based interval as per Saha et al.   clusterpci(x, n, skew = FALSE) #>       lower    est  upper totx totn xihat    icc #> [1,] 0.2285 0.2956 0.3728   60  203 1.349 0.1855   # Skewness-corrected version   clusterpci(x, n, skew = TRUE) #>       lower    est  upper totx totn xihat    icc #> [1,] 0.2276 0.2958 0.3724   60  203 1.349 0.1855"},{"path":"https://petelaud.github.io/ratesci/articles/single_rate.html","id":"technical-details","dir":"Articles","previous_headings":"","what":"Technical details","title":"1: Single rate","text":"SCAS method extension Wilson Score method, using score function S(p)=x/n−pS(p) = x / n - p, xx observed number events nn trials, pp true proportion. variance S(p)S(p) V=p(1−p)/nV = p(1 - p)/n, 3rd central moment μ3=p(1−p)(1−2p)/n2\\mu_3 = p(1 - p)(1 - 2p)/n^2. 100(1−α)%100(1 - \\alpha)\\% confidence interval found two solutions following equation, zz 1−α/21 - \\alpha / 2 percentile standard normal distribution: S(p)/V1/2−(z2−1)μ3/6V3/2=±z S(p)/V^{1/2} - (z^2 - 1)\\mu_3/6V^{3/2} = \\pm z unstratified datasets, closed-form solution. formula extended (Laud 2017) incorporate stratification using inverse variance weights, wi=1/Vw_i = 1 / V, weighting schemes required, solution found iteration p∈[0,1]p \\[0, 1]. Jeffreys interval obtained α/2\\alpha / 2 1−α/21 - \\alpha / 2 quantiles Beta(x+0.5,n−x+0.5)Beta(x + 0.5, n - x + 0.5) distribution, boundary modifications x=0x = 0 x=nx = n(Brown, Cai, DasGupta 2001). Clopper-Pearson interval may also obtained quantiles beta distribution (Brown, Cai, DasGupta 2001), using Beta(x,n−x+1)Beta(x, n - x + 1) lower confidence limit, Beta(x+1,n−x)Beta(x + 1, n - x) upper limit.","code":""},{"path":[]},{"path":"https://petelaud.github.io/ratesci/articles/tests.html","id":"unstratified-superiority-test","dir":"Articles","previous_headings":"Introduction to hypothesis tests produced by scoreci() and pairbinci()","what":"Unstratified superiority test","title":"4: Tests","text":"single-stratum dataset, comparisons binomial proportions supplemented two-sided p-value test superiority, .e. null hypothesis p1=p2p_1 = p_2 (θRD=0\\theta_{RD} = 0, θRR=1\\theta_{RR} = 1, θOR=1\\theta_{} = 1), results consistent across three contrasts. skewness correction omitted, tests equivalent Egon Pearson ‘N-1’ Chi-squared test, recommended conventional Karl Pearson test (Campbell 2007): direct equivalence Chi-squared test also holds skewness correction included, group sizes equal (see ). group sizes unequal, SCAS 2-sided test improved variant Chi-squared test.","code":"scoreci(x1 = 5, n1 = 56, x2 = 0, n = 29, skew = FALSE)$pval[, 1:2] #>      chisq pval2sided  #>    2.71875    0.09918 scoreci(x1 = 5, n1 = 56, x2 = 0, n = 29, skew = FALSE, contrast = \"RR\")$pval[, 1:2] #>      chisq pval2sided  #>    2.71875    0.09918 scoreci(x1 = 5, n1 = 56, x2 = 0, n = 29, skew = FALSE, contrast = \"OR\")$pval[, 1:2] #>      chisq pval2sided  #>    2.71875    0.09918 k_pearson <- chisq.test(x = matrix(c(5, 51, 0, 29), nrow = 2), correct = FALSE)$statistic #> Warning in chisq.test(x = matrix(c(5, 51, 0, 29), nrow = 2), correct = FALSE): #> Chi-squared approximation may be incorrect pchisq(k_pearson * ((56+29-1)/(56+29)), df = 1, lower.tail = FALSE) #> X-squared  #>   0.09918 scoreci(x1 = 5, n1 = 56, x2 = 0, n = 56, skew = FALSE)$pval[, 1:2] #>      chisq pval2sided  #>    5.18692    0.02276 scoreci(x1 = 5, n1 = 56, x2 = 0, n = 56, skew = TRUE)$pval[, 1:2] #>      chisq pval2sided  #>    5.18692    0.02276"},{"path":"https://petelaud.github.io/ratesci/articles/tests.html","id":"unstratified-non-inferiority-test","dir":"Articles","previous_headings":"Introduction to hypothesis tests produced by scoreci() and pairbinci()","what":"Unstratified non-inferiority test","title":"4: Tests","text":"addition, pair 1-sided tests conducted user-specified value contrast parameter, θ0\\theta_0, cater non-zero non-unity null hypotheses equivalence non-inferiority tests. 1-sided test analogous Farrington-Manning test, identical , due ‘N-1’ variance bias correction skewness correction, provide improved control Type 1 error (Laud 2017), also (Laud Dane 2014), used label GNbc SCAS (Note Type 1 error Farrington-Manning test 1-sided coverage Mee method).","code":""},{"path":"https://petelaud.github.io/ratesci/articles/tests.html","id":"stratified-tests","dir":"Articles","previous_headings":"Introduction to hypothesis tests produced by scoreci() and pairbinci()","what":"Stratified tests","title":"4: Tests","text":"stratified datasets, “conventional” hypothesis test Cochran-Mantel-Haenszel (CMH) test. Unlike single stratum case, CMH test already incorporates ‘N-1’ variance bias correction. Different weighting schemes permitted stratified analysis - Mantel-Haenszel weighting used contrast = \"RD\" contrast = \"RR\" IVS weighting contrast = \"\", stratified SCAS 2-sided test skewness-corrected version CMH test. unstratified case, group sizes equal, skewness correction term zero. 1-sided test analogous stratified version ‘N-1’ adjusted skewness-corrected Farrington-Manning test. achieved reframing Miettinen-Nurminen’s score statistic normally distributed z-statistic instead chi-squared statistic.","code":""},{"path":"https://petelaud.github.io/ratesci/articles/tests.html","id":"tests-for-paired-binomial-proportions","dir":"Articles","previous_headings":"Introduction to hypothesis tests produced by scoreci() and pairbinci()","what":"Tests for paired binomial proportions","title":"4: Tests","text":"superiority test given pairbinci() (contrast) ‘N-1’ adjusted version McNemar test (skewness correction term zero null hypothesis value θ\\theta). extensive evaluation many thousands sample sizes correlations, paired SCAS 2-sided test violate nominal significance level point, suggesting -conservative “continuity corrected” version given default mcnemar.test() superfluous. 1-sided tests skewness-corrected ‘N-1’ adjusted version Nam’s score test (Nam 1997), coverage properties examined [Laud2025, evaluation].","code":"pairbinci(x = c(1, 1, 7, 12), skew = TRUE)$pval #>      chisq pval2sided theta0 scorenull pval_left pval_right #> [1,] 4.286    0.03843      0     -2.07   0.01922     0.9808 pairbinci(x = c(1, 1, 7, 12), skew = FALSE)$pval #>      chisq pval2sided theta0 scorenull pval_left pval_right #> [1,] 4.286    0.03843      0     -2.07   0.01922     0.9808 pairbinci(x = c(1, 1, 7, 12), skew = FALSE, contrast = \"RR\")$pval #>      chisq pval2sided theta0 scorenull pval_left pval_right #> [1,] 4.286    0.03843      1     -2.07   0.01922     0.9808 mcnem <- mcnemar.test(x = matrix(c(1, 1, 7, 12), nrow = 2), correct = FALSE)$statistic names(mcnem) <- NULL pchisq(mcnem * (21-1)/21, df = 1, lower.tail = FALSE) #> [1] 0.03843"},{"path":"https://petelaud.github.io/ratesci/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Pete Laud. Author, maintainer.","code":""},{"path":"https://petelaud.github.io/ratesci/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Laud P (2025). ratesci: Confidence Intervals Tests Comparisons Binomial Proportions Poisson Rates. R package version 0.5.0.9000, https://petelaud.github.io/ratesci/, https://github.com/petelaud/ratesci.","code":"@Manual{,   title = {ratesci: Confidence Intervals and Tests for Comparisons of Binomial Proportions or Poisson Rates},   author = {Pete Laud},   year = {2025},   note = {R package version 0.5.0.9000, https://petelaud.github.io/ratesci/},   url = {https://github.com/petelaud/ratesci}, }"},{"path":"https://petelaud.github.io/ratesci/index.html","id":"ratesci-","dir":"","previous_headings":"","what":"Confidence Intervals and Tests for Comparisons of Binomial Proportions or Poisson Rates","title":"Confidence Intervals and Tests for Comparisons of Binomial Proportions or Poisson Rates","text":"ratesci R package compute confidence intervals tests : single binomial proportion, Poisson rate (‘p’) binomial risk difference Poisson rate difference (‘RD’) binomial relative risk Poisson rate ratio (‘RR’) binomial odds ratio (‘’) stratified calculations paired binomial contrasts RD RR paired odds ratio using conditional model binomial proportion clustered data number different methods offered, case, recommended default based asymptotic score methodology ((Wilson 1927), (Miettinen Nurminen 1985) (Tango 1998)), including skewness corrections following principles (Gart Nam 1988). resulting family skewness-corrected asymptotic score (SCAS) methods (Laud 2017), [Laud2025, review] ensures equal-tailed coverage (central location), words nominal 95% confidence interval, one-sided non-coverage probability (average) close 2.5% side. Stratified calculations also catered (e.g. meta-analysis, including random effects). list covered scoreci(), exception clustered proportions (uses clusterpci()) paired contrasts (pairbinci()). See vignettes details examples SCAS methods single rate, basic contrasts, paired contrasts. case, asymptotic score methods provide corresponding hypothesis test specified null parameter value, superiority test non-inferiority test, guaranteed coherence test interval. superiority test variant (many cases identical ) Chi-squared test CMH test, non-inferiority test analogous Farrington-Manning test, improved control Type 1 error achieved bias skewness corrections. paired proportions, superiority test ‘N-1’ adjusted variant McNemar test, appears (empirical observation) never violate nominal significance level. See tests vignette details relationships SCAS tests conventional Chi-squared CMH tests Another family methods offered package, reasonable performance large (single-stratum) sample sizes (without corresponding hypothesis test), uses Method Variance Estimates Recovery (MOVER), also known Square--Add (Newcombe 2012, chap. 7). methods combine intervals calculated separately proportion. recommended default gives MOVER-J method, using Jeffreys equal-tailed intervals instead Wilson method preferred Newcombe. improves traditional approximate methods respect one-sided two-sided coverage, particularly case RR, match performance SCAS method. Jeffreys interval based Bayesian conjugate prior, MOVER approach allows option incorporate prior beliefs rates group - default, non-informative Jeffreys Beta(0.5,0.5)Beta(0.5, 0.5) priors used. MOVER intervals available moverci() contrasts independent binomial Poisson rates, pairbinci() paired binomial contrasts. wishing achieve strictly conservative coverage, continuity adjustments provided approximations “exact” methods, option adjust strength adjustment (Yates correction widely recognised -conservative adjustment). performance adjustments extensively evaluated, appear successful SCAS MOVER, terms achieving conservative coverage. online calculator based package available . Plots illustrating coverage properties selected methods can found , .","code":""},{"path":"https://petelaud.github.io/ratesci/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Confidence Intervals and Tests for Comparisons of Binomial Proportions or Poisson Rates","text":"current official (.e. CRAN) release can installed within R : latest development version package can installed : builds package source based current version GitHub","code":"install.packages(\"ratesci\") # install.packages(\"pak\") pak::pak(\"petelaud/ratesci\")"},{"path":"https://petelaud.github.io/ratesci/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Confidence Intervals and Tests for Comparisons of Binomial Proportions or Poisson Rates","text":"basic example shows request confidence interval difference proportions 5/56 - 0/29. $call output element shows default settings give interval risk difference (contrast = \"RD\"), binomial proportions (distrib = \"bin\"), 95% confidence level. Variance bias correction (bcf) skewness correction (skew) applied, continuity adjustment (cc) . skewness-corrected asymptotic score (“SCAS”) confidence interval. (Miettinen-Nurminen, use skew = FALSE, Gart-Nam, use bcf = FALSE.) example paired analysis follows, using data Table II (Fagerland, Lydersen, Laake 2014). bias skewness corrections applied default. Omitting produce Tango asymptotic score interval contrast = \"RD\", Tang method contrast = \"RR\".","code":"library(ratesci) scoreci(x1 = 5, n1 = 56, x2 = 0, n2 = 29) #> $estimates #>         lower     est  upper level x1 n1 x2 n2   p1hat p2hat   p1mle p2mle #> [1,] -0.01862 0.09169 0.1867  0.95  5 56  0 29 0.08929     0 0.09169     0 #>  #> $pval #>      chisq pval2sided theta0 scorenull pval_left pval_right #> [1,] 3.025      0.082      0     1.739     0.959      0.041 #>  #> $call #>  distrib contrast    level      bcf     skew       cc  #>    \"bin\"     \"RD\"   \"0.95\"   \"TRUE\"   \"TRUE\"  \"FALSE\" pairbinci(x = c(1, 1, 7, 12)) #> $data #>    x2i #> x1i  0  1 #>   0 12  7 #>   1  1  1 #>  #> $estimates #>        lower     est    upper level   p1hat p2hat  p1mle  p2mle phi_hat phi_c #> [1,] -0.5281 -0.2859 -0.01842  0.95 0.09524 0.381 0.0952 0.3811 0.07954     0 #>      psi_hat #> [1,]   1.714 #>  #> $pval #>      chisq pval2sided theta0 scorenull pval_left pval_right #> [1,] 4.286    0.03843      0     -2.07   0.01922     0.9808 #>  #> $call #> contrast   method    level      bcf     skew       cc  #>     \"RD\"  \"Score\"   \"0.95\"   \"TRUE\"   \"TRUE\"  \"FALSE\""},{"path":"https://petelaud.github.io/ratesci/index.html","id":"overview","dir":"","previous_headings":"Example","what":"Overview","title":"Confidence Intervals and Tests for Comparisons of Binomial Proportions or Poisson Rates","text":"ratesci contains following functions: comparisons rates (contrasts RD, RR ): scoreci(): score-based confidence intervals including SCAS, Miettinen-Nurminen Gart-Nam, without stratification. scasci(): wrapper function compute SCAS intervals. tdasci(): wrapper function compute TDAS stratified intervals incorporating random effects. moverci(): MOVER methods, including Newcombe MOVER-J. moverbci(): wrapper function compute MOVER-B intervals. pairbinci(): paired binomial data, including SCAS, asymptotic score MOVER methods RD RR, transformed binomial intervals conditional . single binomial Poisson rates: scaspci(): non-iterative SCAS method single rate. stratified calculations use scoreci() contrast = \"p\". jeffreysci(): wrapper function compute Jeffreys interval single rate (option incorporate prior information). rateci(): wrapper function selected methods single rate, including SCAS, Jeffreys, midp Clopper-Pearson/Garwood. clusterpci(): Saha’s Wilson-based interval single proportion based clustered data, skewness-corrected version.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/cisapride.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from systematic review of the effect of cisapride for treatment of non-ulcer dyspepsia — cisapride","title":"Data from systematic review of the effect of cisapride for treatment of non-ulcer dyspepsia — cisapride","text":"Data systematic review effect cisapride treatment non-ulcer dyspepsia","code":""},{"path":"https://petelaud.github.io/ratesci/reference/cisapride.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data from systematic review of the effect of cisapride for treatment of non-ulcer dyspepsia — cisapride","text":"","code":"cisapride"},{"path":"https://petelaud.github.io/ratesci/reference/cisapride.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from systematic review of the effect of cisapride for treatment of non-ulcer dyspepsia — cisapride","text":"data frame five variables: study Study author event.cisa Number events (successes) cisapride-treated group n.cisa Number patients cisapride-treated group event.plac Number events (successes) placebo group n.plac Number patients placebo group","code":""},{"path":"https://petelaud.github.io/ratesci/reference/cisapride.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Data from systematic review of the effect of cisapride for treatment of non-ulcer dyspepsia — cisapride","text":"https://onlinelibrary.wiley.com/doi/10.1002/sim.1009","code":""},{"path":"https://petelaud.github.io/ratesci/reference/clusterpci.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence intervals for a single binomial rate from clustered data. — clusterpci","title":"Confidence intervals for a single binomial rate from clustered data. — clusterpci","text":"Asymptotic Score confidence intervals proportion estimated clustered sample, decribed Saha et al. 2016. optional skewness correction improve interval location (evaluated). added: Hypothesis test. Poisson rate version? (Possibly using dispersion index = var/mean)","code":""},{"path":"https://petelaud.github.io/ratesci/reference/clusterpci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence intervals for a single binomial rate from clustered data. — clusterpci","text":"","code":"clusterpci(x, n, level = 0.95, skew = TRUE, cc = FALSE)"},{"path":"https://petelaud.github.io/ratesci/reference/clusterpci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence intervals for a single binomial rate from clustered data. — clusterpci","text":"x Numeric vector number events per cluster. n Numeric vector sample sizes per cluster. level Number specifying confidence level (0 1, default 0.95). skew Logical (default TRUE) indicating whether apply skewness correction . (evaluated) cc Number logical (default FALSE) specifying (amount ) continuity adjustment. Numeric value taken gamma parameter Laud 2017, Appendix S2 (default 0.5 'conventional' adjustment cc = TRUE).","code":""},{"path":"https://petelaud.github.io/ratesci/reference/clusterpci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence intervals for a single binomial rate from clustered data. — clusterpci","text":"list containing following components: estimates estimate confidence interval p specified confidence level, along estimates ICC variance inflation factor, xihat","code":""},{"path":"https://petelaud.github.io/ratesci/reference/clusterpci.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Confidence intervals for a single binomial rate from clustered data. — clusterpci","text":"Saha K, Miller D Wang S. comparison approximate confidence intervals single proportion clustered binary outcome data. Int J Biostat 2016; 12:1–18 Short MI et al. novel confidence interval single proportion presence clustered binary outcome data. Stat Meth Med Res 2020; 29(1):111–121","code":""},{"path":"https://petelaud.github.io/ratesci/reference/clusterpci.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Confidence intervals for a single binomial rate from clustered data. — clusterpci","text":"Pete Laud, p.j.laud@sheffield.ac.uk","code":""},{"path":"https://petelaud.github.io/ratesci/reference/clusterpci.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Confidence intervals for a single binomial rate from clustered data. — clusterpci","text":"","code":"# Data example from Liang 1992, used in Saha 2016 and Short 2020:   # Note Saha states the ICC estimate is 0.1871 and Short makes it 0.1855.   # I agree with Short - CI limits differ from Saha to the 4th dp.   x <- c(rep(c(0, 1), c(36, 12)),          rep(c(0, 1, 2), c(15, 7, 1)),          rep(c(0, 1, 2, 3), c(5, 7, 3, 2)),          rep(c(0, 1, 2), c(3, 3, 1)),          c(0, 2, 3, 4, 6))   n <- c(rep(1, 48),          rep(2, 23),          rep(3, 17),          rep(4, 7),          rep(6, 5))   # Wilson-based interval   clusterpci(x, n, skew = FALSE) #>          lower       est     upper totx totn    xihat       icc #> [1,] 0.2284814 0.2955665 0.3728302   60  203 1.349133 0.1855342   # Skewness-corrected version   clusterpci(x, n, skew = TRUE) #>          lower      est     upper totx totn    xihat       icc #> [1,] 0.2276278 0.295815 0.3723694   60  203 1.349133 0.1855342   # With continuity adjustment   clusterpci(x, n, skew = FALSE, cc = TRUE) #>          lower       est     upper totx totn    xihat       icc #> [1,] 0.2262502 0.2955665 0.3754001   60  203 1.349133 0.1855342"},{"path":"https://petelaud.github.io/ratesci/reference/compress.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from systematic review of the effect of graduated compression stockings for prevention of DVT — compress","title":"Data from systematic review of the effect of graduated compression stockings for prevention of DVT — compress","text":"Data systematic review effect graduated compression stockings prevention DVT","code":""},{"path":"https://petelaud.github.io/ratesci/reference/compress.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data from systematic review of the effect of graduated compression stockings for prevention of DVT — compress","text":"","code":"compress"},{"path":"https://petelaud.github.io/ratesci/reference/compress.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from systematic review of the effect of graduated compression stockings for prevention of DVT — compress","text":"data frame five variables: study Study author event.gcs Number events (DVTs) GCS-treated group n.gcs Number patients GCS-treated group event.control Number events (DVTs) control group n.control Number patients control group","code":""},{"path":"https://petelaud.github.io/ratesci/reference/compress.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Data from systematic review of the effect of graduated compression stockings for prevention of DVT — compress","text":"https://www.journalslibrary.nihr.ac.uk/hta/HTA9490","code":""},{"path":"https://petelaud.github.io/ratesci/reference/crash.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from systematic review of the effect on mortality of corticosteroids in traumatic brain injury — crash","title":"Data from systematic review of the effect on mortality of corticosteroids in traumatic brain injury — crash","text":"Data systematic review effect mortality corticosteroids traumatic brain injury","code":""},{"path":"https://petelaud.github.io/ratesci/reference/crash.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data from systematic review of the effect on mortality of corticosteroids in traumatic brain injury — crash","text":"","code":"crash"},{"path":"https://petelaud.github.io/ratesci/reference/crash.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from systematic review of the effect on mortality of corticosteroids in traumatic brain injury — crash","text":"data frame five variables: study Study author year event.steroid Number deaths steroid-treated group n.steroid Number patients steroid-treated group event.control Number deaths control group n.control Number patients control group","code":""},{"path":"https://petelaud.github.io/ratesci/reference/crash.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Data from systematic review of the effect on mortality of corticosteroids in traumatic brain injury — crash","text":"http://www.ncbi.nlm.nih.gov/pubmed/15474134","code":""},{"path":"https://petelaud.github.io/ratesci/reference/jeffreysci.html","id":null,"dir":"Reference","previous_headings":"","what":"Jeffreys and other approximate Bayesian confidence intervals for a single binomial or Poisson rate. — jeffreysci","title":"Jeffreys and other approximate Bayesian confidence intervals for a single binomial or Poisson rate. — jeffreysci","text":"Generalised approximate Bayesian confidence intervals based Beta (binomial rates) Gamma (Poisson rates) conjugate priors. Encompassing Jeffreys method (Beta(0.5, 0.5) Gamma(0.5) respectively), well user-specified prior distribution. Clopper-Pearson method (quantiles Beta distribution described Brown et al. 2001) also included way \"continuity adjustment\" parameter.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/jeffreysci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Jeffreys and other approximate Bayesian confidence intervals for a single binomial or Poisson rate. — jeffreysci","text":"","code":"jeffreysci(   x,   n,   ai = 0.5,   bi = 0.5,   cc = 0,   level = 0.95,   distrib = \"bin\",   adj = TRUE,   ... )"},{"path":"https://petelaud.github.io/ratesci/reference/jeffreysci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Jeffreys and other approximate Bayesian confidence intervals for a single binomial or Poisson rate. — jeffreysci","text":"x Numeric vector number events. n Numeric vector sample sizes (binomial rates) exposure times (Poisson rates). ai, bi Numbers defining Beta prior distribution (default ai = bi = 0.5 Jeffreys interval). Gamma prior Poisson rates requires ai. cc Number logical specifying (amount ) \"continuity adjustment\". cc = 0 (default) gives Jeffreys interval, cc = 0.5 gives Clopper-Pearson interval (Garwood Poisson). value 0 0.5 allows compromise proximate conservative coverage. level Number specifying confidence level (0 1, default 0.95). distrib Character string indicating distribution assumed input data: \"bin\" = binomial (default), \"poi\" = Poisson. adj Logical (default TRUE) indicating whether apply boundary adjustment recommended p108 Brown et al. (set FALSE informative priors used) ... arguments.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/jeffreysci.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Jeffreys and other approximate Bayesian confidence intervals for a single binomial or Poisson rate. — jeffreysci","text":"Laud PJ. Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2017; 16:334-348. Brown LD, Cai TT, DasGupta . Interval estimation binomial proportion. Statistical Science 2001; 16(2):101-133","code":""},{"path":"https://petelaud.github.io/ratesci/reference/jeffreysci.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Jeffreys and other approximate Bayesian confidence intervals for a single binomial or Poisson rate. — jeffreysci","text":"Pete Laud, p.j.laud@sheffield.ac.uk","code":""},{"path":"https://petelaud.github.io/ratesci/reference/jeffreysci.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Jeffreys and other approximate Bayesian confidence intervals for a single binomial or Poisson rate. — jeffreysci","text":"","code":"# Jeffreys method: jeffreysci(x = 5, n = 56) #>           lower        est     upper #> [1,] 0.03489147 0.09177968 0.1846509"},{"path":"https://petelaud.github.io/ratesci/reference/moverbci.html","id":null,"dir":"Reference","previous_headings":"","what":"Approximate Bayesian (","title":"Approximate Bayesian (","text":"Wrapper function MOVER-B methods.  Approximate Bayesian confidence intervals rate (risk) difference (\"RD\") ratio (\"RR\") independent binomial Poisson rates, odds ratio (\"\", binomial ). (developed Newcombe, Donner & Zou, Li et al, Fagerland & Newcombe, generalised \"MOVER-B\" forthcoming publication) including special case \"MOVER-J\" using non-informative priors optional continuity adjustment.  function vectorised x1, x2, n1, n2.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/moverbci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Approximate Bayesian (","text":"","code":"moverbci(   x1,   n1,   x2,   n2,   a1 = 0.5,   b1 = 0.5,   a2 = 0.5,   b2 = 0.5,   distrib = \"bin\",   contrast = \"RD\",   level = 0.95,   cc = 0,   ... )"},{"path":"https://petelaud.github.io/ratesci/reference/moverbci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Approximate Bayesian (","text":"x1, x2 Numeric vectors numbers events group 1 & group 2 respectively. n1, n2 Numeric vectors sample sizes (binomial rates) exposure times (Poisson rates) group. a1, b1, a2, b2 Numbers defining Beta(ai,bi) prior distributions group (default ai = bi = 0.5 Jeffreys uninformative priors). Gamma priors Poisson rates require a1, a2. distrib Character string indicating distribution assumed input data: \"bin\" = binomial (default), \"poi\" = Poisson. contrast Character string indicating contrast interest:  \"RD\" = rate difference (default);  \"RR\" = rate ratio;  \"\" = odds ratio;  \"p\" gives interval single proportion x1/n1. level Number specifying confidence level (0 1, default 0.95). cc Number logical specifying (amount ) continuity adjustment (default FALSE). Numeric value taken gamma parameter Laud 2017, Appendix S2 (default 0.5 cc = TRUE). Forced equal 0.5 type = \"exact\". ... Additional arguments.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/moverbci.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Approximate Bayesian (","text":"Pete Laud, p.j.laud@sheffield.ac.uk","code":""},{"path":"https://petelaud.github.io/ratesci/reference/moverci.html","id":null,"dir":"Reference","previous_headings":"","what":"Method of Variance Estimates Recovery (","title":"Method of Variance Estimates Recovery (","text":"Confidence intervals applying MOVER method (\"Method Variance Estimates Recovery\", developed Newcombe method binomial RD) across different contrasts (RD, RR, ) distributions (binomial, Poisson) using equal-tailed Jeffreys intervals instead Wilson score method event rates.  Also allows general Beta Gamma priors approximate Bayesian confidence interval incorporating prior beliefs group event rates. function vectorised x1, x2, n1, n2.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/moverci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Method of Variance Estimates Recovery (","text":"","code":"moverci(   x1,   n1,   x2 = NULL,   n2 = NULL,   a1 = 0.5,   b1 = 0.5,   a2 = 0.5,   b2 = 0.5,   cc = FALSE,   level = 0.95,   distrib = \"bin\",   contrast = \"RD\",   type = \"jeff\",   adj = FALSE,   ... )"},{"path":"https://petelaud.github.io/ratesci/reference/moverci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Method of Variance Estimates Recovery (","text":"x1, x2 Numeric vectors numbers events group 1 & group 2 respectively. n1, n2 Numeric vectors sample sizes (binomial rates) exposure times (Poisson rates) group. a1, b1, a2, b2 Numbers defining Beta(ai,bi) prior distributions group (default ai = bi = 0.5 Jeffreys method). Gamma priors Poisson rates require a1, a2. cc Number logical specifying (amount ) continuity adjustment (default FALSE). Numeric value taken gamma parameter Laud 2017, Appendix S2 (default 0.5 cc = TRUE). Forced equal 0.5 type = \"exact\". level Number specifying confidence level (0 1, default 0.95). distrib Character string indicating distribution assumed input data: \"bin\" = binomial (default), \"poi\" = Poisson. contrast Character string indicating contrast interest:  \"RD\" = rate difference (default);  \"RR\" = rate ratio;  \"\" = odds ratio;  \"p\" gives interval single proportion x1/n1. type Character string indicating method used intervals individual group rates.  \"jeff\" = Jeffreys equal-tailed intervals (default);  \"exact\" = Clopper-Pearson/Garwood exact intervals (note result strictly conservative interval contrast, except contrast = \"p\". scoreci function cc = TRUE recommended superior approximation 'exact' methods);  \"midp\" = mid-p intervals;  \"SCAS\" = SCAS non-iterative intervals;  \"wilson\" = Wilson score intervals (per Newcombe 1998). (Rao score used distrib = \"poi\")  NB: \"wilson\" option included legacy validation previous published method Newcombe. recommended, type = \"jeff\" equal-tailed options achieve much better coverage properties. adj Logical (default FALSE) indicating whether apply boundary adjustment Jeffreys intervals recommended p108 Brown et al. (type = \"jeff\" : set FALSE using informative priors) ... Additional arguments.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/moverci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Method of Variance Estimates Recovery (","text":"matrix containing confidence interval requested contrast","code":""},{"path":"https://petelaud.github.io/ratesci/reference/moverci.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Method of Variance Estimates Recovery (","text":"Laud PJ. Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2017; 16:334-348. Newcombe RG. Interval estimation difference independent proportions: comparison eleven methods. Statistics Medicine 1998; 17(8):873-890. Donner , Zou G. Closed-form confidence intervals functions normal mean standard deviation. Statistical Methods Medical Research 2012; 21(4):347-359. Fagerland MW, Newcombe RG. Confidence intervals odds ratio relative risk based inverse hyperbolic sine transformation. Statistics Medicine 2013; 32(16):2823-2836. Li HQ, Tang ML, Wong WK. Confidence intervals ratio two Poisson rates using method variance estimates recovery. Computational Statistics 2014; 29(3-4):869-889.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/moverci.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Method of Variance Estimates Recovery (","text":"Pete Laud, p.j.laud@sheffield.ac.uk","code":""},{"path":"https://petelaud.github.io/ratesci/reference/moverci.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Method of Variance Estimates Recovery (","text":"","code":"# Binomial RD, MOVER-J method: moverci(x1 = 5, n1 = 56, x2 = 0, n2 = 29) #>             lower        est     upper #> [1,] -0.009734968 0.08403347 0.1772258  # Binomial RD, Newcombe method: moverci(x1 = 5, n1 = 56, x2 = 0, n2 = 29, type = \"wilson\") #>            lower        est   upper #> [1,] -0.03813715 0.08928571 0.19256"},{"path":"https://petelaud.github.io/ratesci/reference/pairbinci.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence intervals for comparisons of paired binomial rates. — pairbinci","title":"Confidence intervals for comparisons of paired binomial rates. — pairbinci","text":"Confidence intervals rate (risk) difference ('RD'), rate ratio ('RR') conditional odds ratio (''), paired binomial data. (paired Poisson rates, suggest use tdasci function distrib = \"poi\", weighting = \"MH\", pairs strata.) function applies score-based Tango Tang methods RD RR respectively, iterative closed-form versions, skewness correction improved one-sided coverage. Also includes MOVER options using Method Variance Estimates Recovery paired RD RR, incorporating Newcombe's correlation correction, simpler methods Bonett & Price RD RR. Also includes experimental method using stratified TDAS method pairs strata (deprecated?). , intervals produced based transforming various intervals single proportion, including SCASp, mid-p Jeffreys. methods options continuity adjustment, magnitude adjustment can customised.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/pairbinci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence intervals for comparisons of paired binomial rates. — pairbinci","text":"","code":"pairbinci(   x,   level = 0.95,   contrast = \"RD\",   method = ifelse(contrast == \"OR\", \"SCASp\", \"Score\"),   moverbase = ifelse(method %in% c(\"MOVER\", \"MOVER_newc\", \"BP\"), \"jeff\", NULL),   bcf = TRUE,   skew = TRUE,   cc = FALSE,   theta0 = NULL,   precis = 6,   warn = TRUE,   method_RD = NULL,   method_RR = NULL,   method_OR = NULL,   cctype = NULL,   ... )"},{"path":"https://petelaud.github.io/ratesci/reference/pairbinci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence intervals for comparisons of paired binomial rates. — pairbinci","text":"x numeric vector object specified c(, b, c, d) :  number pairs event (e.g. success) conditions (e.g. treated/untreated, case/control)  b count number event condition 1 (= x12)  c count number event condition 2 (= x21)  d number pairs event conditions  (Note order d important contrast=\"RR\".) level Number specifying confidence level (0 1, default 0.95). contrast Character string indicating contrast interest:  \"RD\" = rate difference (default);  \"RR\" = rate ratio;  \"\" = conditional odds ratio. method Character string indicating confidence interval method used. following available contrast = \"RD\" \"RR\":  \"Score\" = iterative Tango (RD) / Tang (RR) asymptotic score (default);  \"Score_closed\" = closed form solution Tango/Tang interval;  \"MOVER\" = hybrid MOVER method (per \"method 8\" Newcombe, choice input methods - see moverbase);  \"MOVER_newc\" = hybrid MOVER methods correction correlation estimate (Newcombe's \"method 10\");  \"TDAS\" = t-distribution asymptotic score (experimental method, seems struggle low numbers);  \"BP\" = Wald Bonett-Price adjustment RD, Hybrid Bonett-Price method RR.  contrast = \"\", one following methods may selected, based transformation interval single proportion b/(b+c):  \"SCASp\" = transformed skewness-corrected score (default);  \"jeff\" = transformed Jeffreys;  \"midp\" = transformed mid-p;  \"wilson\" = transformed Wilson score - included reference , recommended. moverbase Character string indicating base method used input MOVER methods RD RR (method = \"MOVER\" \"MOVER_newc\"), Hybrid BP method RR: \"jeff\" = Jeffreys equal-tailed interval (default), \"SCASp\" = skewness-corrected score, \"midp\" = mid-p, \"wilson\" = Wilson score (recommended, known skewed) bcf Logical (default FALSE) indicating whether apply bias correction score denominator. (evaluation.) skew Logical (default TRUE) indicating whether apply skewness correction . (evaluation, manuscript review.) applies iterative method = \"Score\" cc Number logical (default FALSE) specifying (amount ) continuity adjustment. score-based method used, cc = 0.5 corresponds continuity-corrected McNemar test. theta0 Number used one-sided significance test (e.g. non-inferiority margin). 1-sided p-value < 0.025 iff 2-sided 95\\ excludes theta0. NB: can also used superiority test setting theta0 = 0. precis Number (default 6) specifying precision (.e. number decimal places) used optimisation subroutine confidence interval. warn Logical (default TRUE) giving option suppress warnings. method_RD (deprecated: parameter renamed method) method_RR (deprecated: parameter renamed method) method_OR (deprecated: parameter renamed method) cctype (deprecated: new equivariant cc method implemented instead) ... arguments.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/pairbinci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence intervals for comparisons of paired binomial rates. — pairbinci","text":"list containing following components: data input data 2x2 matrix form estimates requested contrast, confidence interval specified confidence level, along estimates marginal probabilities correlation coefficient (uncorrected corrected) pval corresponding 2-sided significance test null hypothesis p_1 = p_2, one-sided significance tests null hypothesis theta >= <= theta0 specified call details function call","code":""},{"path":"https://petelaud.github.io/ratesci/reference/pairbinci.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Confidence intervals for comparisons of paired binomial rates. — pairbinci","text":"Tango T. Equivalence test confidence interval difference proportions paired-sample design. Statistics Medicine 1998; 17:891-908 Newcombe RG. Improved confidence intervals difference binomial proportions based paired data. Statistics Medicine 1998; 17:2635-2650 Tango T. Improved confidence intervals difference binomial proportions based paired data Robert G. Newcombe, Statistics Medicine, 17, 2635-2650 (1998). Statistics Medicine 1999; 18(24):3511-3513 Nam J-M, Blackwelder WC. Analysis ratio marginal probabilities matched-pair setting. Stat Med 2002; 21(5):689–699 Tang N-S, Tang M-L, Chan ISF. tests equivalence via non-unity relative risk matched-pair design. Statistics Medicine 2003; 22:1217-1233 Agresti , Min Y. Simple improved confidence intervals comparing matched proportions. Statistics Medicine 2005; 24:729-740 Bonett DG, Price RM. Confidence intervals ratio binomial proportions based paired data. Statistics Medicine 2006; 25:3039-3047 Tang M-L, Li H-Q, Tang N-S. Confidence interval construction proportion ratio paired studies based hybrid method. Statistical Methods Medical Research 2010; 21(4):361-378 Tang N-S et al. Asymptotic confidence interval construction proportion difference medical studies bilateral data. Statistical Methods Medical Research. 2011; 20(3):233-259 Yang Z, Sun X Hardin JW. non-iterative implementation Tango's score confidence interval paired difference proportions. Statistics Medicine 2013; 32:1336-1342 Fagerland MW, Lydersen S, Laake P. Recommended tests confidence intervals paired binomial proportions. Statistics Medicine 2014; 33(16):2850-2875 Laud PJ. Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2017; 16:334-348. DelRocco N et al. New Confidence Intervals Relative Risk Two Correlated Proportions. Statistics Biosciences 2023; 15:1–30 Chang P et al. Continuity corrected score confidence interval difference proportions paired data. Journal Applied Statistics 2024; 51-1:139-152 Laud PJ. Comments \"New Confidence Intervals Relative Risk Two Correlated Proportions\" (2023). Statistics Biosciences 2025; https://doi.org/10.1007/s12561-025-09479-4 Laud PJ. Improved confidence intervals tests paired binomial proportions. (2025, review)","code":""},{"path":"https://petelaud.github.io/ratesci/reference/pairbinci.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Confidence intervals for comparisons of paired binomial rates. — pairbinci","text":"Pete Laud, p.j.laud@sheffield.ac.uk","code":""},{"path":"https://petelaud.github.io/ratesci/reference/pairbinci.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Confidence intervals for comparisons of paired binomial rates. — pairbinci","text":"","code":"# Example from Fagerland et al 2014 # SCAS method for RD pairbinci(x = c(1, 1, 7, 12), contrast = \"RD\", method = \"Score\") #> $data #>    x2i #> x1i  0  1 #>   0 12  7 #>   1  1  1 #>  #> $estimates #>          lower       est     upper level    p1hat    p2hat    p1mle    p2mle #> [1,] -0.528113 -0.285861 -0.018422  0.95 0.095238 0.380952 0.095201 0.381062 #>       phi_hat phi_c  psi_hat #> [1,] 0.079536     0 1.714286 #>  #> $pval #>         chisq pval2sided theta0 scorenull  pval_left pval_right #> [1,] 4.285714 0.03843393      0 -2.070197 0.01921697   0.980783 #>  #> $call #> contrast   method    level      bcf     skew       cc  #>     \"RD\"  \"Score\"   \"0.95\"   \"TRUE\"   \"TRUE\"  \"FALSE\"  #>  # Tango method pairbinci(x = c(1, 1, 7, 12), contrast = \"RD\", method = \"Score\", skew = FALSE, bcf = FALSE) #> $data #>    x2i #> x1i  0  1 #>   0 12  7 #>   1  1  1 #>  #> $estimates #>          lower       est     upper level    p1hat    p2hat    p1mle    p2mle #> [1,] -0.517232 -0.285714 -0.026003  0.95 0.095238 0.380952 0.095238 0.380952 #>       phi_hat phi_c  psi_hat #> [1,] 0.079536     0 1.714286 #>  #> $pval #>      chisq pval2sided theta0 scorenull  pval_left pval_right #> [1,]   4.5 0.03389485      0  -2.12132 0.01694743  0.9830526 #>  #> $call #> contrast   method    level      bcf     skew       cc  #>     \"RD\"  \"Score\"   \"0.95\"  \"FALSE\"  \"FALSE\"  \"FALSE\"  #>  # MOVER-NJ method pairbinci(x = c(1, 1, 7, 12), contrast = \"RD\", method = \"MOVER_newc\", moverbase = \"jeff\") #> $data #>    x2i #> x1i  0  1 #>   0 12  7 #>   1  1  1 #>  #> $estimates #>          lower       est     upper level    p1hat    p2hat phi_hat #> [1,] -0.510506 -0.285714 -0.032389  0.95 0.095238 0.380952       0 #>  #> $call #>     contrast       method    moverbase        level          bcf         skew  #>         \"RD\" \"MOVER_newc\"       \"jeff\"       \"0.95\"       \"TRUE\"       \"TRUE\"  #>           cc  #>      \"FALSE\"  #>  # SCAS for RR pairbinci(x = c(1, 1, 7, 12), contrast = \"RR\", method = \"Score\") #> $data #>    x2i #> x1i  0  1 #>   0 12  7 #>   1  1  1 #>  #> $estimates #>         lower      est    upper level    p1hat    p2hat    p1mle    p2mle #> [1,] 0.042901 0.262723 0.928199  0.95 0.095238 0.380952 0.099445 0.378517 #>       phi_hat phi_c  psi_hat #> [1,] 0.079536     0 1.714286 #>  #> $pval #>         chisq pval2sided theta0 scorenull  pval_left pval_right #> [1,] 4.285714 0.03843393      1 -2.070197 0.01921697   0.980783 #>  #> $call #> contrast   method    level      bcf     skew       cc  #>     \"RR\"  \"Score\"   \"0.95\"   \"TRUE\"   \"TRUE\"  \"FALSE\"  #>  # Tang method pairbinci(x = c(1, 1, 7, 12), contrast = \"RR\", method = \"Score\", skew = FALSE, bcf = FALSE) #> $data #>    x2i #> x1i  0  1 #>   0 12  7 #>   1  1  1 #>  #> $estimates #>         lower  est    upper level    p1hat    p2hat    p1mle    p2mle  phi_hat #> [1,] 0.065279 0.25 0.906881  0.95 0.095238 0.380952 0.095238 0.380952 0.079536 #>      phi_c  psi_hat #> [1,]     0 1.714286 #>  #> $pval #>      chisq pval2sided theta0 scorenull  pval_left pval_right #> [1,]   4.5 0.03389485      1  -2.12132 0.01694743  0.9830526 #>  #> $call #> contrast   method    level      bcf     skew       cc  #>     \"RR\"  \"Score\"   \"0.95\"  \"FALSE\"  \"FALSE\"  \"FALSE\"  #>  # MOVER-NJ pairbinci(x = c(1, 1, 7, 12), contrast = \"RR\", method = \"MOVER_newc\", moverbase = \"jeff\") #> $data #>    x2i #> x1i  0  1 #>   0 12  7 #>   1  1  1 #>  #> $estimates #>         lower  est    upper level    p1hat    p2hat phi_hat #> [1,] 0.051297 0.25 0.873051  0.95 0.095238 0.380952       0 #>  #> $call #>     contrast       method    moverbase        level          bcf         skew  #>         \"RR\" \"MOVER_newc\"       \"jeff\"       \"0.95\"       \"TRUE\"       \"TRUE\"  #>           cc  #>      \"FALSE\"  #>  # Transformed SCASp method for OR pairbinci(x = c(1, 1, 7, 12), contrast = \"OR\", method = \"SCASp\") #> $data #>    x2i #> x1i  0  1 #>   0 12  7 #>   1  1  1 #>  #> $estimates #>         lower      est    upper #> [1,] 0.007702 0.161863 0.912315 #>  #> $pval #>         chisq pval2sided theta0 scorenull  pval_left pval_right #> [1,] 4.285714 0.03843393      1 -2.070197 0.01921697   0.980783 #>  #> $call #> contrast   method    level      bcf     skew       cc  #>     \"OR\"  \"SCASp\"   \"0.95\"   \"TRUE\"   \"TRUE\"  \"FALSE\"  #>  # Transformed Wilson method pairbinci(x = c(1, 1, 7, 12), contrast = \"OR\", method = \"wilson\") #> $data #>    x2i #> x1i  0  1 #>   0 12  7 #>   1  1  1 #>  #> $estimates #>         lower      est   upper #> [1,] 0.022932 0.142857 0.88996 #>  #> $call #> contrast   method    level      bcf     skew       cc  #>     \"OR\" \"wilson\"   \"0.95\"   \"TRUE\"   \"TRUE\"  \"FALSE\"  #>"},{"path":"https://petelaud.github.io/ratesci/reference/rateci.html","id":null,"dir":"Reference","previous_headings":"","what":"Selected confidence intervals for the single binomial or Poisson rate. — rateci","title":"Selected confidence intervals for the single binomial or Poisson rate. — rateci","text":"Confidence intervals single binomial Poisson rate. Including SCAS Jeffreys intervals, without continuity adjustment, 'exact' Clopper-Pearson/Garwood mid-p intervals. function vectorised x, n.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/rateci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Selected confidence intervals for the single binomial or Poisson rate. — rateci","text":"","code":"rateci(x, n, distrib = \"bin\", level = 0.95, cc = FALSE)"},{"path":"https://petelaud.github.io/ratesci/reference/rateci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Selected confidence intervals for the single binomial or Poisson rate. — rateci","text":"x Numeric vector number events. n Numeric vector sample size (binomial rate) exposure times (Poisson rate). distrib Character string indicating distribution assumed input data: \"bin\" = binomial (default), \"poi\" = Poisson. level Number specifying confidence level (0 1, default 0.95). cc Number logical (default FALSE) specifying continuity adjustment.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/rateci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Selected confidence intervals for the single binomial or Poisson rate. — rateci","text":"list containing, method, matrix containing lower upper confidence limits value x n. Methods shown depend cc parameter, specifies whether continuity adjustment applied SCAS Jeffreys methods. corresponding 'exact' method Clopper-Pearson/Garwood cc == TRUE mid-p cc == FALSE.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/rateci.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Selected confidence intervals for the single binomial or Poisson rate. — rateci","text":"Laud PJ. Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2017; 16:334-348. (Appendix .4) Brown LD, Cai TT DasGupta . Interval estimation binomial proportion. Statistical Science 2001; 16(2):101-133.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/rateci.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Selected confidence intervals for the single binomial or Poisson rate. — rateci","text":"Pete Laud, p.j.laud@sheffield.ac.uk","code":""},{"path":"https://petelaud.github.io/ratesci/reference/ratesci-package.html","id":null,"dir":"Reference","previous_headings":"","what":"ratesci: Confidence Intervals and Tests for Comparisons of Binomial Proportions or Poisson Rates — ratesci-package","title":"ratesci: Confidence Intervals and Tests for Comparisons of Binomial Proportions or Poisson Rates — ratesci-package","text":"Computes confidence intervals binomial Poisson rates differences ratios. Including rate (risk) difference ('RD') rate ratio (relative risk, 'RR') binomial proportions Poisson rates, odds ratio ('', binomial ). Also confidence intervals RD, RR paired binomial data, estimation proportion clustered binomial data. Includes skewness-corrected asymptotic score ('SCAS') methods, developed Laud (2017) doi:10.1002/pst.1813  Miettinen & Nurminen (1985) doi:10.1002/sim.4780040211  Gart & Nam (1988) doi:10.2307/2531848 , Laud (2025, review) paired proportions. score produces hypothesis tests analogous test binomial RD RR Farrington & Manning (1990) doi:10.1002/sim.4780091208 , McNemar test paired data. package also includes MOVER methods (Method Variance Estimates Recovery) contrasts, derived Newcombe method options use equal-tailed intervals place Wilson score method, generalised Bayesian applications incorporating prior information. -called 'exact' methods strictly conservative coverage approximated using continuity adjustments, amount adjustment can selected avoid -conservative coverage. Also includes methods stratified calculations (e.g. meta-analysis), either fixed effect assumption (matching CMH test) incorporating stratum heterogeneity.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/ratesci-package.html","id":"ratesci-functions","dir":"Reference","previous_headings":"","what":"ratesci functions","title":"ratesci: Confidence Intervals and Tests for Comparisons of Binomial Proportions or Poisson Rates — ratesci-package","text":"scoreci(): score-based confidence intervals scasci(): wrapper function compute SCAS interval tdasci(): wrapper function compute TDAS random effects stratified interval moverci(): MOVER method moverbci(): wrapper function compute MOVER-B interval jeffreysci(): wrapper function compute Jeffreys interval single rate scaspci(): non-iterative SCAS method single rate rateci(): wrapper function SCAS, Jeffreys 'exact' methods single rate pairbinci(): paired binomial data (includes asymptotic score MOVER options) clusterpci(): estimation binomial proportions based clustered data","code":""},{"path":"https://petelaud.github.io/ratesci/reference/ratesci-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"ratesci: Confidence Intervals and Tests for Comparisons of Binomial Proportions or Poisson Rates — ratesci-package","text":"Laud PJ. Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2017; 16:334-348. Laud PJ. Corrigendum: Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2018; 17:290-293. Tang Y. Score confidence intervals sample sizes stratified comparisons binomial proportions. Statistics Medicine 2020; 39:3427–3457. Tang Y. Comments “Equal-tailed confidence intervals comparison rates”. Pharmaceutical Statistics 2021;20:1288-1292. Laud PJ. Author's reply letter editor Yongqiang Tang: Comments “Equal-tailed confidence intervals comparison rates”. Pharmaceutical Statistics 2021; 20:1293-1297 Miettinen OS, Nurminen M. Comparative analysis two rates. Statistics Medicine 1985; 4:213-226. Gart JJ. Analysis common odds ratio: corrections bias skewness. Bulletin International Statistical Institute 1985, 45th session, book 1, 175-176. Gart JJ, Nam JM. Approximate interval estimation ratio binomial parameters: review corrections skewness. Biometrics 1988; 44(2):323-338. Gart JJ, Nam JM. Approximate interval estimation difference binomial parameters: correction skewness extension multiple tables. Biometrics 1990; 46(3):637-643. Farrington CP, Manning G. Test statistics sample size formulae comparative binomial trials null hypothesis non-zero risk difference non-unity relative risk. Statistics Medicine 1990; 9(12):1447–1454. Newcombe RG. Interval estimation difference independent proportions: comparison eleven methods. Statistics Medicine 1998; 17(8):873-890. Donner , Zou G. Closed-form confidence intervals functions normal mean standard deviation. Statistical Methods Medical Research 2012; 21(4):347-359. Tango T. Equivalence test confidence interval difference proportions paired-sample design. Statistics Medicine 1998; 17:891-908 Tang N-S, Tang M-L, Chan ISF. tests equivalence via non-unity relative risk matched-pair design. Statistics Medicine 2003; 22:1217-1233 Laud PJ. Improved confidence intervals tests paired binomial proportions. (2025, review) Saha K, Miller D Wang S. comparison approximate confidence intervals single proportion clustered binary outcome data. Int J Biostat 2016; 12:1–18.","code":""},{"path":[]},{"path":"https://petelaud.github.io/ratesci/reference/ratesci-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ratesci: Confidence Intervals and Tests for Comparisons of Binomial Proportions or Poisson Rates — ratesci-package","text":"Maintainer: Pete Laud p.j.laud@sheffield.ac.uk (ORCID)","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scasci.html","id":null,"dir":"Reference","previous_headings":"","what":"Skewness-corrected asymptotic score (","title":"Skewness-corrected asymptotic score (","text":"Wrapper function SCAS method. Score-based confidence intervals rate (risk) difference (\"RD\") ratio (\"RR\") independent binomial Poisson rates, odds ratio (\"\", binomial ), single rate (\"p\"). (\"GNbc\" method Laud & Dane, developed Gart & Nam, generalised \"SCAS\" Laud 2017) including optional continuity adjustment  function vectorised x1, x2, n1, n2. Vector inputs may also combined single stratified analysis (e.g. meta-analysis). method assumes contrast constant across strata (fixed effects).  'random-effects' method use tdasci (scoreci random = TRUE).","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scasci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Skewness-corrected asymptotic score (","text":"","code":"scasci(   x1,   n1,   x2 = NULL,   n2 = NULL,   distrib = \"bin\",   contrast = \"RD\",   level = 0.95,   cc = FALSE,   theta0 = NULL,   precis = 6,   plot = FALSE,   hetplot = FALSE,   xlim = NULL,   ylim = NULL,   plotmax = 100,   stratified = FALSE,   weighting = NULL,   mn_tol = 1e-08,   MNtol = NULL,   wt = NULL,   warn = TRUE,   ... )"},{"path":"https://petelaud.github.io/ratesci/reference/scasci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Skewness-corrected asymptotic score (","text":"x1, x2 Numeric vectors numbers events group 1 & group 2 respectively. n1, n2 Numeric vectors sample sizes (binomial rates) exposure times (Poisson rates) group. distrib Character string indicating distribution assumed input data: \"bin\" = binomial (default), \"poi\" = Poisson. contrast Character string indicating contrast interest:  \"RD\" = rate difference (default);  \"RR\" = rate ratio;  \"\" = odds ratio;  \"p\" gives interval single proportion rate x1/n1. level Number specifying confidence level (0 1, default 0.95). cc Number logical (default FALSE) specifying (amount ) continuity adjustment. Numeric value taken gamma parameter Laud 2017, Appendix S2 (default 0.5 'conventional' Yates adjustment cc = TRUE).  IMPORTANT NOTES: adjustment (conventionally controversially termed 'continuity correction') aimed approximating strictly conservative coverage, dealing zero cell counts. 'sparse data adjustments' needed score method, except deal double-zero cells stratified  RD (& double-100% cells binomial RD & RR) IVS/INV weights. continuity adjustments provided fully tested stratified methods, found match continuity-adjusted version Mantel-Haenszel test, cc = 0.5 binomial contrasts. Flexibility included less conservative adjustment, cc = 0.25 suggested Laud 2017 (see Appendix S3.4), cc = 3/16 = 0.1875 Mehrotra & Railkar (2000) theta0 Number used one-sided significance test (e.g. non-inferiority margin). 1-sided p-value <0.025 iff 2-sided 95\\ excludes theta0. default, two-sided test theta0 = 0 (RD) 1 (RR/) also output. precis Number (default 6) specifying precision (.e. number decimal places) used optimisation subroutine confidence interval. plot Logical (default FALSE) indicating whether output plot score function hetplot Logical (default FALSE) indicating whether output plots evaluating heterogeneity stratified datasets. xlim pair values indicating range values plotted. ylim pair values indicating range values plotted. plotmax Numeric value indicating maximum value displayed x-axis plots (useful ratio contrasts can infinite). stratified Logical (default FALSE) indicating whether combine vector inputs single stratified analysis.  IMPORTANT NOTE: mechanism stratified calculations enabled contrast = \"p\", performance resulting intervals fully evaluated. weighting String indicating weighting method use stratified = \"TRUE\":  \"IVS\" = Inverse Variance Score (see Laud 2017 details);  \"INV\" = Inverse Variance (bcf omitted, default contrast = \"\");  \"MH\" = Mantel-Haenszel (default contrast = \"RD\" \"RR\"); (= sample size contrast = \"p\");  \"MN\" = Miettinen-Nurminen weights. (similar MH contrast = \"RD\" \"RR\", similar INV contrast = \"\");  CI consistent CMH test, select skew = FALSE, random = FALSE, use default MH weighting RD/RR INV .  Weighting = 'MN' also matches CMH test.  Note: Alternative user-specified weighting may also applied, via 'wt' argument. mn_tol Numeric value indicating convergence tolerance used iteration weighting = \"MN\". MNtol (deprecated: argument renamed mn_tol) wt Numeric vector containing (optional) user-specified weights. warn Logical (default TRUE) giving option suppress warnings. ... arguments.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scasci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Skewness-corrected asymptotic score (","text":"list containing following components: estimates matrix containing estimates rates group requested contrast, confidence interval pval matrix containing details corresponding 2-sided significance test null hypothesis p_1 = p_2, one-sided significance tests null hypothesis theta >= <= theta0 call details function call stratified = TRUE, following outputs added: Qtest vector values describing testing heterogeneity weighting string indicating selected weighting method stratdata matrix containing stratum estimates weights","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scasci.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Skewness-corrected asymptotic score (","text":"Laud PJ. Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2017; 16:334-348. Laud PJ. Corrigendum: Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2018; 17:290-293.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scasci.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Skewness-corrected asymptotic score (","text":"Pete Laud, p.j.laud@sheffield.ac.uk","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scaspci.html","id":null,"dir":"Reference","previous_headings":"","what":"Skewness-corrected asymptotic score (","title":"Skewness-corrected asymptotic score (","text":"function vectorised x, n.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scaspci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Skewness-corrected asymptotic score (","text":"","code":"scaspci(   x,   n,   distrib = \"bin\",   level = 0.95,   bcf = FALSE,   bign = n,   xihat = 1,   cc = FALSE,   ... )"},{"path":"https://petelaud.github.io/ratesci/reference/scaspci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Skewness-corrected asymptotic score (","text":"x Numeric vector number events. n Numeric vector sample sizes (binomial rates) exposure times (Poisson rates). distrib Character string indicating distribution assumed input data: \"bin\" = binomial (default), \"poi\" = Poisson. level Number specifying confidence level (0 1, default 0.95). bcf Logical (default TRUE) indicating whether apply bias correction score denominator. Applicable distrib = \"bin\" . bign Sample size N used calculation bcf, different n. (Used transformed SCASp method paired conditional pairbinci()) xihat Number specifying estimated variance inflation factor skewness corrected version Saha Wilson Score interval clustered binomial proportions. Need calculate using BMS WMS per Saha 2016. Used new clusterpci() function data entered per cluster. cc Number logical (default FALSE) specifying (amount ) continuity adjustment. Numeric value taken gamma parameter Laud 2017, Appendix S2 (default 0.5 'conventional' adjustment cc = TRUE). ... arguments.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scaspci.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Skewness-corrected asymptotic score (","text":"Laud PJ. Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2017; 16:334-348. (Appendix .4)","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scaspci.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Skewness-corrected asymptotic score (","text":"Pete Laud, p.j.laud@sheffield.ac.uk","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scoreci.html","id":null,"dir":"Reference","previous_headings":"","what":"Score confidence intervals for comparisons of independent binomial or Poisson rates. — scoreci","title":"Score confidence intervals for comparisons of independent binomial or Poisson rates. — scoreci","text":"Score-based confidence intervals rate (risk) difference (\"RD\") ratio (\"RR\") independent binomial Poisson rates, odds ratio (\"\", binomial ). Including options bias correction (Miettinen & Nurminen), skewness correction (\"GNbc\" method Laud & Dane, developed Gart & Nam, generalised \"SCAS\" Laud 2017) continuity adjustment (strictly conservative coverage). Also includes score intervals single binomial proportion Poisson rate. Based Wilson score interval, corrected skewness, coverage almost identical mid-p method, Clopper-Pearson also continuity-adjusted. Hypothesis tests superiority non-inferiority provided using score, ensure consistency test CI. function vectorised x1, x2, n1, n2.  Vector inputs may also combined single stratified analysis (e.g. meta-analysis), either using fixed effects, general random effects \"TDAS\" method, incorporates stratum variability using t-distribution score (inspired Hartung-Knapp-Sidik-Jonkman). fixed-effects analysis stratified datasets, weighting = \"MH\" RD RR, weighting = \"INV\" , omitting skewness correction produces CMH test, together coherent confidence interval required contrast.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scoreci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Score confidence intervals for comparisons of independent binomial or Poisson rates. — scoreci","text":"","code":"scoreci(   x1,   n1,   x2 = 0,   n2 = 0,   distrib = \"bin\",   contrast = \"RD\",   level = 0.95,   skew = TRUE,   simpleskew = FALSE,   or_bias = TRUE,   ORbias = NULL,   rr_tang = NULL,   RRtang = NULL,   bcf = ifelse(contrast != \"p\", TRUE, FALSE),   cc = FALSE,   theta0 = NULL,   precis = 6,   plot = FALSE,   plotmax = 100,   hetplot = FALSE,   xlim = NULL,   ylim = NULL,   stratified = FALSE,   weighting = NULL,   mn_tol = 1e-08,   MNtol = NULL,   wt = NULL,   sda = NULL,   fda = NULL,   dropzeros = FALSE,   random = FALSE,   prediction = FALSE,   warn = TRUE,   ... )"},{"path":"https://petelaud.github.io/ratesci/reference/scoreci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Score confidence intervals for comparisons of independent binomial or Poisson rates. — scoreci","text":"x1, x2 Numeric vectors numbers events group 1 & group 2 respectively. n1, n2 Numeric vectors sample sizes (binomial rates) exposure times (Poisson rates) group. distrib Character string indicating distribution assumed input data: \"bin\" = binomial (default), \"poi\" = Poisson. contrast Character string indicating contrast interest:  \"RD\" = rate difference (default);  \"RR\" = rate ratio;  \"\" = odds ratio;  \"p\" gives interval single proportion rate x1/n1. level Number specifying confidence level (0 1, default 0.95). skew Logical (default TRUE) indicating whether apply skewness correction (SCAS method recommended Laud 2017) (Miettinen-Nurminen method). simpleskew Logical (default FALSE) indicating whether use \"simplified\" skewness correction instead quadratic solution. See Laud 2021 details.  NOTE: version score suitable obtaining confidence limits, p-values. or_bias Logical (default TRUE contrast=\"\", otherwise NULL) indicating whether apply additional bias correction derived Gart 1985. (Corrigendum Laud 2017, published May 2018). applies contrast \"\". ORbias (deprecated: argument renamed or_bias) rr_tang Logical indicating whether use Tang's score RR: Stheta = (p1hat - p2hat * theta) / p2d (see Tang 2020). Default TRUE stratified = TRUE, weighting = \"IVS\" \"INV\". Forced FALSE stratified = TRUE, weightings. effect stratified = FALSE, p2d terms cancel . Experimental distrib = \"poi\". RRtang (deprecated: argument renamed rr_tang) bcf Logical (default TRUE) indicating whether apply bias correction score denominator. Applicable distrib = \"bin\" .  NOTE: bcf = FALSE option really included legacy validation previous published methods (.e. Gart & Nam, Mee, standard Chi-squared test) contrast = \"p\". cc Number logical (default FALSE) specifying (amount ) continuity adjustment. Numeric value taken gamma parameter Laud 2017, Appendix S2 (default 0.5 'conventional' Yates adjustment cc = TRUE).  IMPORTANT NOTES: adjustment (conventionally controversially termed 'continuity correction') aimed approximating strictly conservative coverage, dealing zero cell counts. 'sparse data adjustments' needed score method, except deal double-zero cells stratified  RD (& double-100% cells binomial RD & RR) IVS/INV weights. continuity adjustments provided fully tested stratified methods, found match continuity-adjusted version Mantel-Haenszel test, cc = 0.5 binomial contrasts. Flexibility included less conservative adjustment, cc = 0.25 suggested Laud 2017 (see Appendix S3.4), cc = 3/16 = 0.1875 Mehrotra & Railkar (2000) theta0 Number used one-sided significance test (e.g. non-inferiority margin). 1-sided p-value <0.025 iff 2-sided 95\\ excludes theta0. (bcf = FALSE skew = FALSE gives Farrington-Manning test.)  default, two-sided test theta0 = 0 (RD) 1 (RR/) also output: bcf = FALSE skew = FALSE K. Pearson's Chi-squared test single stratum case. bcf = TRUE gives E. Pearson's 'N-1' Chi-squared test single stratum, (Recommended Campbell 2007: https://doi.org/10.1002/sim.2832) (default weighting random = FALSE) CMH test stratified tables. Default bcf = TRUE skew = TRUE produces skewness-corrected version 'N-1' Chi-squared test CMH. correction change p-value group sizes unequal. precis Number (default 6) specifying precision (.e. number decimal places) used optimisation subroutine confidence interval. plot Logical (default FALSE) indicating whether output plot score function plotmax Numeric value indicating maximum value displayed x-axis plots (useful ratio contrasts can infinite). hetplot Logical (default FALSE) indicating whether output plots evaluating heterogeneity stratified datasets. xlim pair values indicating range values plotted. ylim pair values indicating range values plotted. stratified Logical (default FALSE) indicating whether combine vector inputs single stratified analysis.  IMPORTANT NOTE: mechanism stratified calculations enabled contrast = \"p\", performance resulting intervals fully evaluated. weighting String indicating weighting method use stratified = \"TRUE\":  \"IVS\" = Inverse Variance Score (see Laud 2017 details);  \"INV\" = Inverse Variance (bcf omitted, default contrast = \"\");  \"MH\" = Mantel-Haenszel (default contrast = \"RD\" \"RR\"); (= sample size contrast = \"p\");  \"MN\" = Miettinen-Nurminen weights. (similar MH contrast = \"RD\" \"RR\", similar INV contrast = \"\");  CI consistent CMH test, select skew = FALSE, random = FALSE, use default MH weighting RD/RR INV .  Weighting = 'MN' also matches CMH test.  Note: Alternative user-specified weighting may also applied, via 'wt' argument. mn_tol Numeric value indicating convergence tolerance used iteration weighting = \"MN\". MNtol (deprecated: argument renamed mn_tol) wt Numeric vector containing (optional) user-specified weights. sda Sparse data adjustment avoid zero variance x1 + x2 = 0: applied stratified = TRUE. Default 0.5 RD IVS/INV weights. required RR/, default remove double-zero strata instead. fda Full data adjustment avoid zero variance x1 + x2 = n1 + n2: applied stratified = TRUE. Default 0.5 RD & RR IVS/INV weights. required , default remove affected strata. dropzeros Logical (default FALSE) indicating whether drop uninformative strata RR/(.e. strata x1 = 0 x2 = 0), even choice weights allow retained fixed effects analysis. effect estimates, just heterogeneity test. random Logical (default FALSE) indicating whether perform random effects meta-analysis stratified data, using t-distribution (TDAS) method stratified data (defined Laud 2017).  NOTE: random = TRUE, skew = TRUE affects per-stratum estimates. prediction Logical (default FALSE) indicating whether produce prediction interval (work progress). warn Logical (default TRUE) giving option suppress warnings. ... arguments.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scoreci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Score confidence intervals for comparisons of independent binomial or Poisson rates. — scoreci","text":"list containing following components: estimates matrix containing estimates rates group requested contrast, confidence interval pval matrix containing details corresponding 2-sided significance test null hypothesis p_1 = p_2, one-sided significance tests null hypothesis theta >= <= theta0 call details function call stratified = TRUE, following outputs added: Qtest vector values describing testing heterogeneity weighting string indicating selected weighting method stratdata matrix containing stratum estimates weights","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scoreci.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Score confidence intervals for comparisons of independent binomial or Poisson rates. — scoreci","text":"Laud PJ. Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2017; 16:334-348. Laud PJ. Corrigendum: Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2018; 17:290-293. Laud PJ, Dane . Confidence intervals difference independent binomial proportions: comparison using graphical approach moving averages. Pharmaceutical Statistics 2014; 13(5):294-308. Miettinen OS, Nurminen M. Comparative analysis two rates. Statistics Medicine 1985; 4:213-226. Farrington CP, Manning G. Test statistics sample size formulae comparative binomial trials null hypothesis non-zero risk difference non-unity relative risk. Statistics Medicine 1990; 9(12):1447-1454. Gart JJ. Analysis common odds ratio: corrections bias skewness. Bulletin International Statistical Institute 1985, 45th session, book 1, 175-176. Gart JJ, Nam Jm. Approximate interval estimation ratio binomial parameters: review corrections skewness. Biometrics 1988; 44(2):323-338. Gart JJ, Nam Jm. Approximate interval estimation difference binomial parameters: correction skewness extension multiple tables. Biometrics 1990; 46(3):637-643. Tang Y. Score confidence intervals sample sizes stratified comparisons binomial proportions. Statistics Medicine 2020; 39:3427-3457.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scoreci.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Score confidence intervals for comparisons of independent binomial or Poisson rates. — scoreci","text":"Pete Laud, p.j.laud@sheffield.ac.uk","code":""},{"path":"https://petelaud.github.io/ratesci/reference/scoreci.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Score confidence intervals for comparisons of independent binomial or Poisson rates. — scoreci","text":"","code":"# Binomial RD, SCAS method: scoreci(   x1 = c(12, 19, 5), n1 = c(16, 29, 56),   x2 = c(1, 22, 0), n2 = c(16, 30, 29) ) #> $estimates #>            lower         est     upper level x1 n1 x2 n2      p1hat     p2hat #> [1,]  0.38567597  0.68162256 0.8778839  0.95 12 16  1 16 0.75000000 0.0625000 #> [2,] -0.31189939 -0.07795525 0.1600794  0.95 19 29 22 30 0.65517241 0.7333333 #> [3,] -0.01861751  0.09168753 0.1867180  0.95  5 56  0 29 0.08928571 0.0000000 #>           p1mle      p2mle #> [1,] 0.74553163 0.06390906 #> [2,] 0.65528437 0.73323962 #> [3,] 0.09168753 0.00000000 #>  #> $pval #>           chisq   pval2sided theta0  scorenull pval_left   pval_right #> [1,] 15.1862348 9.741092e-05      0  3.8969520 0.9999513 4.870546e-05 #> [2,]  0.4181622 5.178555e-01      0 -0.6466546 0.2589278 7.410722e-01 #> [3,]  3.0248621 8.199729e-02      0  1.7392131 0.9590014 4.099865e-02 #>  #> $call #>  distrib contrast    level      bcf     skew       cc  #>    \"bin\"     \"RD\"   \"0.95\"   \"TRUE\"   \"TRUE\"  \"FALSE\"  #>   # Binomial RD, MN method: scoreci(   x1 = c(12, 19, 5), n1 = c(16, 29, 56),   x2 = c(1, 22, 0), n2 = c(16, 30, 29), skew = FALSE ) #> $estimates #>            lower         est     upper level x1 n1 x2 n2      p1hat     p2hat #> [1,]  0.37497827  0.68749997 0.8628989  0.95 12 16  1 16 0.75000000 0.0625000 #> [2,] -0.30859360 -0.07816094 0.1581720  0.95 19 29 22 30 0.65517241 0.7333333 #> [3,] -0.03259659  0.08928570 0.1933310  0.95  5 56  0 29 0.08928571 0.0000000 #>          p1mle      p2mle #> [1,] 0.7500000 0.06250001 #> [2,] 0.6551724 0.73333334 #> [3,] 0.0892857 0.00000000 #>  #> $pval #>           chisq   pval2sided theta0  scorenull pval_left   pval_right #> [1,] 15.1862348 9.741092e-05      0  3.8969520 0.9999513 4.870546e-05 #> [2,]  0.4177055 5.180842e-01      0 -0.6463014 0.2590421 7.409579e-01 #> [3,]  2.7187500 9.917565e-02      0  1.6488632 0.9504122 4.958783e-02 #>  #> $call #>  distrib contrast    level      bcf     skew       cc  #>    \"bin\"     \"RD\"   \"0.95\"   \"TRUE\"  \"FALSE\"  \"FALSE\"  #>   # Poisson RR, SCAS method: scoreci(x1 = 5, n1 = 56, x2 = 0, n2 = 29, distrib = \"poi\", contrast = \"RR\") #> $estimates #>          lower      est upper level x1 n1 x2 n2      p1hat p2hat      p1mle #> [1,] 0.7264486 16.05357   Inf  0.95  5 56  0 29 0.08928571     0 0.08649553 #>            p2mle #> [1,] 0.005387933 #>  #> $pval #>         chisq pval2sided theta0 scorenull pval_left pval_right #> [1,] 2.904393 0.08833848      1  1.704228 0.9558308 0.04416924 #>  #> $call #>  distrib contrast    level      bcf     skew  rr_tang       cc  #>    \"poi\"     \"RR\"   \"0.95\"   \"TRUE\"   \"TRUE\"   \"TRUE\"  \"FALSE\"  #>   # Poisson RR, MN method: scoreci(   x1 = 5, n1 = 56, x2 = 0, n2 = 29, distrib = \"poi\",   contrast = \"RR\", skew = FALSE ) #> $estimates #>          lower est upper level x1 n1 x2 n2      p1hat p2hat p1mle p2mle #> [1,] 0.6740371 Inf   Inf  0.95  5 56  0 29 0.08928571     0   NaN 1e-08 #>  #> $pval #>         chisq pval2sided theta0 scorenull pval_left pval_right #> [1,] 2.589286  0.1075888      1  1.609126 0.9462056 0.05379442 #>  #> $call #>  distrib contrast    level      bcf     skew  rr_tang       cc  #>    \"poi\"     \"RR\"   \"0.95\"   \"TRUE\"  \"FALSE\"   \"TRUE\"  \"FALSE\"  #>   # Binomial rate, SCAS method: scoreci(x1 = c(5, 0), n1 = c(56, 29), contrast = \"p\") #> $estimates #>           lower         est      upper level x1 n1      p1hat       p1mle #> [1,] 0.03396264 0.091715962 0.18585265  0.95  5 56 0.08928571 0.091715962 #> [2,] 0.00000000 0.005681813 0.09170711  0.95  0 29 0.00000000 0.005681813 #>  #> $pval #>         chisq   pval2sided theta0 scorenull    pval_left pval_right #> [1,] 37.78571 7.895787e-10    0.5 -6.147009 3.947893e-10          1 #> [2,] 29.00000 7.237830e-08    0.5 -5.385165 3.618915e-08          1 #>  #> $call #>  distrib contrast    level      bcf     skew       cc  #>    \"bin\"      \"p\"   \"0.95\"  \"FALSE\"   \"TRUE\"  \"FALSE\"  #>   # Binomial rate, Wilson score method: scoreci(x1 = c(5, 0), n1 = c(56, 29), contrast = \"p\", skew = FALSE) #> $estimates #>           lower       est     upper level x1 n1      p1hat     p1mle #> [1,] 0.03874214 0.0892857 0.1925600  0.95  5 56 0.08928571 0.0892857 #> [2,] 0.00000000 0.0000000 0.1169698  0.95  0 29 0.00000000 0.0000000 #>  #> $pval #>         chisq   pval2sided theta0 scorenull    pval_left pval_right #> [1,] 37.78571 7.895787e-10    0.5 -6.147009 3.947893e-10          1 #> [2,] 29.00000 7.237830e-08    0.5 -5.385165 3.618915e-08          1 #>  #> $call #>  distrib contrast    level      bcf     skew       cc  #>    \"bin\"      \"p\"   \"0.95\"  \"FALSE\"  \"FALSE\"  \"FALSE\"  #>   # Poisson rate, SCAS method: scoreci(x1 = c(5, 0), n1 = c(56, 29), distrib = \"poi\", contrast = \"p\") #> $estimates #>           lower         est      upper level x1 n1      p1hat       p1mle #> [1,] 0.03314559 0.092261900 0.19710988  0.95  5 56 0.08928571 0.092261900 #> [2,] 0.00000000 0.005747108 0.09705602  0.95  0 29 0.00000000 0.005747108 #>  #> $pval #>         chisq   pval2sided theta0 scorenull    pval_left pval_right #> [1,] 26.52974 2.595125e-07    0.5 -5.150703 1.297562e-07  0.9999999 #> [2,] 22.58937 2.005914e-06    0.5 -4.752828 1.002957e-06  0.9999990 #>  #> $call #>  distrib contrast    level      bcf     skew       cc  #>    \"poi\"      \"p\"   \"0.95\"  \"FALSE\"   \"TRUE\"  \"FALSE\"  #>   # Stratified example, using data from Hartung & Knapp: scoreci(   x1 = c(15, 12, 29, 42, 14, 44, 14, 29, 10, 17, 38, 19, 21),   x2 = c(9, 1, 18, 31, 6, 17, 7, 23, 3, 6, 12, 22, 19),   n1 = c(16, 16, 34, 56, 22, 54, 17, 58, 14, 26, 44, 29, 38),   n2 = c(16, 16, 34, 56, 22, 55, 15, 58, 15, 27, 45, 30, 38),   stratified = TRUE ) #> $estimates #>          lower       est     upper level     p1hat     p2hat     p1mle #> [1,] 0.2455228 0.3087549 0.3703304  0.95 0.7168521 0.4079934 0.7143654 #>          p2mle #> [1,] 0.4056105 #>  #> $pval #>         chisq  pval2sided theta0 scorenull pval_left pval_right #> [1,] 84.63601 3.58673e-20      0  9.199783         1          0 #>  #> $Qtest #>            Q         Q_df     pval_het           I2         tau2           Qc  #> 4.434094e+01 1.200000e+01 1.335827e-05 7.293697e+01 3.249909e-02 4.381431e-01  #> pval_qualhet  #> 9.874622e-01  #>  #> $weighting #> [1] \"MH\" #>  #> $stratdata #>       x1j n1j x2j n2j    p1hatj    p2hatj  wt_fixed wtpct_fixed wtpct_rand #>  [1,]  15  16   9  16 0.9375000 0.5625000  8.000000    3.761235   3.761235 #>  [2,]  12  16   1  16 0.7500000 0.0625000  8.000000    3.761235   3.761235 #>  [3,]  29  34  18  34 0.8529412 0.5294118 17.000000    7.992625   7.992625 #>  [4,]  42  56  31  56 0.7500000 0.5535714 28.000000   13.164324  13.164324 #>  [5,]  14  22   6  22 0.6363636 0.2727273 11.000000    5.171699   5.171699 #>  [6,]  44  54  17  55 0.8148148 0.3090909 27.247706   12.810630  12.810630 #>  [7,]  14  17   7  15 0.8235294 0.4666667  7.968750    3.746543   3.746543 #>  [8,]  29  58  23  58 0.5000000 0.3965517 29.000000   13.634478  13.634478 #>  [9,]  10  14   3  15 0.7142857 0.2000000  7.241379    3.404567   3.404567 #> [10,]  17  26   6  27 0.6538462 0.2222222 13.245283    6.227328   6.227328 #> [11,]  38  44  12  45 0.8636364 0.2666667 22.247191   10.459615  10.459615 #> [12,]  19  29  22  30 0.6551724 0.7333333 14.745763    6.932786   6.932786 #> [13,]  21  38  19  38 0.5526316 0.5000000 19.000000    8.932934   8.932934 #>           theta_j     lower_j   upper_j         V_j    Stheta_j         Q_j #>  [1,]  0.37432668  0.07947651 0.6366192 0.019934516  0.06624508  0.22014132 #>  [2,]  0.68162256  0.38567597 0.8778839 0.026998683  0.37874508  5.31314199 #>  [3,]  0.32258016  0.10699961 0.5210504 0.011266832  0.01477449  0.01937418 #>  [4,]  0.19597310  0.01948127 0.3650952 0.007443573 -0.11232635  1.69504736 #>  [5,]  0.36101505  0.06819779 0.6120265 0.020831237  0.05488144  0.14458924 #>  [6,]  0.50425580  0.33270276 0.6528154 0.008184236  0.19696898  4.74042805 #>  [7,]  0.35432470  0.02152622 0.6408332 0.026682150  0.04810782  0.08673824 #>  [8,]  0.10316080 -0.07844922 0.2802846 0.007795273 -0.20530664  5.40722788 #>  [9,]  0.50878373  0.15475377 0.7736135 0.032012523  0.20553079  1.31957442 #> [10,]  0.42909852  0.16911775 0.6487974 0.017068011  0.12286901  0.88450807 #> [11,]  0.59488156  0.41394266 0.7429163 0.009980466  0.28821478  8.32303393 #> [12,] -0.07795525 -0.31189939 0.1600794 0.013943229 -0.38691584 10.73667112 #> [13,]  0.05240601 -0.17214090 0.2734169 0.012035530 -0.25612334  5.45045941 #>  #> $call #>  distrib contrast    level      bcf     skew       cc   random  #>    \"bin\"     \"RD\"   \"0.95\"   \"TRUE\"   \"TRUE\"  \"FALSE\"  \"FALSE\"  #>   # TDAS example, using data from Hartung & Knapp: scoreci(   x1 = c(15, 12, 29, 42, 14, 44, 14, 29, 10, 17, 38, 19, 21),   x2 = c(9, 1, 18, 31, 6, 17, 7, 23, 3, 6, 12, 22, 19),   n1 = c(16, 16, 34, 56, 22, 54, 17, 58, 14, 26, 44, 29, 38),   n2 = c(16, 16, 34, 56, 22, 55, 15, 58, 15, 27, 45, 30, 38),   stratified = TRUE, random = TRUE ) #> $estimates #>          lower       est     upper level     p1hat     p2hat    p1mle     p2mle #> [1,] 0.1746892 0.3088587 0.4430283  0.95 0.7168521 0.4079934 0.714412 0.4055533 #>  #> $pval #>         chisq   pval2sided theta0 scorenull pval_left   pval_right #> [1,] 25.15659 0.0003013239      0  5.015634 0.9998493 0.0001506619 #>  #> $Qtest #>            Q         Q_df     pval_het           I2         tau2           Qc  #> 4.434094e+01 1.200000e+01 1.335827e-05 7.293697e+01 3.249909e-02 4.381431e-01  #> pval_qualhet  #> 9.874622e-01  #>  #> $weighting #> [1] \"MH\" #>  #> $stratdata #>       x1j n1j x2j n2j    p1hatj    p2hatj  wt_fixed wtpct_fixed wtpct_rand #>  [1,]  15  16   9  16 0.9375000 0.5625000  8.000000    3.761235   3.761235 #>  [2,]  12  16   1  16 0.7500000 0.0625000  8.000000    3.761235   3.761235 #>  [3,]  29  34  18  34 0.8529412 0.5294118 17.000000    7.992625   7.992625 #>  [4,]  42  56  31  56 0.7500000 0.5535714 28.000000   13.164324  13.164324 #>  [5,]  14  22   6  22 0.6363636 0.2727273 11.000000    5.171699   5.171699 #>  [6,]  44  54  17  55 0.8148148 0.3090909 27.247706   12.810630  12.810630 #>  [7,]  14  17   7  15 0.8235294 0.4666667  7.968750    3.746543   3.746543 #>  [8,]  29  58  23  58 0.5000000 0.3965517 29.000000   13.634478  13.634478 #>  [9,]  10  14   3  15 0.7142857 0.2000000  7.241379    3.404567   3.404567 #> [10,]  17  26   6  27 0.6538462 0.2222222 13.245283    6.227328   6.227328 #> [11,]  38  44  12  45 0.8636364 0.2666667 22.247191   10.459615  10.459615 #> [12,]  19  29  22  30 0.6551724 0.7333333 14.745763    6.932786   6.932786 #> [13,]  21  38  19  38 0.5526316 0.5000000 19.000000    8.932934   8.932934 #>           theta_j     lower_j   upper_j         V_j    Stheta_j         Q_j #>  [1,]  0.37432668  0.07947651 0.6366192 0.019934516  0.06624508  0.22014132 #>  [2,]  0.68162256  0.38567597 0.8778839 0.026998683  0.37874508  5.31314199 #>  [3,]  0.32258016  0.10699961 0.5210504 0.011266832  0.01477449  0.01937418 #>  [4,]  0.19597310  0.01948127 0.3650952 0.007443573 -0.11232635  1.69504736 #>  [5,]  0.36101505  0.06819779 0.6120265 0.020831237  0.05488144  0.14458924 #>  [6,]  0.50425580  0.33270276 0.6528154 0.008184236  0.19696898  4.74042805 #>  [7,]  0.35432470  0.02152622 0.6408332 0.026682150  0.04810782  0.08673824 #>  [8,]  0.10316080 -0.07844922 0.2802846 0.007795273 -0.20530664  5.40722788 #>  [9,]  0.50878373  0.15475377 0.7736135 0.032012523  0.20553079  1.31957442 #> [10,]  0.42909852  0.16911775 0.6487974 0.017068011  0.12286901  0.88450807 #> [11,]  0.59488156  0.41394266 0.7429163 0.009980466  0.28821478  8.32303393 #> [12,] -0.07795525 -0.31189939 0.1600794 0.013943229 -0.38691584 10.73667112 #> [13,]  0.05240601 -0.17214090 0.2734169 0.012035530 -0.25612334  5.45045941 #>  #> $call #>  distrib contrast    level      bcf     skew       cc   random  #>    \"bin\"     \"RD\"   \"0.95\"   \"TRUE\"   \"TRUE\"  \"FALSE\"   \"TRUE\"  #>   # Stratified example, with extremely rare instance of non-calculable skewness # correction seen on plot of score function: scoreci(   x1 = c(1, 16), n1 = c(20, 40), x2 = c(0, 139), n2 = c(80, 160),   contrast = \"RD\", skew = TRUE, simpleskew = FALSE,   distrib = \"bin\", stratified = TRUE, plot = TRUE, weighting = \"IVS\" ) #> Warning: Negative discriminant (min: -0.4332) in quadratic skewness corrected score between (0.01754,0.07268). Simplified skewness correction used in this range.  #> $estimates #>           lower       est      upper level      p1hat      p2hat      p1mle #> [1,] -0.1624605 0.0105668 0.01655012  0.95 0.08111908 0.07724199 0.07905492 #>           p2mle #> [1,] 0.06848812 #>  #> $pval #>            chisq pval2sided theta0  scorenull pval_left pval_right #> [1,] 0.005183819  0.9426029      0 0.07199874 0.5286985  0.4713015 #>  #> $Qtest #>            Q         Q_df     pval_het           I2         tau2           Qc  #> 4.540469e+01 1.000000e+00 1.602496e-11 9.779758e+01 1.318576e-01 4.734512e+00  #> pval_qualhet  #> 1.478162e-02  #>  #> $weighting #> [1] \"IVS\" #>  #> $stratdata #>      x1j n1j x2j n2j p1hatj  p2hatj  wt_fixed wtpct_fixed wtpct_rand #> [1,]   1  20   0  80   0.05 0.00000 1893.8047   91.108836  91.108836 #> [2,]  16  40 139 160   0.40 0.86875  184.8134    8.891164   8.891164 #>          theta_j     lower_j    upper_j          V_j   Stheta_j       Q_j #> [1,]  0.05730447 -0.01791176  0.2189844 0.0005280376  0.0394332  2.944823 #> [2,] -0.46793315 -0.61980456 -0.3036999 0.0054108645 -0.4793168 42.459868 #>  #> $call #>  distrib contrast    level      bcf     skew       cc   random  #>    \"bin\"     \"RD\"   \"0.95\"   \"TRUE\"   \"TRUE\"  \"FALSE\"  \"FALSE\"  #>"},{"path":"https://petelaud.github.io/ratesci/reference/tdasci.html","id":null,"dir":"Reference","previous_headings":"","what":"t-distribution asymptotic score (","title":"t-distribution asymptotic score (","text":"Wrapper function TDAS method. Score-based stratified confidence intervals rate (risk) difference (\"RD\") ratio (\"RR\") independent binomial Poisson rates, odds ratio (\"\", binomial ), prevalence incidence rate (\"p\"). function combines vector inputs single stratified random effects analysis (e.g. meta-analysis), incorporating stratum variability confidence interval.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/tdasci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"t-distribution asymptotic score (","text":"","code":"tdasci(   x1,   n1,   x2 = NULL,   n2 = NULL,   distrib = \"bin\",   contrast = \"RD\",   level = 0.95,   cc = FALSE,   theta0 = NULL,   precis = 6,   plot = FALSE,   hetplot = FALSE,   plotmax = 100,   xlim = NULL,   ylim = NULL,   weighting = NULL,   mn_tol = 1e-08,   MNtol = NULL,   wt = NULL,   skew = TRUE,   prediction = FALSE,   warn = TRUE,   ... )"},{"path":"https://petelaud.github.io/ratesci/reference/tdasci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"t-distribution asymptotic score (","text":"x1, x2 Numeric vectors numbers events group 1 & group 2 respectively. n1, n2 Numeric vectors sample sizes (binomial rates) exposure times (Poisson rates) group. distrib Character string indicating distribution assumed input data: \"bin\" = binomial (default), \"poi\" = Poisson. contrast Character string indicating contrast interest:  \"RD\" = rate difference (default);  \"RR\" = rate ratio;  \"\" = odds ratio;  \"p\" gives interval single proportion rate x1/n1. level Number specifying confidence level (0 1, default 0.95). cc Number logical (default FALSE) specifying (amount ) continuity adjustment. Numeric value taken gamma parameter Laud 2017, Appendix S2 (default 0.5 'conventional' Yates adjustment cc = TRUE).  IMPORTANT NOTES: adjustment (conventionally controversially termed 'continuity correction') aimed approximating strictly conservative coverage, dealing zero cell counts. 'sparse data adjustments' needed score method, except deal double-zero cells stratified  RD (& double-100% cells binomial RD & RR) IVS/INV weights. continuity adjustments provided fully tested stratified methods, found match continuity-adjusted version Mantel-Haenszel test, cc = 0.5 binomial contrasts. Flexibility included less conservative adjustment, cc = 0.25 suggested Laud 2017 (see Appendix S3.4), cc = 3/16 = 0.1875 Mehrotra & Railkar (2000) theta0 Number used one-sided significance test (e.g. non-inferiority margin). 1-sided p-value <0.025 iff 2-sided 95\\ excludes theta0. default, two-sided test theta0 = 0 (RD) 1 (RR/) also output. precis Number (default 6) specifying precision (.e. number decimal places) used optimisation subroutine confidence interval. plot Logical (default FALSE) indicating whether output plot score function hetplot Logical (default FALSE) indicating whether output plots evaluating heterogeneity stratified datasets. plotmax Numeric value indicating maximum value displayed x-axis plots (useful ratio contrasts can infinite). xlim pair values indicating range values plotted. ylim pair values indicating range values plotted. weighting String indicating weighting method use stratified = \"TRUE\":  \"IVS\" = Inverse Variance Score (see Laud 2017 details);  \"INV\" = Inverse Variance (bcf omitted, default contrast = \"\");  \"MH\" = Mantel-Haenszel (default contrast = \"RD\" \"RR\"); (= sample size contrast = \"p\");  \"MN\" = Miettinen-Nurminen weights. (similar MH contrast = \"RD\" \"RR\", similar INV contrast = \"\");  CI consistent CMH test, select skew = FALSE, random = FALSE, use default MH weighting RD/RR INV .  Weighting = 'MN' also matches CMH test.  Note: Alternative user-specified weighting may also applied, via 'wt' argument. mn_tol Numeric value indicating convergence tolerance used iteration weighting = \"MN\". MNtol (deprecated: argument renamed mn_tol) wt Numeric vector containing (optional) user-specified weights. skew Logical (default TRUE) indicating whether apply skewness correction (SCAS method recommended Laud 2017) (Miettinen-Nurminen method) per-stratum estimates provided output. effect TDAS interval . prediction Logical (default FALSE) indicating whether produce prediction interval (work progress). warn Logical (default TRUE) giving option suppress warnings. ... arguments.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/tdasci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"t-distribution asymptotic score (","text":"list containing following components: estimates matrix containing estimates rates group requested contrast, confidence interval pval matrix containing details corresponding 2-sided significance test null hypothesis p_1 = p_2, one-sided significance tests null hypothesis theta >= <= theta0 Qtest vector values describing testing heterogeneity weighting string indicating selected weighting method stratdata matrix containing stratum estimates weights call details function call","code":""},{"path":"https://petelaud.github.io/ratesci/reference/tdasci.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"t-distribution asymptotic score (","text":"Laud PJ. Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2017; 16:334-348. Laud PJ. Corrigendum: Equal-tailed confidence intervals comparison rates. Pharmaceutical Statistics 2018; 17:290-293.","code":""},{"path":"https://petelaud.github.io/ratesci/reference/tdasci.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"t-distribution asymptotic score (","text":"Pete Laud, p.j.laud@sheffield.ac.uk","code":""},{"path":[]},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"new-features-development-version","dir":"Changelog","previous_headings":"","what":"New features","title":"ratesci (development version)","text":"New function clusterpci() estimation single binomial proportion clustered data. Example datasets now included. Improved documentation pkgdown website & vignettes.","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"in-pairbinci-development-version","dir":"Changelog","previous_headings":"New features","what":"In pairbinci():","title":"ratesci (development version)","text":"skew skewness correction. bcf variance bias correction. Default paired RD RR method changed new SCAS method (.e. including skewness correction - manuscript review). Bonett-Price methods RD RR (including proposed Jeffreys variant option RR). Default MOVER method changed Jeffreys. MOVER calculations now use x/N point estimate instead median Beta distribution. cc uses new form correction RR giving equivariant intervals. Also allows consistency continuity-corrected McNemar test (intermediate correction user’s choosing). cctype deprecated. Default conditional odds ratio method changed SCASp (closed-form calculation). Output object now includes estimates p1, p2 phi. Output object now includes function call.","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"in-scaspci-development-version","dir":"Changelog","previous_headings":"New features","what":"In scaspci():","title":"ratesci (development version)","text":"bcf option now implemented contrast = “p” (default = FALSE). bign allows different sample size used bias correction (used within transformed SCASp method paired pairbinci, consistency ‘N-1’ test).","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"in-scoreci-development-version","dir":"Changelog","previous_headings":"New features","what":"In scoreci():","title":"ratesci (development version)","text":"bcf option now implemented contrast = “p” (default = FALSE). (Note adjusted sample size bias correction can achieved including non-zero value n2.) ORbias, RRtang, MNtol arguments renamed or_bias, rr_tang mn_tol.","code":""},{"path":[]},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"in-exactci-development-version","dir":"Changelog","previous_headings":"Bug fixes","what":"In exactci():","title":"ratesci (development version)","text":"Corrected duplicate point estimate reported vector inputs. Derive point estimates match LCL UCL level = 0. Corrected LCL Poisson mid-p method.","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"other-development-version","dir":"Changelog","previous_headings":"","what":"Other","title":"ratesci (development version)","text":"method_RD, method_RR method_OR replaced method. Output object column names updated (lower, est, upper) consistency style conformity. Tests added confirm consistency methods vs McNemar test. Dependence polynom package removed. Edition 3 testthat implemented.","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"ratesci-050-2025-01-10","dir":"Changelog","previous_headings":"","what":"ratesci 0.5.0 (2025-01-10)","title":"ratesci 0.5.0 (2025-01-10)","text":"CRAN release: 2025-01-10","code":""},{"path":[]},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"in-pairbinci-0-5-0","dir":"Changelog","previous_headings":"New features","what":"In pairbinci():","title":"ratesci 0.5.0 (2025-01-10)","text":"cc continuity correction now available methods contrasts. cctype controls type correction apply contrast = “RR”. New default method_RD = “Score_closed” non-iterative calculation Tango score interval contrast = “RD”. Thanks Tony Yang permission use code 2013 paper. New default method_RR = “Score_closed” non-iterative calculation Tang score interval contrast = “RR”. Thanks Guogen Shan contributing code via email. Added paired MOVER methods method_RD = “MOVER” method_RR = “MOVER”. Also “MOVER_newc” incorporates Newcombe’s correlation correction. Added moverbase, specifying different versions MOVER methods (Wilson, Jeffreys, midp SCAS). Added “jeff” “wilson” method_OR options transformed binomial methods . Confirmed documented 2-sided significance test equivalent McNemar test (without continuity correction). ### scoreci(): Confirmed continuity corrections stratified (fixed-effects) binomial contrasts consistent Mantel-Haenszel correction. Updated heterogeneity test consistently omit non-informative (non-empty) strata, output degrees freedom. ### moverci(): Added continuity correction type = “wilson”. Added options type = “SCAS” “midp” intervals. Standardised output include lower CL, midpoint, upper CL, order.","code":""},{"path":[]},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"in-scoreci-0-5-0","dir":"Changelog","previous_headings":"Bug fixes","what":"In scoreci():","title":"ratesci 0.5.0 (2025-01-10)","text":"Improved handling special cases MN weighting (#25, thanks Vincent Jaquet reporting issue proposed solution. Also #27 RR, thanks @lovestat.) result, double-zero strata need excluded weighting = “MN”. ### moverci(): Corrected calculation score intervals single Poisson rate, using Rao score interval. correction affects MOVER method comparison Poisson rates [.e. moverci() distrib = “poi” type = “wilson”]","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"other-0-5-0","dir":"Changelog","previous_headings":"","what":"Other","title":"ratesci 0.5.0 (2025-01-10)","text":"Improved documentation hypothesis tests continuity corrections, clarifying links Chi-squared tests CMH test selected weights. Correction documentation default weights . Added tests confirming equivalence iterative closed-form methods pairbinci.","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"ratesci-04-0-2021-12-04","dir":"Changelog","previous_headings":"","what":"ratesci 0.4-0 (2021-12-04)","title":"ratesci 0.4-0 (2021-12-04)","text":"CRAN release: 2021-12-05","code":""},{"path":[]},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"in-scoreci-0-4-0","dir":"Changelog","previous_headings":"New features","what":"In scoreci():","title":"ratesci 0.4-0 (2021-12-04)","text":"MN weighting now iterates convergence (@jonjvallejo, #20). Added optional prediction interval random effects method (also tdasci()). Added xlim ylim arguments control plot output. Added sda & fda arguments optional sparse/full data adjustment x1 + x2 = 0 x1 + x2 = n1 + n2 stratum. Added INV option weights omit variance bias correction. Added RRtang argument apply Tang’s alternative score RR (recommended stratified analysis INV/IVS weights. Experimental Poisson RR). Stheta = (p1hat - p2hat * theta) / p2d (see Tang 2020) Added simplified skewness correction option (causes p-values omitted, see Tang 2021 & Laud 2021). Introduced warning plot features rare occasions quadratic skewness correction calculated due negative discriminant. p-value suppressed affected negative discriminants. Changed ORbias default TRUE (see Laud 2018). Changed weighting default MH RD & RR, INV (consistency CMH test). Added hetplot argument separate heterogeneity plots score function plot. contrast = MH weighting; contrast = RR IVS/INV weighting RRtang = FALSE; random = TRUE (needs evaluation); excluded using new option dropzeros = TRUE. ### tdasci(): Default uses skew = TRUE stratum CIs.","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"bug-fixes-0-4-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"ratesci 0.4-0 (2021-12-04)","text":"MN weighting scoreci() corrected distrib=“poi”. Fixed bug scoreci() calculation stratum CIs random=TRUE. Fixed bug scoreci() distrib = “poi” contrast = “p” (#7). Fixed finite precision bug scaspci(). Fixed bug rateci() closed-form calculation continuity-corrected SCAS. Fixed bug scoreci() stratified zero scores calculated NA, resulting UL = 0. (Thanks Lidia Mukina reporting bug.) Fixed variable plot ranges vectorised inputs.","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"other-0-4-0","dir":"Changelog","previous_headings":"","what":"Other","title":"ratesci 0.4-0 (2021-12-04)","text":"Renamed tdas argument ‘random’. Removed redundant t2 variable.","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"ratesci-03-0-2018-02-15","dir":"Changelog","previous_headings":"","what":"ratesci 0.3-0 (2018-02-15)","title":"ratesci 0.3-0 (2018-02-15)","text":"CRAN release: 2018-02-15","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"new-features-0-3-0","dir":"Changelog","previous_headings":"","what":"New features","title":"ratesci 0.3-0 (2018-02-15)","text":"Added bias correction scoreci() SCAS method (derived Gart 1985). Added score methods (Tango & Tang) default paired binomial RD RR pairbinci(). Added transformed mid-p method paired comparison transformed SCAS. Added scaspci() non-iterative SCAS methods single binomial Poisson rate. Added rateci() selected methods single binomial Poisson rate.","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"bug-fixes-0-3-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"ratesci 0.3-0 (2018-02-15)","text":"Fixed bug pairbinci() contrast=“”. Fixed bug moverci() contrast=“p” type=“wilson”. Corrected error cc stratified SCAS method . Clarified documentation regarding continuity corrections. Set Stheta 0 |Stheta|<cc scoreci() Fixed stratified calulations contrast = “p” scoreci().","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"ratesci-02-0-2017-04-21","dir":"Changelog","previous_headings":"","what":"ratesci 0.2-0 (2017-04-21)","title":"ratesci 0.2-0 (2017-04-21)","text":"CRAN release: 2017-04-21","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"new-features-0-2-0","dir":"Changelog","previous_headings":"","what":"New features","title":"ratesci 0.2-0 (2017-04-21)","text":"Added pairbinci() comparisons paired binomial rates. Added option suppress warnings scoreci. Added Galbraith plot (assessing stratum heterogeneity) scoreci(). Added qualitative interaction test scoreci(). Added stratum estimates & CIs scoreci() output stratified = TRUE.","code":""},{"path":"https://petelaud.github.io/ratesci/news/index.html","id":"bug-fixes-0-2-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"ratesci 0.2-0 (2017-04-21)","text":"Fixed bug contrast = “p” moverci(). Fixed bug tdasci() wrapper function. Fixed bug stratified . Altered adjustment options boundary cases moverci(). Changed point estimate used moverci() posterior median type = “jeff”, ensure consistent calculations informative priors.","code":""}]
