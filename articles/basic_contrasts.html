<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2: Basic contrasts (single stratum) • ratesci</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2: Basic contrasts (single stratum)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ratesci</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/single_rate.html">1: Single rate</a></li>
    <li><a class="dropdown-item" href="../articles/basic_contrasts.html">2: Basic contrasts (single stratum)</a></li>
    <li><a class="dropdown-item" href="../articles/stratified.html">3: Stratified contrasts</a></li>
    <li><a class="dropdown-item" href="../articles/paired_contrasts.html">4: Paired contrasts</a></li>
    <li><a class="dropdown-item" href="../articles/tests.html">5: Hypothesis tests</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/petelaud/ratesci/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>2: Basic contrasts (single stratum)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/petelaud/ratesci/blob/master/vignettes/basic_contrasts.Rmd" class="external-link"><code>vignettes/basic_contrasts.Rmd</code></a></small>
      <div class="d-none name"><code>basic_contrasts.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/petelaud/ratesci" class="external-link">ratesci</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="confidence-intervals-for-comparisons-of-independent-binomial-or-poisson-rates">Confidence intervals for comparisons of independent binomial or
Poisson rates<a class="anchor" aria-label="anchor" href="#confidence-intervals-for-comparisons-of-independent-binomial-or-poisson-rates"></a>
</h2>
<div class="section level3">
<h3 id="scas-and-other-asymptotic-score-methods">SCAS and other asymptotic score methods<a class="anchor" aria-label="anchor" href="#scas-and-other-asymptotic-score-methods"></a>
</h3>
<p>For comparison of two groups when the outcome is a binomial
proportion, you may wish to quantify the effect size using the
difference
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mrow><mi>R</mi><mi>D</mi></mrow></msub><mo>=</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\hat \theta_{RD} = \hat p_1 - \hat p_2</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub><mi>/</mi><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\hat p_i = x_i/n_i</annotation></semantics></math>)
or the ratio of the two proportions
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mrow><mi>R</mi><mi>R</mi></mrow></msub><mo>=</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mi>/</mi><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\hat \theta_{RR} = \hat p_1 / \hat p_2</annotation></semantics></math>).
Another option is the odds ratio
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mrow><mi>O</mi><mi>R</mi></mrow></msub><mo>=</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mover><mi>p</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat \theta_{OR} = \hat p_1 (1 - \hat p_2) / \hat p_2(1 - \hat p_1)</annotation></semantics></math>),
which is less easy to interpret, but is widely used due to its useful
properties for logistic regression modelling or case-control
studies.</p>
<!--
To calculate a confidence interval (CI) for a risk difference ($\hat \theta_{RD} = \hat p_1 - \hat p_2$, where $\hat p_i = x_i/n_i$), or relative risk ($\hat \theta_{RR} = \hat p_1 / \hat p_2$) or odds ratio ($\hat \theta_{OR} = \hat p_1 (1 - \hat p_2) / \hat p_2(1 - \hat p_1)$), 
-->
<p>To calculate a confidence interval (CI) for any of these contrasts,
the skewness-corrected asymptotic score (SCAS) method is recommended, as
one that succeeds, on average, at containing the true parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
with the appropriate nominal probability (e.g. 95%), and has evenly
distributed tail probabilities <span class="citation">(<a href="#ref-laud2017">Laud 2017</a>)</span>. It is a modified version of
the Miettinen-Nurminen (MN) asymptotic score method <span class="citation">(<a href="#ref-miettinen1985">Miettinen and Nurminen
1985</a>)</span>. MN and SCAS each represent a family of methods
encompassing analysis of RD and RR for binomial proportions or Poisson
rates (e.g. exposure-adjusted incidence rate), and binomial OR.</p>
<p>The plots below illustrate the one-sided and two-sided interval
coverage probabilities<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;RNCP = the probability that the true value of
&lt;math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;semantics&gt;&lt;mi&gt;θ&lt;/mi&gt;&lt;annotation encoding="application/x-tex"&gt;\theta&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;
falls outside to the right of the confidence interval. CP = the
probability that the confidence interval contains the true value of
&lt;math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;semantics&gt;&lt;mi&gt;θ&lt;/mi&gt;&lt;annotation encoding="application/x-tex"&gt;\theta&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;.
Both calculated by precise enumeration of bivariate binomial
probabilities.&lt;/p&gt;'><sup>1</sup></a> achieved by SCAS compared to some other
popular methods<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;AN = “Wald” Approximate Normal, MOVER-J = Method of
Variance Estimates Recovery, based on Newcombe’s method but using
Jeffreys equal-tailed intervals instead of Wilson&lt;/p&gt;"><sup>2</sup></a> with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo>,</mo><msub><mi>n</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>45</mn><mo>,</mo><mn>15</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(n_1, n_2) = (45, 15)</annotation></semantics></math>,
with the second row of each plot using moving average smoothing. A
selection of coverage probability plots for other sample size
combinations and other contrasts can be found in the “plots” folder of
the <a href="https://github.com/petelaud/ratesci/tree/master/plots" class="external-link">ratesci
GitHub repository</a>.</p>
<p><img src="images/summaryRD95_45%2C15os_small.jpg"></p>
<p>Differences in two-sided coverage can be more subtle:</p>
<p><img src="images/summaryRD95_45%2C15_small.jpg"></p>
<p>The skewness correction, introduced by <span class="citation">(<a href="#ref-gart1988">Gart and Nam 1988</a>)</span> should be considered
essential for analysis of ratio contrasts, but can also have a
substantial effect for RD as seen here.</p>
<p>[Note: <span class="citation">(<a href="#ref-fagerland2011">Morten W.
Fagerland, Lydersen, and Laake 2011</a>)</span> dismissed the MN method,
saying that it can be somewhat liberal. In fact, based on reconstruction
of their results, it appears that their evaluation was of the
closely-related but inferior Mee method, which omits the N/(N-1)
variance bias correction. This error was corrected in their 2017 book.
Essentially, it seems they reject the MN method on the basis of some
very small regions of the parameter space where coverage is slightly
below nominal. These dips in coverage do occur, but fluctuate above and
below the nominal level in a pattern of ridges and furrows aligned along
the diagonal of a fixed value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mrow><mi>R</mi><mi>D</mi></mrow></msub><annotation encoding="application/x-tex">\theta_{RD}</annotation></semantics></math>.
The most severe dips tend to occur when sample sizes are multiples of 10
(e.g. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo>,</mo><msub><mi>n</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>40</mn><mo>,</mo><mn>10</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(n_1, n_2) = (40, 10)</annotation></semantics></math>),
which might be relatively rare in practice. The moving average smoothing
in the above surface plots is designed to even out these fluctuations in
coverage. The ‘N-1’ adjustment in the MN method elevates coverage
probabilities slightly, and the skewness correction gives a further
improvement overall, as well as substantially improving one-sided
coverage when group sizes are unequal.]</p>
<p><code><a href="../reference/scoreci.html">scoreci()</a></code> is used as follows, for example to obtain a
SCAS 95% CI for the difference <code>5/56 - 0/29</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scoreci.html">scoreci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n <span class="op">=</span> <span class="fl">29</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt;        lower    est upper level x1 n1 x2 n2  p1hat p2hat  p1mle p2mle</span></span>
<span><span class="co">#&gt; [1,] -0.0186 0.0917 0.187  0.95  5 56  0 29 0.0893     0 0.0917     0</span></span></code></pre></div>
<!---
For a Miettinen-Nurminen interval, set the argument `skew = FALSE`. For the closely-related Mee method, the variance bias correction would also be omitted:


``` r
scoreci(x1 = 5, n1 = 56, x2 = 0, n = 29, skew = FALSE)$estimates
#>        lower    est upper level x1 n1 x2 n2  p1hat p2hat  p1mle p2mle
#> [1,] -0.0326 0.0893 0.193  0.95  5 56  0 29 0.0893     0 0.0893     0
scoreci(x1 = 5, n1 = 56, x2 = 0, n = 29, skew = FALSE, bcf = FALSE)$estimates
#>        lower    est upper level x1 n1 x2 n2  p1hat p2hat  p1mle p2mle
#> [1,] -0.0313 0.0893 0.193  0.95  5 56  0 29 0.0893     0 0.0893     0
```
--->
<p>The underlying z-statistic is used to obtain a two-sided hypothesis
test for association (<code>pval2sided</code>). Note that under certain
conditions
(i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">n_1 = n_2</annotation></semantics></math>)
this is equivalent to the Egon Pearson ‘N-1’ chi-squared test <span class="citation">(<a href="#ref-campbell2007">Campbell 2007</a>)</span>.
The facility is also provided for a custom one-sided test against any
specified null hypothesis value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\theta_0</annotation></semantics></math>,
e.g. for non-inferiority testing (<code>pval_left</code> and
<code>pval_right</code>). See the <a href="https://petelaud.github.io/ratesci/articles/tests.html">tests
vignette</a> for more details.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">pval</span></span>
<span><span class="co">#&gt;      chisq pval2sided theta0 scorenull pval_left pval_right</span></span>
<span><span class="co">#&gt; [1,]  3.02      0.082      0      1.74     0.959      0.041</span></span></code></pre></div>
<p>The <code><a href="../reference/scoreci.html">scoreci()</a></code> function provides options to omit the
skewness correction (<code>skew = FALSE</code> for the MN method) and
the variance bias correction (<code>bcf = FALSE</code> for the Mee
method, which would be consistent with the Karl Pearson unadjusted
chi-squared test). To keep things simple when choosing the SCAS method,
you may instead use the <code><a href="../reference/scasci.html">scasci()</a></code> wrapper function instead
of <code><a href="../reference/scoreci.html">scoreci()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scasci.html">scasci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n <span class="op">=</span> <span class="fl">29</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt;        lower    est upper level x1 n1 x2 n2  p1hat p2hat  p1mle p2mle</span></span>
<span><span class="co">#&gt; [1,] -0.0186 0.0917 0.187  0.95  5 56  0 29 0.0893     0 0.0917     0</span></span></code></pre></div>
<p>For analysis of relative risk, use:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scasci.html">scasci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n <span class="op">=</span> <span class="fl">29</span>, contrast <span class="op">=</span> <span class="st">"RR"</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt;      lower  est upper level x1 n1 x2 n2  p1hat p2hat  p1mle  p2mle</span></span>
<span><span class="co">#&gt; [1,]  0.77 16.4   Inf  0.95  5 56  0 29 0.0893     0 0.0868 0.0053</span></span></code></pre></div>
<p>And for odds ratio:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scasci.html">scasci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n <span class="op">=</span> <span class="fl">29</span>, contrast <span class="op">=</span> <span class="st">"OR"</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt;      lower  est upper level x1 n1 x2 n2  p1hat p2hat  p1mle   p2mle</span></span>
<span><span class="co">#&gt; [1,] 0.759 17.7   Inf  0.95  5 56  0 29 0.0893     0 0.0865 0.00533</span></span></code></pre></div>
<p>For analysis of Poisson incidence rates, for example
exposure-adjusted adverse event rates, the same methodology is adapted
for the Poisson distribution, with the <code>distrib</code> argument.
So, for example if the denominators 56 and 29 represent the number of
patient-years at risk in each group, instead of the number of
patients:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scasci.html">scasci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n <span class="op">=</span> <span class="fl">29</span>, contrast <span class="op">=</span> <span class="st">"RR"</span>, distrib <span class="op">=</span> <span class="st">"poi"</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt;      lower  est upper level x1 n1 x2 n2  p1hat p2hat  p1mle   p2mle</span></span>
<span><span class="co">#&gt; [1,] 0.726 16.1   Inf  0.95  5 56  0 29 0.0893     0 0.0865 0.00539</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mover-methods">MOVER methods<a class="anchor" aria-label="anchor" href="#mover-methods"></a>
</h3>
<p>An alternative family of methods to produce confidence intervals for
the same set of binomial and Poisson contrasts is the Method of Variance
Estimates Recovery (MOVER), also known as Square-and-Add <span class="citation">(For technical details see chapter 7 of <a href="#ref-newcombe2012">Newcombe 2012</a>)</span>. Originally labelled
as a “Score” method <span class="citation">(<a href="#ref-newcombe1998">Newcombe 1998</a>)</span> due to the
involvement of the Wilson Score interval, this involves a combination of
intervals calculated separately for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>2</mn></msub><annotation encoding="application/x-tex">p_2</annotation></semantics></math>.
Newcombe based his method on Wilson intervals, but coverage can be
slightly improved by using equal-tailed Jeffreys intervals instead
(“MOVER-J”) <span class="citation">(<a href="#ref-laud2017">Laud
2017</a>)</span><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Newcombe considered a MOVER method based on equal-tailed
Jeffreys intervals (“MOVER-R Jeffreys”) in chapter 11 of &lt;span class="citation"&gt;(&lt;a href="#ref-newcombe2012"&gt;Newcombe 2012&lt;/a&gt;)&lt;/span&gt;.
However, the example intervals shown in his Table 11.6 do not match the
output of
&lt;code&gt;moverci(2, 14, 1, 11, contrast = "RR", type = "jeff")&lt;/code&gt;. The
results for “MOVER-R Wilson” are matched by
&lt;code&gt;moverci(2, 14, 1, 11, contrast = "RR", type = "wilson")&lt;/code&gt;,
suggesting that the discrepancy is in the calculation of the Jeffreys
intervals themselves rather than the MOVER formula. However, Jeffreys
intervals for a single proportion (“method 12”) in Newcombe’s Table 3.2
(chapter 3), are matched by &lt;code&gt;jeffreysci(1, 10)&lt;/code&gt;, so the
source of the discrepancy remains a mystery. Similar discrepancies are
observed for contrast = “OR”.&lt;/p&gt;'><sup>3</sup></a>. Coverage properties remain generally
inferior to SCAS - with larger sample sizes, MOVER-J has two-sided
coverage close to (but slightly below) the nominal level, but central
location is not achieved (except for the RR contrast).</p>
<p>There is no corresponding hypothesis test for the MOVER methods.</p>
<p>A MOVER-J interval for binomial RD from the same observed data as
above would be obtained using:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/moverci.html">moverci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n <span class="op">=</span> <span class="fl">29</span><span class="op">)</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;         lower   est upper level x1 n1 x2 n2  p1hat   p2hat</span></span>
<span><span class="co">#&gt; [1,] -0.00973 0.084 0.177  0.95  5 56  0 29 0.0918 0.00775</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $call</span></span>
<span><span class="co">#&gt;  distrib contrast    level     type      adj       cc       a1       b1 </span></span>
<span><span class="co">#&gt;    "bin"     "RD"   "0.95"   "jeff"  "FALSE"  "FALSE"    "0.5"    "0.5" </span></span>
<span><span class="co">#&gt;       a2       b2 </span></span>
<span><span class="co">#&gt;    "0.5"    "0.5"</span></span></code></pre></div>
<p>For comparison, Newcombe’s version using Wilson intervals is:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/moverci.html">moverci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n <span class="op">=</span> <span class="fl">29</span>, type <span class="op">=</span> <span class="st">"wilson"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;        lower    est upper level x1 n1 x2 n2  p1hat p2hat</span></span>
<span><span class="co">#&gt; [1,] -0.0381 0.0893 0.193  0.95  5 56  0 29 0.0893     0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $call</span></span>
<span><span class="co">#&gt;  distrib contrast    level     type      adj       cc       a1       b1 </span></span>
<span><span class="co">#&gt;    "bin"     "RD"   "0.95" "wilson"  "FALSE"  "FALSE"    "0.5"    "0.5" </span></span>
<span><span class="co">#&gt;       a2       b2 </span></span>
<span><span class="co">#&gt;    "0.5"    "0.5"</span></span></code></pre></div>
<p>The MOVER approach may be further modified by adapting the Jeffreys
interval (which uses a non-informative
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.5</mn><mo>,</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Beta(0.5, 0.5)</annotation></semantics></math>
prior for the group rates) to incorporate prior information about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>2</mn></msub><annotation encoding="application/x-tex">p_2</annotation></semantics></math>
for an approximate Bayesian interval. For example, given data from a
pilot study with 1/10 events in the first group and 0/10 in the second
group, the non-informative
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.5</mn><mo>,</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Beta(0.5, 0.5)</annotation></semantics></math>
prior distributions for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>2</mn></msub><annotation encoding="application/x-tex">p_2</annotation></semantics></math>
might be updated as follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/moverbci.html">moverbci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">5</span>, n1 <span class="op">=</span> <span class="fl">56</span>, x2 <span class="op">=</span> <span class="fl">0</span>, n <span class="op">=</span> <span class="fl">29</span>, a1 <span class="op">=</span> <span class="fl">1.5</span>, b1 <span class="op">=</span> <span class="fl">9.5</span>, a2 <span class="op">=</span> <span class="fl">0.5</span>, b2 <span class="op">=</span> <span class="fl">10.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; $estimates</span></span>
<span><span class="co">#&gt;        lower    est upper level x1 n1 x2 n2 p1hat   p2hat</span></span>
<span><span class="co">#&gt; [1,] 0.00917 0.0872 0.172  0.95  5 56  0 29 0.093 0.00578</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $call</span></span>
<span><span class="co">#&gt;  distrib contrast    level     type      adj       cc       a1       b1 </span></span>
<span><span class="co">#&gt;    "bin"     "RD"   "0.95"   "jeff"  "FALSE"      "0"    "1.5"    "9.5" </span></span>
<span><span class="co">#&gt;       a2       b2 </span></span>
<span><span class="co">#&gt;    "0.5"   "10.5"</span></span></code></pre></div>
<p>WARNING: Note that confidence intervals for ratio measures should be
equivariant, in the sense that:</p>
<ol style="list-style-type: decimal">
<li>interchanging the groups produces reciprocal intervals for RR or OR,
i.e. the lower and upper confidence limits for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mi>/</mi><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1/n_1</annotation></semantics></math>
vs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mi>/</mi><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2/n_2</annotation></semantics></math>
are the reciprocal of the upper and lower limits for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mi>/</mi><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2/n_2</annotation></semantics></math>
vs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mi>/</mi><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1/n_1</annotation></semantics></math>
</li>
<li>in addition for OR, interchanging events and non-events produces
reciprocal intervals, i.e. the lower and upper confidence limits for the
odds ratio of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">(n_1 - x_1)/n_1</annotation></semantics></math>
vs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">(n_2 - x_2)/n_2</annotation></semantics></math>
are the reciprocal of the upper and lower limits for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mi>/</mi><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1/n_1</annotation></semantics></math>
vs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mi>/</mi><msub><mi>n</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2/n_2</annotation></semantics></math>.</li>
</ol>
<p>Unfortunately, the MOVER method for contrast = “OR”, as described in
<span class="citation">(<a href="#ref-fagerland2012">Morten W. Fagerland
and Newcombe 2012</a>)</span>, does not satisfy the second of these
requirements.</p>
</div>
</div>
<div class="section level2">
<h2 id="technical-details">Technical details<a class="anchor" aria-label="anchor" href="#technical-details"></a>
</h2>
<p><span class="citation">(<a href="#ref-miettinen1985">Miettinen and
Nurminen 1985</a>)</span> took the concept of the Wilson score interval
for a single proportion and applied it to all contrasts of two
proportions (not just RD) and Poisson rates. The procedure involves
finding, at any possible value of the contrast parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
the maximum likelihood estimates of the two proportions, restricted to
the given value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.
The resulting estimates are then included in the score statistic, and
the confidence interval found by an iterative root-finding algorithm.
Miettinen and Nurminen’s statistic was defined to follow a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>χ</mi><mn>1</mn><mn>2</mn></msubsup><annotation encoding="application/x-tex">\chi^2_1</annotation></semantics></math>
distribution, but the SCAS formula uses an equivalent statistic with a
N(0, 1) distribution, to facilitate one-sided tests.</p>
<p>Gart and Nam, in a series of papers between 1985 and 1990, proposed
similar confidence interval methods that included a skewness correction
in the score statistic (and also a bias correction for OR). Their
formulae omitted the ‘N-1’ bias correction used by Miettinen and
Nurminen.</p>
<p>Farrington and Manning published an article on non-inferiority tests
for RD and RR, using the same restricted maximum likelihood methodology
as Miettinen and Nurminen (but omitting the ‘N-1’ correction).</p>
<p>The SCAS method combines the features of all the above methods, to
give a comprehensive family of asymptotic score methods with optimised
performance for universal use for confidence intervals for a wide range
of sample sizes, with coherent tests for association or for
non-inferiority. For further details, see <span class="citation">(<a href="#ref-laud2017">Laud 2017</a>)</span>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-campbell2007" class="csl-entry">
Campbell, Ian. 2007. <span>“Chi<span>-</span>Squared and
Fisher<span></span>Irwin Tests of Two<span>-</span>by<span>-</span>Two
Tables with Small Sample Recommendations.”</span> <em>Statistics in
Medicine</em> 26 (19): 3661–75. <a href="https://doi.org/10.1002/sim.2832" class="external-link">https://doi.org/10.1002/sim.2832</a>.
</div>
<div id="ref-fagerland2011" class="csl-entry">
Fagerland, Morten W, Stian Lydersen, and Petter Laake. 2011.
<span>“Recommended Confidence Intervals for Two Independent Binomial
Proportions.”</span> <em>Statistical Methods in Medical Research</em> 24
(2): 224–54. <a href="https://doi.org/10.1177/0962280211415469" class="external-link">https://doi.org/10.1177/0962280211415469</a>.
</div>
<div id="ref-fagerland2012" class="csl-entry">
Fagerland, Morten W., and Robert G. Newcombe. 2012. <span>“Confidence
Intervals for Odds Ratio and Relative Risk Based on the Inverse
Hyperbolic Sine Transformation.”</span> <em>Statistics in Medicine</em>
32 (16): 2823–36. <a href="https://doi.org/10.1002/sim.5714" class="external-link">https://doi.org/10.1002/sim.5714</a>.
</div>
<div id="ref-gart1988" class="csl-entry">
Gart, John J., and Jun-mo Nam. 1988. <span>“Approximate Interval
Estimation of the Ratio of Binomial Parameters: A Review and Corrections
for Skewness.”</span> <em>Biometrics</em> 44 (2): 323. <a href="https://doi.org/10.2307/2531848" class="external-link">https://doi.org/10.2307/2531848</a>.
</div>
<div id="ref-laud2017" class="csl-entry">
Laud, Peter J. 2017. <span>“Equal<span>-</span>Tailed Confidence
Intervals for Comparison of Rates.”</span> <em>Pharmaceutical
Statistics</em> 16 (5): 334–48. <a href="https://doi.org/10.1002/pst.1813" class="external-link">https://doi.org/10.1002/pst.1813</a>.
</div>
<div id="ref-miettinen1985" class="csl-entry">
Miettinen, Olli, and Markku Nurminen. 1985. <span>“Comparative Analysis
of Two Rates.”</span> <em>Statistics in Medicine</em> 4 (2): 213–26. <a href="https://doi.org/10.1002/sim.4780040211" class="external-link">https://doi.org/10.1002/sim.4780040211</a>.
</div>
<div id="ref-newcombe1998" class="csl-entry">
Newcombe, Robert G. 1998. <span>“Interval Estimation for the Difference
Between Independent Proportions: Comparison of Eleven Methods.”</span>
<em>Statistics in Medicine</em> 17 (8): 873–90. <a href="https://doi.org/10.1002/(sici)1097-0258(19980430)17:8&lt;873::aid-sim779&gt;3.0.co;2-i" class="external-link">https://doi.org/10.1002/(sici)1097-0258(19980430)17:8&lt;873::aid-sim779&gt;3.0.co;2-i</a>.
</div>
<div id="ref-newcombe2012" class="csl-entry">
———. 2012. <em>Confidence Intervals for Proportions and Related Measures
of Effect Size</em>. CRC Press. <a href="https://doi.org/10.1201/b12670" class="external-link">https://doi.org/10.1201/b12670</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pete Laud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
