<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Single rate • ratesci</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Single rate">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ratesci</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/single_rate.html">Single rate</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/petelaud/ratesci/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Single rate</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/petelaud/ratesci/blob/master/vignettes/single_rate.Rmd" class="external-link"><code>vignettes/single_rate.Rmd</code></a></small>
      <div class="d-none name"><code>single_rate.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/petelaud/ratesci" class="external-link">ratesci</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction-to-rateci-and-related-functions-for-estimation-of-a-single-binomial-or-poisson-rate">Introduction to <code>rateci()</code> and related functions for
estimation of a single binomial or Poisson rate<a class="anchor" aria-label="anchor" href="#introduction-to-rateci-and-related-functions-for-estimation-of-a-single-binomial-or-poisson-rate"></a>
</h2>
<p>For estimation of a confidence interval for a single binomial
proportion (<code>x/n</code>), the Skewness-Corrected Asymptotic Score
(SCAS) method is recommended, as one that succeeds, on average, at
containing the true proportion p with the appropriate nominal
probability (e.g. 95%), and has evenly distributed tail probabilities
<span class="citation">(<a href="#ref-laud2017">Laud 2017</a>, Appendix
S3.5)</span>. It is a modified version of the Wilson Score method. The
plot below illustrates the interval non-coverage (i.e. 1 minus the
actual probability that the interval contains the true value of p)
achieved by SCAS compared to some other popular methods, using moving
average smoothing:</p>
<p><img src="../reference/figures/singlepropLNCP50.png">For example, the
SCAS 95% interval for the proportion 1/29 is obtained with
<code><a href="../reference/scaspci.html">scaspci()</a></code>, using closed-form calculation <span class="citation">(<a href="#ref-laud2017">Laud 2017</a>, Appendix
A.4)</span>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scaspci.html">scaspci</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">29</span><span class="op">)</span></span>
<span><span class="co">#&gt;        lower    est upper</span></span>
<span><span class="co">#&gt; [1,] 0.00199 0.0398 0.155</span></span></code></pre></div>
<p><code><a href="../reference/rateci.html">rateci()</a></code> also provides two other methods (Jeffreys and
mid-p) with similar coverage properties <span class="citation">(<a href="#ref-laud2018">Laud 2018</a>)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rateci.html">rateci</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">29</span><span class="op">)</span></span>
<span><span class="co">#&gt; $scas</span></span>
<span><span class="co">#&gt;        lower    est upper</span></span>
<span><span class="co">#&gt; [1,] 0.00199 0.0398 0.155</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $jeff</span></span>
<span><span class="co">#&gt;        lower    est upper</span></span>
<span><span class="co">#&gt; [1,] 0.00375 0.0403  0.15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $midp</span></span>
<span><span class="co">#&gt;        lower    est upper</span></span>
<span><span class="co">#&gt; [1,] 0.00172 0.0391 0.159</span></span></code></pre></div>
<p>The Jeffreys interval can also incorporate prior information about p
for an approximate Bayesian confidence interval. For example, a pilot
study estimate of 1/10 would suggest a Beta(1,9) prior for p:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/jeffreysci.html">jeffreysci</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">29</span>, ai <span class="op">=</span> <span class="fl">1</span>, bi <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span><span class="co">#&gt;        lower    est upper</span></span>
<span><span class="co">#&gt; [1,] 0.00644 0.0438 0.138</span></span></code></pre></div>
<p>If more conservative coverage is required, a “continuity adjustment”
may be deployed with <code>cc</code>, as follows, giving
continuity-adjusted SCAS or Jeffreys, and (if <code>cc</code> is TRUE or
0.5), the Clopper-Pearson method. Note intermediate adjustments smaller
than 0.5 give a more refined adjustment<span class="citation">(<a href="#ref-laud2017">Laud 2017</a>, Appendix S2)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rateci.html">rateci</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">29</span>, cc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; $scas_cc</span></span>
<span><span class="co">#&gt;         lower    est upper</span></span>
<span><span class="co">#&gt; [1,] 6.19e-06 0.0398 0.182</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $jeff_cc</span></span>
<span><span class="co">#&gt;         lower    est upper</span></span>
<span><span class="co">#&gt; [1,] 0.000873 0.0403 0.178</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cp</span></span>
<span><span class="co">#&gt;         lower    est upper</span></span>
<span><span class="co">#&gt; [1,] 0.000873 0.0391 0.178</span></span></code></pre></div>
<div class="section level3">
<h3 id="stratified-and-clustered-datasets">Stratified and clustered datasets<a class="anchor" aria-label="anchor" href="#stratified-and-clustered-datasets"></a>
</h3>
<p>For stratified datasets (e.g. data collected in different subgroups
or collated across different studies), use <code><a href="../reference/scoreci.html">scoreci()</a></code> with
<code>contrast = "p"</code> and <code>stratified = TRUE</code> (again,
the skewness correction is recommended, but may be omitted).</p>
<p>By default, a “fixed effects” analysis is produced, i.e. one which
assumes a common true parameter p across strata. The default stratum
weighting uses the inverse variance of the score underlying the
SCAS/Wilson method, evaluated at the maximum likelihood estimate for the
pooled proportion (thus avoiding infinite weights for boundary cases).
Alternative weights are sample size (<code>weighting = "MH"</code>) or
custom user-specified weights supplied via the <code>wt</code> argument.
For example, population weighting would be applied via a vector
(e.g. <code>wt = Ni</code>) containing the true population size (or true
population proportion <code>Ni/N</code>) represented by each stratum.
(Note this is not divided by the sample size/proportion per stratum,
because the weighting is applied at the group level, not the case
level.)</p>
<p>Below is an illustration using data from the control arm of 9 trials
studying postoperative deep vein thrombosis (DVT). This may be a
somewhat unrealistic example, as the main focus of such studies is to
estimate the effect of a treatment, rather than to estimate the
underlying risk of an event, but used here to illustrate the usage of
<code><a href="../reference/scoreci.html">scoreci()</a></code> for a stratified dataset:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">compress</span>, package <span class="op">=</span> <span class="st">"ratesci"</span><span class="op">)</span></span>
<span><span class="va">strat_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scoreci.html">scoreci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">compress</span><span class="op">$</span><span class="va">event.control</span>, </span>
<span>                   n1 <span class="op">=</span> <span class="va">compress</span><span class="op">$</span><span class="va">n.control</span>, </span>
<span>                   contrast <span class="op">=</span> <span class="st">"p"</span>, </span>
<span>                   stratified <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">strat_p</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt;      lower   est upper level p1hat p1mle</span></span>
<span><span class="co">#&gt; [1,] 0.181 0.212 0.245  0.95 0.212 0.212</span></span></code></pre></div>
<p>The function also outputs p-values for a 2-sided hypothesis test
against a default null hypothesis p = 0.5, and one-sided tests against a
user-specified value of theta0:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat_p</span><span class="op">$</span><span class="va">pval</span></span>
<span><span class="co">#&gt;      chisq pval2sided theta0 scorenull pval_left pval_right</span></span>
<span><span class="co">#&gt; [1,]   208   4.05e-47    0.5     -14.4  2.02e-47          1</span></span></code></pre></div>
<p>The <code>Qtest</code> output object provides a heterogeneity test
and related quantities. In this instance, there appears to be
significant variability between studies in the underlying event rate for
the control group, which may reflect different characteristics of the
populations in each study leading to different underlying risk. (Note
this need not prevent the evaluation of stratified treatment
comparisons):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat_p</span><span class="op">$</span><span class="va">Qtest</span></span>
<span><span class="co">#&gt;            Q         Q_df     pval_het           I2         tau2           Qc </span></span>
<span><span class="co">#&gt;     6.37e+01     8.00e+00     8.84e-11     8.74e+01     1.74e-02     0.00e+00 </span></span>
<span><span class="co">#&gt; pval_qualhet </span></span>
<span><span class="co">#&gt;     9.96e-01</span></span></code></pre></div>
<p>Per-stratum estimates are produced, including stratum weights and
contributions to the Q-statistic. Here the studies contributing most are
the 3rd and 8th study, with estimated proportions of 0.48 (95% CI: 0.34
to 0.62) and 0.04 (95% CI: 0.01 to 0.10) respectively:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat_p</span><span class="op">$</span><span class="va">stratdata</span></span>
<span><span class="co">#&gt;       x1j n1j p1hatj wt_fixed wtpct_fixed wtpct_rand theta_j lower_j upper_j</span></span>
<span><span class="co">#&gt;  [1,]  37 103 0.3592    616.0       16.43      16.43  0.3597  0.2713   0.455</span></span>
<span><span class="co">#&gt;  [2,]   5  10 0.5000     59.8        1.59       1.59  0.5000  0.2175   0.782</span></span>
<span><span class="co">#&gt;  [3,]  23  48 0.4792    287.1        7.66       7.66  0.4793  0.3419   0.619</span></span>
<span><span class="co">#&gt;  [4,]  16 110 0.1455    657.8       17.54      17.54  0.1465  0.0888   0.221</span></span>
<span><span class="co">#&gt;  [5,]   7  32 0.2188    191.4        5.10       5.10  0.2216  0.1021   0.384</span></span>
<span><span class="co">#&gt;  [6,]   8  25 0.3200    149.5        3.99       3.99  0.3224  0.1626   0.517</span></span>
<span><span class="co">#&gt;  [7,]  17 126 0.1349    753.5       20.10      20.10  0.1359  0.0835   0.203</span></span>
<span><span class="co">#&gt;  [8,]   4  92 0.0435    550.2       14.67      14.67  0.0451  0.0143   0.101</span></span>
<span><span class="co">#&gt;  [9,]  16  81 0.1975    484.4       12.92      12.92  0.1988  0.1219   0.294</span></span>
<span><span class="co">#&gt;           V_j Stheta_j      Q_j</span></span>
<span><span class="co">#&gt;  [1,] 0.00162  0.14695 13.30145</span></span>
<span><span class="co">#&gt;  [2,] 0.01672  0.28773  4.95092</span></span>
<span><span class="co">#&gt;  [3,] 0.00348  0.26689 20.44757</span></span>
<span><span class="co">#&gt;  [4,] 0.00152 -0.06682  2.93717</span></span>
<span><span class="co">#&gt;  [5,] 0.00523  0.00648  0.00803</span></span>
<span><span class="co">#&gt;  [6,] 0.00669  0.10773  1.73503</span></span>
<span><span class="co">#&gt;  [7,] 0.00133 -0.07735  4.50878</span></span>
<span><span class="co">#&gt;  [8,] 0.00182 -0.16880 15.67615</span></span>
<span><span class="co">#&gt;  [9,] 0.00206 -0.01474  0.10529</span></span></code></pre></div>
<p>For a “random effects” analysis, use <code>random = TRUE</code>.
(This may not give a meaningful estimate of stratum variation if the
number of strata is small.)</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat_p_rand</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scoreci.html">scoreci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">compress</span><span class="op">$</span><span class="va">event.control</span>, </span>
<span>                        n1 <span class="op">=</span> <span class="va">compress</span><span class="op">$</span><span class="va">n.control</span>, </span>
<span>                        contrast <span class="op">=</span> <span class="st">"p"</span>, </span>
<span>                        stratified <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">strat_p_rand</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt;      lower  est upper level p1hat p1mle</span></span>
<span><span class="co">#&gt; [1,] 0.136 0.25 0.364  0.95  0.25  0.25</span></span>
<span><span class="va">strat_p_rand</span><span class="op">$</span><span class="va">pval</span></span>
<span><span class="co">#&gt;      chisq pval2sided theta0 scorenull pval_left pval_right</span></span>
<span><span class="co">#&gt; [1,]  25.2    0.00102    0.5     -5.02  0.000511      0.999</span></span></code></pre></div>
<p>For clustered data, use <code><a href="../reference/clusterpci.html">clusterpci()</a></code>, which applies the
Wilson-based method proposed by <span class="citation">(<a href="#ref-saha2015">Saha, Miller, and Wang 2015</a>)</span>, and a
skewness-corrected version:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Data from Liang 1992</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">36</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">48</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">23</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">17</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Wilson-based interval as per Saha et al.</span></span>
<span>  <span class="fu"><a href="../reference/clusterpci.html">clusterpci</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, skew <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;       lower    est  upper totx totn xihat    icc</span></span>
<span><span class="co">#&gt; [1,] 0.2285 0.2956 0.3728   60  203 1.349 0.1855</span></span>
<span>  <span class="co"># Skewness-corrected version</span></span>
<span>  <span class="fu"><a href="../reference/clusterpci.html">clusterpci</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, skew <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;       lower    est  upper totx totn xihat    icc</span></span>
<span><span class="co">#&gt; [1,] 0.2276 0.2958 0.3724   60  203 1.349 0.1855</span></span></code></pre></div>
<p>All of the above (except <code><a href="../reference/clusterpci.html">clusterpci()</a></code>) can also handle
Poisson exposure-adjusted rates, using <code>distrib = "poi"</code>,
where <code>n</code> represents the exposure time.</p>
</div>
</div>
<div class="section level2">
<h2 id="technical-details">Technical details<a class="anchor" aria-label="anchor" href="#technical-details"></a>
</h2>
<p>The SCAS method is an extension of the Wilson Score method, using the
same score function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>x</mi><mi>/</mi><mi>n</mi><mo>−</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">S(p) = x / n - p</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
is the observed number of events from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
trials, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is the true proportion. The variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(p)</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo>=</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">V = p(1 - p)/n</annotation></semantics></math>,
and the 3rd central moment is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>3</mn></msub><mo>=</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mn>2</mn><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mu_3 = p(1 - p)(1 - 2p)/n^2</annotation></semantics></math>.
The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>%</mi></mrow><annotation encoding="application/x-tex">100(1 - \alpha)\%</annotation></semantics></math>
confidence interval is found as the two solutions of the following
equation, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1 - \alpha / 2</annotation></semantics></math>
percentile of the standard normal distribution:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><msup><mi>V</mi><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>z</mi><mn>2</mn></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>μ</mi><mn>3</mn></msub><mi>/</mi><mn>6</mn><msup><mi>V</mi><mrow><mn>3</mn><mi>/</mi><mn>2</mn></mrow></msup><mo>=</mo><mo>±</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">
S(p)/V^{1/2} - (z^2 - 1)\mu_3/6V^{3/2} = \pm z
</annotation></semantics></math></p>
<p>For unstratified datasets, this has a closed-form solution. The
formula is extended in <span class="citation">(<a href="#ref-laud2017">Laud 2017</a>)</span> to incorporate stratification
using inverse variance weights,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mi>/</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">w_i = 1 / V</annotation></semantics></math>,
or other weighting schemes as required, with the solution being found by
iteration over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">p \in [0, 1]</annotation></semantics></math>.</p>
<p>The Jeffreys interval is obtained as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">\alpha / 2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1 - \alpha / 2</annotation></semantics></math>
quantiles of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>+</mo><mn>0.5</mn><mo>,</mo><mi>n</mi><mo>−</mo><mi>x</mi><mo>+</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Beta(x + 0.5, n - x + 0.5)</annotation></semantics></math>
distribution, with boundary modifications when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x = 0</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">x = n</annotation></semantics></math>.</p>
<p>A Clopper-Pearson interval may also be obtained as quantiles of a
beta distribution, using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>n</mi><mo>−</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Beta(x, n - x + 1)</annotation></semantics></math>
for the lower confidence limit, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>n</mi><mo>−</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Beta(x + 1, n - x)</annotation></semantics></math>
for the upper limit.</p>
<!-- The mid-p interval requires iteration to identify limits satisfying the inequalities specified ... -->
<!-- ## Additional details -->
<!-- Confidence intervals for a single binomial proportion, x/n, have a long history. The 'classic' ('conventional' / 'textbook') method everyone learns about in school is known as the Wald method, based on a large-sample "simple asymptotic" Normal approximation. It is easily demonstrated that this method generally fails to achieve the nominal confidence level, even when n is quite large. In other words, a 95% Wald confidence interval will contain the true value of p less than 95% of the time. For small proportions, the actual coverage can be alarmingly low. the Wald method can also produce intervals that contain impossible negative values of p, and an extremely unrealistic interval of [0, 0] when x = 0. -->
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-laud2017" class="csl-entry">
Laud, Peter J. 2017. <span>“Equal<span>-</span>Tailed Confidence
Intervals for Comparison of Rates.”</span> <em>Pharmaceutical
Statistics</em> 16 (5): 334–48. <a href="https://doi.org/10.1002/pst.1813" class="external-link">https://doi.org/10.1002/pst.1813</a>.
</div>
<div id="ref-laud2018" class="csl-entry">
———. 2018. <span>“Equal<span>-</span>Tailed Confidence Intervals for
Comparison of Rates.”</span> <em>Pharmaceutical Statistics</em> 17 (3):
290–93. <a href="https://doi.org/10.1002/pst.1855" class="external-link">https://doi.org/10.1002/pst.1855</a>.
</div>
<div id="ref-saha2015" class="csl-entry">
Saha, Krishna K., Daniel Miller, and Suojin Wang. 2015. <span>“A
Comparison of Some Approximate Confidence Intervals for a Single
Proportion for Clustered Binary Outcome Data.”</span> <em>The
International Journal of Biostatistics</em> 12 (2). <a href="https://doi.org/10.1515/ijb-2015-0024" class="external-link">https://doi.org/10.1515/ijb-2015-0024</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pete Laud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
