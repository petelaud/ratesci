<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Single rate • ratesci</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Single rate">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ratesci</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/single_rate.html">Single rate</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/petelaud/ratesci/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Single rate</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/petelaud/ratesci/blob/master/vignettes/single_rate.Rmd" class="external-link"><code>vignettes/single_rate.Rmd</code></a></small>
      <div class="d-none name"><code>single_rate.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/petelaud/ratesci" class="external-link">ratesci</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction-to-rateci-and-related-functions-for-estimation-of-a-single-binomial-or-poisson-rate">Introduction to <code>rateci()</code> and related functions for
estimation of a single binomial or Poisson rate<a class="anchor" aria-label="anchor" href="#introduction-to-rateci-and-related-functions-for-estimation-of-a-single-binomial-or-poisson-rate"></a>
</h2>
<p>For estimation of a confidence interval for a single binomial
proportion (<code>x/n</code>), the Skewness-Corrected Asymptotic Score
(SCAS) method is recommended, as one that succeeds, on average, at
containing the true proportion p with the appropriate nominal
probability (e.g. 95%), and has evenly distributed tail
probabilities<span class="citation">(<a href="#ref-laud2017">Laud
2017</a>, Appendix S3.5)</span>. It is a modified version of the Wilson
Score method. The plot below illustrates the interval non-coverage
(i.e. 1 minus the actual probability that the interval contains the true
value of p) achieved by SCAS compared to some other popular methods,
using moving average smoothing:</p>
<p><img src="../reference/figures/singlepropLNCP50.png">For example, the
SCAS 95% interval for the proportion 1/29 is obtained with
<code><a href="../reference/scaspci.html">scaspci()</a></code>, using closed-form calculation<span class="citation">(<a href="#ref-laud2017">Laud 2017</a>, Appendix
A.4)</span>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/scaspci.html">scaspci</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">29</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Lower    MLE Upper</span></span>
<span><span class="co">#&gt; [1,] 0.00199 0.0398 0.155</span></span></code></pre></div>
<p><code><a href="../reference/rateci.html">rateci()</a></code> also provides two other methods with similar
coverage properties (Jeffreys and mid-p) <span class="citation">(<a href="#ref-laud2018">Laud 2018</a>)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rateci.html">rateci</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">29</span><span class="op">)</span></span>
<span><span class="co">#&gt; $scas</span></span>
<span><span class="co">#&gt;        Lower    MLE Upper</span></span>
<span><span class="co">#&gt; [1,] 0.00199 0.0398 0.155</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $jeff</span></span>
<span><span class="co">#&gt;        Lower    est Upper</span></span>
<span><span class="co">#&gt; [1,] 0.00375 0.0403  0.15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $midp</span></span>
<span><span class="co">#&gt;        Lower    MLE Upper</span></span>
<span><span class="co">#&gt; [1,] 0.00172 0.0391 0.159</span></span></code></pre></div>
<p>The Jeffreys interval can also incorporate prior information about p
for an approximate Bayesian confidence interval. For example, a pilot
study estimate of 1/10 would suggest a Beta(1,9) prior for p:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/jeffreysci.html">jeffreysci</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">29</span>, ai <span class="op">=</span> <span class="fl">1</span>, bi <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Lower    est Upper</span></span>
<span><span class="co">#&gt; [1,] 0.00644 0.0438 0.138</span></span></code></pre></div>
<p>If more conservative coverage is required, a “continuity adjustment”
may be deployed with <code>cc</code>, as follows, giving
continuity-adjusted SCAS or Jeffreys, and (if <code>cc</code> is TRUE or
0.5), the Clopper-Pearson method. Note intermediate adjustments smaller
than 0.5 give a more refined adjustment<span class="citation">(<a href="#ref-laud2017">Laud 2017</a>, Appendix S2)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rateci.html">rateci</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">29</span>, cc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; $scas_cc</span></span>
<span><span class="co">#&gt;         Lower    MLE Upper</span></span>
<span><span class="co">#&gt; [1,] 6.19e-06 0.0398 0.182</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $jeff_cc</span></span>
<span><span class="co">#&gt;         Lower    est Upper</span></span>
<span><span class="co">#&gt; [1,] 0.000873 0.0403 0.178</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cp</span></span>
<span><span class="co">#&gt;         Lower    MLE Upper</span></span>
<span><span class="co">#&gt; [1,] 0.000873 0.0391 0.178</span></span></code></pre></div>
<div class="section level3">
<h3 id="stratified-and-clustered-datasets">Stratified and clustered datasets<a class="anchor" aria-label="anchor" href="#stratified-and-clustered-datasets"></a>
</h3>
<p>For stratified datasets, use <code><a href="../reference/scoreci.html">scoreci()</a></code> with
<code>contrast = "p"</code> and <code>stratified = TRUE</code> (again,
the skewness correction is recommended, but may be omitted). By default,
a “fixed effects” analysis is produced, i.e. one which assumes a common
true parameter p across strata. The default stratum weighting uses the
inverse variance of the score underlying the SCAS/Wilson method,
evaluated at the MLE for the pooled proportion (thus avoiding infinite
weights for boundary cases). Alternative weights are sample size
(<code>weighting = "MH"</code>) or custom user-specified weights
supplied via the <code>wt</code> argument. For example, population
weighting would be applied via a vector (e.g. <code>wt = Ni</code>)
containing the true population size (or true population proportion
<code>Ni/N</code>) represented by each stratum. (Note this is not
divided by the sample size/proportion per stratum, because the weighting
is applied at the group level, not the case level.)</p>
<p>Below is an illustration using the systematic review of the effect on
mortality of corticosteroids in traumatic brain injury (MRC CRASH
trial):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">crash</span>, package <span class="op">=</span> <span class="st">"ratesci"</span><span class="op">)</span></span>
<span><span class="va">strat_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scoreci.html">scoreci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">crash</span><span class="op">$</span><span class="va">event.control</span><span class="op">[</span><span class="op">-</span><span class="fl">17</span><span class="op">]</span>, n1 <span class="op">=</span> <span class="va">crash</span><span class="op">$</span><span class="va">n.control</span><span class="op">[</span><span class="op">-</span><span class="fl">17</span><span class="op">]</span>, contrast <span class="op">=</span> <span class="st">"p"</span>, stratified <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">strat_p</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt;      Lower   MLE Upper level p1hat p1mle</span></span>
<span><span class="co">#&gt; [1,] 0.296 0.325 0.356  0.95 0.325 0.325</span></span></code></pre></div>
<p>The function also outputs p-values for a 2-sided hypothesis test
against a default null hypothesis p = 0.5, and one-sided tests against a
user-specified value of theta0:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat_p</span><span class="op">$</span><span class="va">pval</span></span>
<span><span class="co">#&gt;      chisq pval2sided theta0 scorenull pval_left pval_right</span></span>
<span><span class="co">#&gt; [1,]   113    2.4e-26    0.5     -10.6   1.2e-26          1</span></span></code></pre></div>
<p>The <code>Qtest</code> output object provides a heterogeneity test
and related quantities:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat_p</span><span class="op">$</span><span class="va">Qtest</span></span>
<span><span class="co">#&gt;            Q         Q_df     pval_het           I2         tau2           Qc </span></span>
<span><span class="co">#&gt;     125.4067      15.0000       0.0000      88.0389       0.0293       7.5511 </span></span>
<span><span class="co">#&gt; pval_qualhet </span></span>
<span><span class="co">#&gt;       0.4274</span></span></code></pre></div>
<p>Per-stratum estimates are produced, including stratum weights and
contributions to the Q-statistic:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat_p</span><span class="op">$</span><span class="va">stratdata</span></span>
<span><span class="co">#&gt;       x1j n1j p1hatj wt_fixed wtpct_fixed wtpct_rand theta_j lower_j upper_j</span></span>
<span><span class="co">#&gt;  [1,]  13  18 0.7222     82.0       1.946      1.946 0.71818  0.4908  0.8882</span></span>
<span><span class="co">#&gt;  [2,]  22  55 0.4000    250.5       5.946      5.946 0.40060  0.2778  0.5324</span></span>
<span><span class="co">#&gt;  [3,]  16  28 0.5714    127.5       3.027      3.027 0.57059  0.3872  0.7417</span></span>
<span><span class="co">#&gt;  [4,]  13  27 0.4815    123.0       2.919      2.919 0.48171  0.3014  0.6653</span></span>
<span><span class="co">#&gt;  [5,]  36  83 0.4337    378.1       8.973      8.973 0.43400  0.3306  0.5414</span></span>
<span><span class="co">#&gt;  [6,]  38  74 0.5135    337.1       8.000      8.000 0.51345  0.4006  0.6254</span></span>
<span><span class="co">#&gt;  [7,]   9  50 0.1800    227.8       5.405      5.405 0.18212  0.0921  0.3038</span></span>
<span><span class="co">#&gt;  [8,]  47  80 0.5875    364.4       8.649      8.649 0.58714  0.4778  0.6910</span></span>
<span><span class="co">#&gt;  [9,]   7  16 0.4375     72.9       1.730      1.730 0.43878  0.2184  0.6771</span></span>
<span><span class="co">#&gt; [10,]  21  62 0.3387    282.4       6.703      6.703 0.33957  0.2299  0.4622</span></span>
<span><span class="co">#&gt; [11,]   0   5 0.0000     22.8       0.541      0.541 0.03125  0.0000  0.4162</span></span>
<span><span class="co">#&gt; [12,]   4  12 0.3333     54.7       1.297      1.297 0.33784  0.1197  0.6176</span></span>
<span><span class="co">#&gt; [13,]   5  54 0.0926    246.0       5.838      5.838 0.09509  0.0353  0.1923</span></span>
<span><span class="co">#&gt; [14,]  21 136 0.1544    619.5      14.703     14.703 0.15526  0.1010  0.2224</span></span>
<span><span class="co">#&gt; [15,]  49 195 0.2513    888.2      21.081     21.081 0.25171  0.1943  0.3156</span></span>
<span><span class="co">#&gt; [16,]   0  30 0.0000    136.7       3.243      3.243 0.00549  0.0000  0.0888</span></span>
<span><span class="co">#&gt;           V_j Stheta_j      Q_j</span></span>
<span><span class="co">#&gt;  [1,] 0.01220  0.39675 12.90636</span></span>
<span><span class="co">#&gt;  [2,] 0.00399  0.07453  1.39166</span></span>
<span><span class="co">#&gt;  [3,] 0.00784  0.24596  7.71573</span></span>
<span><span class="co">#&gt;  [4,] 0.00813  0.15601  2.99347</span></span>
<span><span class="co">#&gt;  [5,] 0.00265  0.10827  4.43156</span></span>
<span><span class="co">#&gt;  [6,] 0.00297  0.18805 11.91915</span></span>
<span><span class="co">#&gt;  [7,] 0.00439 -0.14547  4.81943</span></span>
<span><span class="co">#&gt;  [8,] 0.00274  0.26203 25.01996</span></span>
<span><span class="co">#&gt;  [9,] 0.01372  0.11203  0.91473</span></span>
<span><span class="co">#&gt; [10,] 0.00354  0.01324  0.04952</span></span>
<span><span class="co">#&gt; [11,] 0.04391 -0.32547  2.41255</span></span>
<span><span class="co">#&gt; [12,] 0.01829  0.00787  0.00338</span></span>
<span><span class="co">#&gt; [13,] 0.00407 -0.23288 13.33924</span></span>
<span><span class="co">#&gt; [14,] 0.00161 -0.17106 18.12622</span></span>
<span><span class="co">#&gt; [15,] 0.00113 -0.07419  4.88844</span></span>
<span><span class="co">#&gt; [16,] 0.00732 -0.32547 14.47530</span></span></code></pre></div>
<p>For a “random effects” analysis, use <code>random = TRUE</code>.
(This may not give a meaningful estimate of stratum variation if the
number of strata is small.)</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat_p_rand</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scoreci.html">scoreci</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">crash</span><span class="op">$</span><span class="va">event.control</span><span class="op">[</span><span class="op">-</span><span class="fl">17</span><span class="op">]</span>, n1 <span class="op">=</span> <span class="va">crash</span><span class="op">$</span><span class="va">n.control</span><span class="op">[</span><span class="op">-</span><span class="fl">17</span><span class="op">]</span>, contrast <span class="op">=</span> <span class="st">"p"</span>, stratified <span class="op">=</span> <span class="cn">TRUE</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">strat_p_rand</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt;      Lower   MLE Upper level p1hat p1mle</span></span>
<span><span class="co">#&gt; [1,] 0.239 0.349 0.459  0.95 0.349 0.349</span></span>
<span><span class="va">strat_p_rand</span><span class="op">$</span><span class="va">pval</span></span>
<span><span class="co">#&gt;      chisq pval2sided theta0 scorenull pval_left pval_right</span></span>
<span><span class="co">#&gt; [1,]   8.6     0.0103    0.5     -2.93   0.00514      0.995</span></span></code></pre></div>
<p>For clustered data, use <code><a href="../reference/clusterpci.html">clusterpci()</a></code>, which applies the
Wilson-based method proposed by <span class="citation">(<a href="#ref-saha2015">Saha, Miller, and Wang 2015</a>)</span>, and a
skewness-corrected version:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Data from Liang 1992</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">36</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">48</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">23</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">17</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Wilson-based interval as per Saha et al.</span></span>
<span>  <span class="fu"><a href="../reference/clusterpci.html">clusterpci</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, skew <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Lower    MLE  Upper totx totn xihat    ICC</span></span>
<span><span class="co">#&gt; [1,] 0.2285 0.2956 0.3728   60  203 1.349 0.1855</span></span>
<span>  <span class="co"># Skewness-corrected version</span></span>
<span>  <span class="fu"><a href="../reference/clusterpci.html">clusterpci</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, skew <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Lower    MLE  Upper totx totn xihat    ICC</span></span>
<span><span class="co">#&gt; [1,] 0.2276 0.2958 0.3724   60  203 1.349 0.1855</span></span></code></pre></div>
<p>All of the above (except <code><a href="../reference/clusterpci.html">clusterpci()</a></code>) can also handle
Poisson exposure-adjusted rates, using <code>distrib = "poi"</code>,
where <code>n</code> represents the exposure time.</p>
<!-- ## Additional details -->
<!-- Confidence intervals for a single binomial proportion, x/n, have a long history. The 'classic' ('conventional' / 'textbook') method everyone learns about in school is known as the Wald method, based on a large-sample "simple asymptotic" Normal approximation. It is easily demonstrated that this method generally fails to achieve the nominal confidence level, even when n is quite large. In other words, a 95% Wald confidence interval will contain the true value of p less than 95% of the time. For small proportions, the actual coverage can be alarmingly low. the Wald method can also produce intervals that contain impossible negative values of p, and an extremely unrealistic interval of [0, 0] when x = 0. -->
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-laud2017" class="csl-entry">
Laud, Peter J. 2017. <span>“Equal<span>-</span>Tailed Confidence
Intervals for Comparison of Rates.”</span> <em>Pharmaceutical
Statistics</em> 16 (5): 334–48. <a href="https://doi.org/10.1002/pst.1813" class="external-link">https://doi.org/10.1002/pst.1813</a>.
</div>
<div id="ref-laud2018" class="csl-entry">
———. 2018. <span>“Equal<span>-</span>Tailed Confidence Intervals for
Comparison of Rates.”</span> <em>Pharmaceutical Statistics</em> 17 (3):
290–93. <a href="https://doi.org/10.1002/pst.1855" class="external-link">https://doi.org/10.1002/pst.1855</a>.
</div>
<div id="ref-saha2015" class="csl-entry">
Saha, Krishna K., Daniel Miller, and Suojin Wang. 2015. <span>“A
Comparison of Some Approximate Confidence Intervals for a Single
Proportion for Clustered Binary Outcome Data.”</span> <em>The
International Journal of Biostatistics</em> 12 (2). <a href="https://doi.org/10.1515/ijb-2015-0024" class="external-link">https://doi.org/10.1515/ijb-2015-0024</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pete Laud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
